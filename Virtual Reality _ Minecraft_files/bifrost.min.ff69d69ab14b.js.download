//     Underscore.js 1.4.4
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
//     Underscore may be freely distributed under the MIT license.

//     (c) 2010-2013 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

/*!

 handlebars v2.0.0

Copyright (C) 2011-2014 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

@license
*/

/*!
 * jsUri
 * https://github.com/derek-watson/jsUri
 *
 * Copyright 2012, Derek Watson
 * Released under the MIT license.
 *
 * Includes parseUri regular expressions
 * http://blog.stevenlevithan.com/archives/parseuri
 * Copyright 2007, Steven Levithan
 * Released under the MIT license.
 *
 */

// Underscore 1.3.0 was used to port and is licensed

/**
   sprintf() for JavaScript 0.7-beta1
   http://www.diveintojavascript.com/projects/javascript-sprintf

   Copyright (c) Alexandru Marasteanu <alexaholic [at) gmail (dot] com>
   All rights reserved.

   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions are met:
       * Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.
       * Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in the
         documentation and/or other materials provided with the distribution.
       * Neither the name of sprintf() for JavaScript nor the
         names of its contributors may be used to endorse or promote products
         derived from this software without specific prior written permission.

   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
   ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
   WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
   DISCLAIMED. IN NO EVENT SHALL Alexandru Marasteanu BE LIABLE FOR ANY
   DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
   (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
   LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
   ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
   SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */

/*
Copyright (c) 2010,2011,2012,2013 Morgan Roderick http://roderick.dk
License: MIT - http://mrgnrdrck.mit-license.org

https://github.com/mroderick/PubSubJS
*/

//! moment.js
//! version : 2.10.6
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

/*
Copyright (c) 2011-2013 @WalmartLabs

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.
*/

/*!
 * jQuery Cookie Plugin v1.4.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */

// Backbone.Stickit v0.8.0, MIT Licensed
// Copyright (c) 2012 The New York Times, CMS Group, Matthew DeLambo <delambo@gmail.com>

// Backbone.Validation v0.9.2
//
// Copyright (c) 2011-2015 Thomas Pedersen
// Distributed under MIT License
//
// Documentation and full license available at:
// http://thedersen.com/projects/backbone-validation

/*!
 * bootstrap-progressbar v0.9.0 by @minddust
 * Copyright (c) 2012-2015 Stephan Gro√ü
 *
 * http://www.minddust.com/project/bootstrap-progressbar/
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */

/*
 * Mailcheck https://github.com/Kicksend/mailcheck
 * Author
 * Derrick Ko (@derrickko)
 *
 * License
 * Copyright (c) 2012 Receivd, Inc.
 *
 * Licensed under the MIT License.
 *
 * v 1.1
 */

var bifrost = {version: '1.3.0'}
define("jquery",[],function(){if(!this.jQuery)throw new Error("Bifrost requires a global window.jQuery");return this.jQuery}),function(e){define("underscore",[],function(){return function(){return function(){var e=this,t=e._,n={},i=Array.prototype,r=Object.prototype,s=Function.prototype,o=i.push,a=i.slice,l=i.concat,c=r.toString,u=r.hasOwnProperty,d=i.forEach,h=i.map,p=i.reduce,f=i.reduceRight,m=i.filter,g=i.every,v=i.some,y=i.indexOf,b=i.lastIndexOf,_=Array.isArray,w=Object.keys,x=s.bind,k=function(e){return e instanceof k?e:this instanceof k?void(this._wrapped=e):new k(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):e._=k,k.VERSION="1.4.4";var E=k.each=k.forEach=function(e,t,i){if(null!=e)if(d&&e.forEach===d)e.forEach(t,i);else if(e.length===+e.length){for(var r=0,s=e.length;r<s;r++)if(t.call(i,e[r],r,e)===n)return}else for(var o in e)if(k.has(e,o)&&t.call(i,e[o],o,e)===n)return};k.map=k.collect=function(e,t,n){var i=[];return null==e?i:h&&e.map===h?e.map(t,n):(E(e,function(e,r,s){i[i.length]=t.call(n,e,r,s)}),i)};var S="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(e,t,n,i){var r=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return i&&(t=k.bind(t,i)),r?e.reduce(t,n):e.reduce(t);if(E(e,function(e,s,o){r?n=t.call(i,n,e,s,o):(n=e,r=!0)}),!r)throw new TypeError(S);return n},k.reduceRight=k.foldr=function(e,t,n,i){var r=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return i&&(t=k.bind(t,i)),r?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=k.keys(e);s=o.length}if(E(e,function(a,l,c){l=o?o[--s]:--s,r?n=t.call(i,n,e[l],l,c):(n=e[l],r=!0)}),!r)throw new TypeError(S);return n},k.find=k.detect=function(e,t,n){var i;return C(e,function(e,r,s){if(t.call(n,e,r,s))return i=e,!0}),i},k.filter=k.select=function(e,t,n){var i=[];return null==e?i:m&&e.filter===m?e.filter(t,n):(E(e,function(e,r,s){t.call(n,e,r,s)&&(i[i.length]=e)}),i)},k.reject=function(e,t,n){return k.filter(e,function(e,i,r){return!t.call(n,e,i,r)},n)},k.every=k.all=function(e,t,i){t||(t=k.identity);var r=!0;return null==e?r:g&&e.every===g?e.every(t,i):(E(e,function(e,s,o){if(!(r=r&&t.call(i,e,s,o)))return n}),!!r)};var C=k.some=k.any=function(e,t,i){t||(t=k.identity);var r=!1;return null==e?r:v&&e.some===v?e.some(t,i):(E(e,function(e,s,o){if(r||(r=t.call(i,e,s,o)))return n}),!!r)};k.contains=k.include=function(e,t){return null!=e&&(y&&e.indexOf===y?-1!=e.indexOf(t):C(e,function(e){return e===t}))},k.invoke=function(e,t){var n=a.call(arguments,2),i=k.isFunction(t);return k.map(e,function(e){return(i?t:e[t]).apply(e,n)})},k.pluck=function(e,t){return k.map(e,function(e){return e[t]})},k.where=function(e,t,n){return k.isEmpty(t)?n?null:[]:k[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},k.findWhere=function(e,t){return k.where(e,t,!0)},k.max=function(e,t,n){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&k.isEmpty(e))return-1/0;var i={computed:-1/0,value:-1/0};return E(e,function(e,r,s){var o=t?t.call(n,e,r,s):e;o>=i.computed&&(i={value:e,computed:o})}),i.value},k.min=function(e,t,n){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&k.isEmpty(e))return 1/0;var i={computed:1/0,value:1/0};return E(e,function(e,r,s){var o=t?t.call(n,e,r,s):e;o<i.computed&&(i={value:e,computed:o})}),i.value},k.shuffle=function(e){var t,n=0,i=[];return E(e,function(e){t=k.random(n++),i[n-1]=i[t],i[t]=e}),i};var M=function(e){return k.isFunction(e)?e:function(t){return t[e]}};k.sortBy=function(e,t,n){var i=M(t);return k.pluck(k.map(e,function(e,t,r){return{value:e,index:t,criteria:i.call(n,e,t,r)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return e.index<t.index?-1:1}),"value")};var O=function(e,t,n,i){var r={},s=M(t||k.identity);return E(e,function(t,o){var a=s.call(n,t,o,e);i(r,a,t)}),r};k.groupBy=function(e,t,n){return O(e,t,n,function(e,t,n){(k.has(e,t)?e[t]:e[t]=[]).push(n)})},k.countBy=function(e,t,n){return O(e,t,n,function(e,t){k.has(e,t)||(e[t]=0),e[t]++})},k.sortedIndex=function(e,t,n,i){n=null==n?k.identity:M(n);for(var r=n.call(i,t),s=0,o=e.length;s<o;){var a=s+o>>>1;n.call(i,e[a])<r?s=a+1:o=a}return s},k.toArray=function(e){return e?k.isArray(e)?a.call(e):e.length===+e.length?k.map(e,k.identity):k.values(e):[]},k.size=function(e){return null==e?0:e.length===+e.length?e.length:k.keys(e).length},k.first=k.head=k.take=function(e,t,n){if(null!=e)return null==t||n?e[0]:a.call(e,0,t)},k.initial=function(e,t,n){return a.call(e,0,e.length-(null==t||n?1:t))},k.last=function(e,t,n){if(null!=e)return null==t||n?e[e.length-1]:a.call(e,Math.max(e.length-t,0))},k.rest=k.tail=k.drop=function(e,t,n){return a.call(e,null==t||n?1:t)},k.compact=function(e){return k.filter(e,k.identity)};var P=function(e,t,n){return E(e,function(e){k.isArray(e)?t?o.apply(n,e):P(e,t,n):n.push(e)}),n};k.flatten=function(e,t){return P(e,t,[])},k.without=function(e){return k.difference(e,a.call(arguments,1))},k.uniq=k.unique=function(e,t,n,i){k.isFunction(t)&&(i=n,n=t,t=!1);var r=n?k.map(e,n,i):e,s=[],o=[];return E(r,function(n,i){(t?i&&o[o.length-1]===n:k.contains(o,n))||(o.push(n),s.push(e[i]))}),s},k.union=function(){return k.uniq(l.apply(i,arguments))},k.intersection=function(e){var t=a.call(arguments,1);return k.filter(k.uniq(e),function(e){return k.every(t,function(t){return k.indexOf(t,e)>=0})})},k.difference=function(e){var t=l.apply(i,a.call(arguments,1));return k.filter(e,function(e){return!k.contains(t,e)})},k.zip=function(){for(var e=a.call(arguments),t=k.max(k.pluck(e,"length")),n=new Array(t),i=0;i<t;i++)n[i]=k.pluck(e,""+i);return n},k.object=function(e,t){if(null==e)return{};for(var n={},i=0,r=e.length;i<r;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},k.indexOf=function(e,t,n){if(null==e)return-1;var i=0,r=e.length;if(n){if("number"!=typeof n)return i=k.sortedIndex(e,t),e[i]===t?i:-1;i=n<0?Math.max(0,r+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i<r;i++)if(e[i]===t)return i;return-1},k.lastIndexOf=function(e,t,n){if(null==e)return-1;var i=null!=n;if(b&&e.lastIndexOf===b)return i?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var r=i?n:e.length;r--;)if(e[r]===t)return r;return-1},k.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((t-e)/n),0),r=0,s=new Array(i);r<i;)s[r++]=e,e+=n;return s},k.bind=function(e,t){if(e.bind===x&&x)return x.apply(e,a.call(arguments,1));var n=a.call(arguments,2);return function(){return e.apply(t,n.concat(a.call(arguments)))}},k.partial=function(e){var t=a.call(arguments,1);return function(){return e.apply(this,t.concat(a.call(arguments)))}},k.bindAll=function(e){var t=a.call(arguments,1);return 0===t.length&&(t=k.functions(e)),E(t,function(t){e[t]=k.bind(e[t],e)}),e},k.memoize=function(e,t){var n={};return t||(t=k.identity),function(){var i=t.apply(this,arguments);return k.has(n,i)?n[i]:n[i]=e.apply(this,arguments)}},k.delay=function(e,t){var n=a.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},k.defer=function(e){return k.delay.apply(k,[e,1].concat(a.call(arguments,1)))},k.throttle=function(e,t){var n,i,r,s,o=0,a=function(){o=new Date,r=null,s=e.apply(n,i)};return function(){var l=new Date,c=t-(l-o);return n=this,i=arguments,c<=0?(clearTimeout(r),r=null,o=l,s=e.apply(n,i)):r||(r=setTimeout(a,c)),s}},k.debounce=function(e,t,n){var i,r;return function(){var s=this,o=arguments,a=function(){i=null,n||(r=e.apply(s,o))},l=n&&!i;return clearTimeout(i),i=setTimeout(a,t),l&&(r=e.apply(s,o)),r}},k.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},k.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},k.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},k.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},k.keys=w||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)k.has(e,n)&&(t[t.length]=n);return t},k.values=function(e){var t=[];for(var n in e)k.has(e,n)&&t.push(e[n]);return t},k.pairs=function(e){var t=[];for(var n in e)k.has(e,n)&&t.push([n,e[n]]);return t},k.invert=function(e){var t={};for(var n in e)k.has(e,n)&&(t[e[n]]=n);return t},k.functions=k.methods=function(e){var t=[];for(var n in e)k.isFunction(e[n])&&t.push(n);return t.sort()},k.extend=function(e){return E(a.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},k.pick=function(e){var t={},n=l.apply(i,a.call(arguments,1));return E(n,function(n){n in e&&(t[n]=e[n])}),t},k.omit=function(e){var t={},n=l.apply(i,a.call(arguments,1));for(var r in e)k.contains(n,r)||(t[r]=e[r]);return t},k.defaults=function(e){return E(a.call(arguments,1),function(t){if(t)for(var n in t)null==e[n]&&(e[n]=t[n])}),e},k.clone=function(e){return k.isObject(e)?k.isArray(e)?e.slice():k.extend({},e):e},k.tap=function(e,t){return t(e),e};var D=function(e,t,n,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof k&&(e=e._wrapped),t instanceof k&&(t=t._wrapped);var r=c.call(e);if(r!=c.call(t))return!1;switch(r){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return i[s]==t;n.push(e),i.push(t);var o=0,a=!0;if("[object Array]"==r){if(o=e.length,a=o==t.length)for(;o--&&(a=D(e[o],t[o],n,i)););}else{var l=e.constructor,u=t.constructor;if(l!==u&&!(k.isFunction(l)&&l instanceof l&&k.isFunction(u)&&u instanceof u))return!1;for(var d in e)if(k.has(e,d)&&(o++,!(a=k.has(t,d)&&D(e[d],t[d],n,i))))break;if(a){for(d in t)if(k.has(t,d)&&!o--)break;a=!o}}return n.pop(),i.pop(),a};k.isEqual=function(e,t){return D(e,t,[],[])},k.isEmpty=function(e){if(null==e)return!0;if(k.isArray(e)||k.isString(e))return 0===e.length;for(var t in e)if(k.has(e,t))return!1;return!0},k.isElement=function(e){return!(!e||1!==e.nodeType)},k.isArray=_||function(e){return"[object Array]"==c.call(e)},k.isObject=function(e){return e===Object(e)},E(["Arguments","Function","String","Number","Date","RegExp"],function(e){k["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}}),k.isArguments(arguments)||(k.isArguments=function(e){return!(!e||!k.has(e,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(e){return"function"==typeof e}),k.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},k.isNaN=function(e){return k.isNumber(e)&&e!=+e},k.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==c.call(e)},k.isNull=function(e){return null===e},k.isUndefined=function(e){return void 0===e},k.has=function(e,t){return u.call(e,t)},k.noConflict=function(){return e._=t,this},k.identity=function(e){return e},k.times=function(e,t,n){for(var i=Array(e),r=0;r<e;r++)i[r]=t.call(n,r);return i},k.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var V={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};V.unescape=k.invert(V.escape);var T={escape:new RegExp("["+k.keys(V.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(V.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(e){k[e]=function(t){return null==t?"":(""+t).replace(T[e],function(t){return V[e][t]})}}),k.result=function(e,t){if(null==e)return null;var n=e[t];return k.isFunction(n)?n.call(e):n},k.mixin=function(e){E(k.functions(e),function(t){var n=k[t]=e[t];k.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),U.call(this,n.apply(k,e))}})};var A=0;k.uniqueId=function(e){var t=++A+"";return e?e+t:t},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/(.)^/,N={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(e,t,n){var i;n=k.defaults({},n,k.templateSettings);var r=new RegExp([(n.escape||F).source,(n.interpolate||F).source,(n.evaluate||F).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(r,function(t,n,i,r,a){return o+=e.slice(s,a).replace(I,function(e){return"\\"+N[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(o+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),r&&(o+="';\n"+r+"\n__p+='"),s=a+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{i=new Function(n.variable||"obj","_",o)}catch(e){throw e.source=o,e}if(t)return i(t,k);var a=function(e){return i.call(this,e,k)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},k.chain=function(e){return k(e).chain()};var U=function(e){return this._chain?k(e).chain():e};k.mixin(k),E(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=i[e];k.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],U.call(this,n)}}),E(["concat","join","slice"],function(e){var t=i[e];k.prototype[e]=function(){return U.call(this,t.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),e._=_}.apply(e,arguments)})}(this),function(e){define("backbone",["jquery","underscore"],function(){return function(){return function(){var e,t=this,n=t.Backbone,i=[],r=i.push,s=i.slice,o=i.splice;e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="1.0.0";var a=t._;a||"undefined"==typeof require||(a=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender||t.$,e.noConflict=function(){return t.Backbone=n,this},e.emulateHTTP=!1,e.emulateJSON=!1;var l=e.Events={on:function(e,t,n){return u(this,"on",e,[t,n])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:n,ctx:n||this}),this):this},once:function(e,t,n){if(!u(this,"once",e,[t,n])||!t)return this;var i=this,r=a.once(function(){i.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,n)},off:function(e,t,n){var i,r,s,o,l,c,d,h;if(!this._events||!u(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;for(o=e?[e]:a.keys(this._events),l=0,c=o.length;l<c;l++)if(e=o[l],s=this._events[e]){if(this._events[e]=i=[],t||n)for(d=0,h=s.length;d<h;d++)r=s[d],(t&&t!==r.callback&&t!==r.callback._callback||n&&n!==r.context)&&i.push(r);i.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=s.call(arguments,1);if(!u(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&d(n,t),i&&d(i,arguments),this},stopListening:function(e,t,n){var i=this._listeners;if(!i)return this;var r=!t&&!n;"object"==typeof t&&(n=this),e&&((i={})[e._listenerId]=e);for(var s in i)i[s].off(t,n,this),r&&delete this._listeners[s];return this}},c=/\s+/,u=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)e[t].apply(e,[r,n[r]].concat(i));return!1}if(c.test(n)){for(var s=n.split(c),o=0,a=s.length;o<a;o++)e[t].apply(e,[s[o]].concat(i));return!1}return!0},d=function(e,t){var n,i=-1,r=e.length,s=t[0],o=t[1],a=t[2];switch(t.length){case 0:for(;++i<r;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=e[i]).callback.call(n.ctx,s);return;case 2:for(;++i<r;)(n=e[i]).callback.call(n.ctx,s,o);return;case 3:for(;++i<r;)(n=e[i]).callback.call(n.ctx,s,o,a);return;default:for(;++i<r;)(n=e[i]).callback.apply(n.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};a.each(h,function(e,t){l[t]=function(t,n,i){return(this._listeners||(this._listeners={}))[t._listenerId||(t._listenerId=a.uniqueId("l"))]=t,"object"==typeof n&&(i=this),t[e](n,i,this),this}}),l.bind=l.on,l.unbind=l.off,a.extend(e,l);var p=e.Model=function(e,t){var n,i=e||{};t||(t={}),this.cid=a.uniqueId("c"),this.attributes={},a.extend(this,a.pick(t,f)),t.parse&&(i=this.parse(i,t)||{}),(n=a.result(this,"defaults"))&&(i=a.defaults({},i,n)),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)},f=["url","urlRoot","collection"];a.extend(p.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return a.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return a.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var i,r,s,o,l,c,u,d;if(null==e)return this;if("object"==typeof e?(r=e,n=t):(r={})[e]=t,n||(n={}),!this._validate(r,n))return!1;s=n.unset,l=n.silent,o=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=a.clone(this.attributes),this.changed={}),d=this.attributes,u=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(i in r)t=r[i],a.isEqual(d[i],t)||o.push(i),a.isEqual(u[i],t)?delete this.changed[i]:this.changed[i]=t,s?delete d[i]:d[i]=t;if(!l){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,d[o[h]],n)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,a.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,a.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!a.isEmpty(this.changed):a.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&a.clone(this.changed);var t,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var r in e)a.isEqual(i[r],t=e[r])||((n||(n={}))[r]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return a.clone(this._previousAttributes)},fetch:function(e){e=e?a.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(i){if(!t.set(t.parse(i,e),e))return!1;n&&n(t,i,e),t.trigger("sync",t,i,e)},U(this,e),this.sync("read",this,e)},save:function(e,t,n){var i,r,s,o=this.attributes;if(null==e||"object"==typeof e?(i=e,n=t):(i={})[e]=t,i&&(!n||!n.wait)&&!this.set(i,n))return!1;if(n=a.extend({validate:!0},n),!this._validate(i,n))return!1;i&&n.wait&&(this.attributes=a.extend({},o,i)),void 0===n.parse&&(n.parse=!0);var l=this,c=n.success;return n.success=function(e){l.attributes=o;var t=l.parse(e,n);if(n.wait&&(t=a.extend(i||{},t)),a.isObject(t)&&!l.set(t,n))return!1;c&&c(l,e,n),l.trigger("sync",l,e,n)},U(this,n),r=this.isNew()?"create":n.patch?"patch":"update","patch"===r&&(n.attrs=i),s=this.sync(r,this,n),i&&n.wait&&(this.attributes=o),s},destroy:function(e){e=e?a.clone(e):{};var t=this,n=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(r){(e.wait||t.isNew())&&i(),n&&n(t,r,e),t.isNew()||t.trigger("sync",t,r,e)},this.isNew())return e.success(),!1;U(this,e);var r=this.sync("delete",this,e);return e.wait||i(),r},url:function(){var e=a.result(this,"urlRoot")||a.result(this.collection,"url")||I();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},a.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=a.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return!n||(this.trigger("invalid",this,n,a.extend(t||{},{validationError:n})),!1)}});var m=["keys","values","pairs","invert","pick","omit"];a.each(m,function(e){p.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.attributes),a[e].apply(a,t)}});var g=e.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,a.extend({silent:!0},t))},v={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};a.extend(g.prototype,l,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){return this.set(e,a.defaults(t||{},y))},remove:function(e,t){e=a.isArray(e)?e.slice():[e],t||(t={});var n,i,r,s;for(n=0,i=e.length;n<i;n++)(s=this.get(e[n]))&&(delete this._byId[s.id],delete this._byId[s.cid],r=this.indexOf(s),this.models.splice(r,1),this.length--,t.silent||(t.index=r,s.trigger("remove",s,this,t)),this._removeReference(s));return this},set:function(e,t){t=a.defaults(t||{},v),t.parse&&(e=this.parse(e,t)),a.isArray(e)||(e=e?[e]:[]);var n,i,s,l,c,u=t.at,d=this.comparator&&null==u&&!1!==t.sort,h=a.isString(this.comparator)?this.comparator:null,p=[],f=[],m={};for(n=0,i=e.length;n<i;n++)(s=this._prepareModel(e[n],t))&&((l=this.get(s))?(t.remove&&(m[l.cid]=!0),t.merge&&(l.set(s.attributes,t),d&&!c&&l.hasChanged(h)&&(c=!0))):t.add&&(p.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,null!=s.id&&(this._byId[s.id]=s)));if(t.remove){for(n=0,i=this.length;n<i;++n)m[(s=this.models[n]).cid]||f.push(s);f.length&&this.remove(f,t)}if(p.length&&(d&&(c=!0),this.length+=p.length,null!=u?o.apply(this.models,[u,0].concat(p)):r.apply(this.models,p)),c&&this.sort({silent:!0}),t.silent)return this;for(n=0,i=p.length;n<i;n++)(s=p[n]).trigger("add",s,this,t);return c&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var n=0,i=this.models.length;n<i;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),this.add(e,a.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,a.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,a.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){if(null!=e)return this._byId[null!=e.id?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return a.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),a.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(a.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,n){t||(t=this.comparator);var i=a.isFunction(t)?t:function(e){return e.get(t)};return a.sortedIndex(this.models,e,i,n)},pluck:function(e){return a.invoke(this.models,"get",e)},fetch:function(e){e=e?a.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(i){var r=e.reset?"reset":"set";n[r](i,e),t&&t(n,i,e),n.trigger("sync",n,i,e)},U(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?a.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,i=t.success;return t.success=function(r){t.wait&&n.add(e,t),i&&i(e,r,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];a.each(b,function(e){g.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.models),a[e].apply(a,t)}});var _=["groupBy","countBy","sortBy"];a.each(_,function(e){g.prototype[e]=function(t,n){var i=a.isFunction(t)?t:function(e){return e.get(t)};return a[e](this.models,i,n)}});var w=e.View=function(e){this.cid=a.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},x=/^(\S+)\s*(.*)$/,k=["model","collection","el","id","attributes","className","tagName","events"];a.extend(w.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],!1!==n&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=a.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if(a.isFunction(n)||(n=this[e[t]]),n){var i=t.match(x),r=i[1],s=i[2];n=a.bind(n,this),r+=".delegateEvents"+this.cid,""===s?this.$el.on(r,n):this.$el.on(r,s,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=a.extend({},a.result(this,"options"),e)),a.extend(this,a.pick(e,k)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(a.result(this,"el"),!1);else{var t=a.extend({},a.result(this,"attributes"));this.id&&(t.id=a.result(this,"id")),this.className&&(t.class=a.result(this,"className"));var n=e.$("<"+a.result(this,"tagName")+">").attr(t);this.setElement(n,!1)}}}),e.sync=function(t,n,i){var r=E[t];a.defaults(i||(i={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var s={type:r,dataType:"json"};if(i.url||(s.url=a.result(n,"url")||I()),null!=i.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(i.attrs||n.toJSON(i))),i.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),i.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){s.type="POST",i.emulateJSON&&(s.data._method=r);var o=i.beforeSend;i.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",r),o)return o.apply(this,arguments)}}"GET"===s.type||i.emulateJSON||(s.processData=!1),"PATCH"!==s.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=i.xhr=e.ajax(a.extend(s,i));return n.trigger("request",n,l,i),l};var E={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var S=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,M=/(\(\?)?:\w+/g,O=/\*\w+/g,P=/[\-{}\[\]+?.,\\\^$|#\s]/g;a.extend(S.prototype,l,{initialize:function(){},route:function(t,n,i){a.isRegExp(t)||(t=this._routeToRegExp(t)),a.isFunction(n)&&(i=n,n=""),i||(i=this[n]);var r=this;return e.history.route(t,function(s){var o=r._extractParameters(t,s);i&&i.apply(r,o),r.trigger.apply(r,["route:"+n].concat(o)),r.trigger("route",n,o),e.history.trigger("route",r,n,o)}),this},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=a.result(this,"routes");for(var e,t=a.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(P,"\\$&").replace(C,"(?:$1)?").replace(M,function(e,t){return t?e:"([^/]+)"}).replace(O,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return a.map(n,function(e){return e?decodeURIComponent(e):null})}});var D=e.History=function(){this.handlers=[],a.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},V=/^[#\/]|\s+$/g,T=/^\/+|\/+$/g,A=/msie [\w.]+/,F=/\/$/;D.started=!1,a.extend(D.prototype,l,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(F,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(V,"")},start:function(t){if(D.started)throw new Error("Backbone.history has already been started");D.started=!0,this.options=a.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),i=document.documentMode,r=A.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(T,"/"),r&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var s=this.location,o=s.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!o?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&o&&s.hash&&(this.fragment=this.getHash().replace(V,""),this.history.replaceState({},document.title,this.root+this.fragment+s.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),D.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e);return a.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0})},navigate:function(e,t){if(!D.started)return!1;if(t&&!0!==t||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),e.history=new D;var N=function(e,t){var n,i=this;n=e&&a.has(e,"constructor")?e.constructor:function(){
return i.apply(this,arguments)},a.extend(n,i,t);var r=function(){this.constructor=n};return r.prototype=i.prototype,n.prototype=new r,e&&a.extend(n.prototype,e),n.__super__=i.prototype,n};p.extend=g.extend=S.extend=w.extend=D.extend=N;var I=function(){throw new Error('A "url" property or function must be specified')},U=function(e,t){var n=t.error;t.error=function(i){n&&n(e,i,t),e.trigger("error",e,i,t)}}}.call(this),e.Backbone=Backbone}.apply(e,arguments)})}(this),function(e,t){"function"==typeof define&&define.amd?define("handlebars-lib",[],t):"object"==typeof exports?module.exports=t():e.Handlebars=e.Handlebars||t()}(this,function(){var e=function(){"use strict";function e(e){this.string=e}return e.prototype.toString=function(){return""+this.string},e}(),t=function(e){"use strict";function t(e){return l[e]}function n(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}function i(e){return e instanceof a?e.toString():null==e?"":e?(e=""+e,u.test(e)?e.replace(c,t):e):e+""}function r(e){return!e&&0!==e||!(!p(e)||0!==e.length)}function s(e,t){return(e?e+".":"")+t}var o={},a=e,l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},c=/[&<>"'`]/g,u=/[&<>"'`]/;o.extend=n;var d=Object.prototype.toString;o.toString=d;var h=function(e){return"function"==typeof e};h(/x/)&&(h=function(e){return"function"==typeof e&&"[object Function]"===d.call(e)});var h;o.isFunction=h;var p=Array.isArray||function(e){return!(!e||"object"!=typeof e)&&"[object Array]"===d.call(e)};return o.isArray=p,o.escapeExpression=i,o.isEmpty=r,o.appendContextPath=s,o}(e),n=function(){"use strict";function e(e,n){var i;n&&n.firstLine&&(i=n.firstLine,e+=" - "+i+":"+n.firstColumn);for(var r=Error.prototype.constructor.call(this,e),s=0;s<t.length;s++)this[t[s]]=r[t[s]];i&&(this.lineNumber=i,this.column=n.firstColumn)}var t=["description","fileName","lineNumber","message","name","number","stack"];return e.prototype=new Error,e}(),i=function(e,t){"use strict";function n(e,t){this.helpers=e||{},this.partials=t||{},i(this)}function i(e){e.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new o("Missing helper: '"+arguments[arguments.length-1].name+"'")}),e.registerHelper("blockHelperMissing",function(t,n){var i=n.inverse,r=n.fn;if(!0===t)return r(this);if(!1===t||null==t)return i(this);if(l(t))return t.length>0?(n.ids&&(n.ids=[n.name]),e.helpers.each(t,n)):i(this);if(n.data&&n.ids){var o=p(n.data);o.contextPath=s.appendContextPath(n.data.contextPath,n.name),n={data:o}}return r(t,n)}),e.registerHelper("each",function(e,t){if(!t)throw new o("Must pass iterator to #each");var n,i,r=t.fn,a=t.inverse,u=0,d="";if(t.data&&t.ids&&(i=s.appendContextPath(t.data.contextPath,t.ids[0])+"."),c(e)&&(e=e.call(this)),t.data&&(n=p(t.data)),e&&"object"==typeof e)if(l(e))for(var h=e.length;u<h;u++)n&&(n.index=u,n.first=0===u,n.last=u===e.length-1,i&&(n.contextPath=i+u)),d+=r(e[u],{data:n});else for(var f in e)e.hasOwnProperty(f)&&(n&&(n.key=f,n.index=u,n.first=0===u,i&&(n.contextPath=i+f)),d+=r(e[f],{data:n}),u++);return 0===u&&(d=a(this)),d}),e.registerHelper("if",function(e,t){return c(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||s.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers.if.call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),e.registerHelper("with",function(e,t){c(e)&&(e=e.call(this));var n=t.fn;if(s.isEmpty(e))return t.inverse(this);if(t.data&&t.ids){var i=p(t.data);i.contextPath=s.appendContextPath(t.data.contextPath,t.ids[0]),t={data:i}}return n(e,t)}),e.registerHelper("log",function(t,n){var i=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;e.log(i,t)}),e.registerHelper("lookup",function(e,t){return e&&e[t]})}var r={},s=e,o=t;r.VERSION="2.0.0";r.COMPILER_REVISION=6;var a={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};r.REVISION_CHANGES=a;var l=s.isArray,c=s.isFunction,u=s.toString;r.HandlebarsEnvironment=n,n.prototype={constructor:n,logger:d,log:h,registerHelper:function(e,t){if("[object Object]"===u.call(e)){if(t)throw new o("Arg not supported with multiple helpers");s.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){"[object Object]"===u.call(e)?s.extend(this.partials,e):this.partials[e]=t},unregisterPartial:function(e){delete this.partials[e]}};var d={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,t){if(d.level<=e){var n=d.methodMap[e];"undefined"!=typeof console&&console[n]&&console[n].call(console,t)}}};r.logger=d;var h=d.log;r.log=h;var p=function(e){var t=s.extend({},e);return t._parent=e,t};return r.createFrame=p,r}(t,n),r=function(e,t,n){"use strict";function i(e){var t=e&&e[0]||1,n=h;if(t!==n){if(t<n){var i=p[n],r=p[t];throw new d("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+i+") or downgrade your runtime to an older version ("+r+").")}throw new d("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function r(e,t){if(!t)throw new d("No environment passed to template");if(!e||!e.main)throw new d("Unknown template object: "+typeof e);t.VM.checkRevision(e.compiler);var n=function(n,i,r,s,o,a,l,c,h){o&&(s=u.extend({},s,o));var p=t.VM.invokePartial.call(this,n,r,s,a,l,c,h);if(null==p&&t.compile){var f={helpers:a,partials:l,data:c,depths:h};l[r]=t.compile(n,{data:void 0!==c,compat:e.compat},t),p=l[r](s,f)}if(null!=p){if(i){for(var m=p.split("\n"),g=0,v=m.length;g<v&&(m[g]||g+1!==v);g++)m[g]=i+m[g];p=m.join("\n")}return p}throw new d("The partial "+r+" could not be compiled when running in runtime-only mode")},i={lookup:function(e,t){for(var n=e.length,i=0;i<n;i++)if(e[i]&&null!=e[i][t])return e[i][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:u.escapeExpression,invokePartial:n,fn:function(t){return e[t]},programs:[],program:function(e,t,n){var i=this.programs[e],r=this.fn(e);return t||n?i=s(this,e,r,t,n):i||(i=this.programs[e]=s(this,e,r)),i},data:function(e,t){for(;e&&t--;)e=e._parent;return e},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n=u.extend({},t,e)),n},noop:t.VM.noop,compilerInfo:e.compiler},r=function(t,n){n=n||{};var s=n.data;r._setup(n),!n.partial&&e.useData&&(s=l(t,s));var o;return e.useDepths&&(o=n.depths?[t].concat(n.depths):[t]),e.main.call(i,t,i.helpers,i.partials,s,o)};return r.isTop=!0,r._setup=function(n){n.partial?(i.helpers=n.helpers,i.partials=n.partials):(i.helpers=i.merge(n.helpers,t.helpers),e.usePartial&&(i.partials=i.merge(n.partials,t.partials)))},r._child=function(t,n,r){if(e.useDepths&&!r)throw new d("must pass parent depths");return s(i,t,e[t],n,r)},r}function s(e,t,n,i,r){var s=function(t,s){return s=s||{},n.call(e,t,e.helpers,e.partials,s.data||i,r&&[t].concat(r))};return s.program=t,s.depth=r?r.length:0,s}function o(e,t,n,i,r,s,o){var a={partial:!0,helpers:i,partials:r,data:s,depths:o};if(void 0===e)throw new d("The partial "+t+" could not be found");if(e instanceof Function)return e(n,a)}function a(){return""}function l(e,t){return t&&"root"in t||(t=t?f(t):{},t.root=e),t}var c={},u=e,d=t,h=n.COMPILER_REVISION,p=n.REVISION_CHANGES,f=n.createFrame;return c.checkRevision=i,c.template=r,c.program=s,c.invokePartial=o,c.noop=a,c}(t,n,i),s=function(e,t,n,i,r){"use strict";var s=e,o=t,a=n,l=i,c=r,u=function(){var e=new s.HandlebarsEnvironment;return l.extend(e,s),e.SafeString=o,e.Exception=a,e.Utils=l,e.escapeExpression=l.escapeExpression,e.VM=c,e.template=function(t){return c.template(t,e)},e},d=u();return d.create=u,d.default=d,d}(i,e,n,t,r),o=function(e){"use strict";function t(e){e=e||{},this.firstLine=e.first_line,this.firstColumn=e.first_column,this.lastColumn=e.last_column,this.lastLine=e.last_line}var n=e,i={ProgramNode:function(e,n,i){t.call(this,i),this.type="program",this.statements=e,this.strip=n},MustacheNode:function(e,n,r,s,o){if(t.call(this,o),this.type="mustache",this.strip=s,null!=r&&r.charAt){var a=r.charAt(3)||r.charAt(2);this.escaped="{"!==a&&"&"!==a}else this.escaped=!!r;e instanceof i.SexprNode?this.sexpr=e:this.sexpr=new i.SexprNode(e,n),this.id=this.sexpr.id,this.params=this.sexpr.params,this.hash=this.sexpr.hash,this.eligibleHelper=this.sexpr.eligibleHelper,this.isHelper=this.sexpr.isHelper},SexprNode:function(e,n,i){t.call(this,i),this.type="sexpr",this.hash=n;var r=this.id=e[0],s=this.params=e.slice(1);this.isHelper=!(!s.length&&!n),this.eligibleHelper=this.isHelper||r.isSimple},PartialNode:function(e,n,i,r,s){t.call(this,s),this.type="partial",this.partialName=e,this.context=n,this.hash=i,this.strip=r,this.strip.inlineStandalone=!0},BlockNode:function(e,n,i,r,s){t.call(this,s),this.type="block",this.mustache=e,this.program=n,this.inverse=i,this.strip=r,i&&!n&&(this.isInverse=!0)},RawBlockNode:function(e,r,s,o){if(t.call(this,o),e.sexpr.id.original!==s)throw new n(e.sexpr.id.original+" doesn't match "+s,this);r=new i.ContentNode(r,o),this.type="block",this.mustache=e,this.program=new i.ProgramNode([r],{},o)},ContentNode:function(e,n){t.call(this,n),this.type="content",this.original=this.string=e},HashNode:function(e,n){t.call(this,n),this.type="hash",this.pairs=e},IdNode:function(e,i){t.call(this,i),this.type="ID";for(var r="",s=[],o=0,a="",l=0,c=e.length;l<c;l++){var u=e[l].part;if(r+=(e[l].separator||"")+u,".."===u||"."===u||"this"===u){if(s.length>0)throw new n("Invalid path: "+r,this);".."===u?(o++,a+="../"):this.isScoped=!0}else s.push(u)}this.original=r,this.parts=s,this.string=s.join("."),this.depth=o,this.idName=a+this.string,this.isSimple=1===e.length&&!this.isScoped&&0===o,this.stringModeValue=this.string},PartialNameNode:function(e,n){t.call(this,n),this.type="PARTIAL_NAME",this.name=e.original},DataNode:function(e,n){t.call(this,n),this.type="DATA",this.id=e,this.stringModeValue=e.stringModeValue,this.idName="@"+e.stringModeValue},StringNode:function(e,n){t.call(this,n),this.type="STRING",this.original=this.string=this.stringModeValue=e},NumberNode:function(e,n){t.call(this,n),this.type="NUMBER",this.original=this.number=e,this.stringModeValue=Number(e)},BooleanNode:function(e,n){t.call(this,n),this.type="BOOLEAN",this.bool=e,this.stringModeValue="true"===e},CommentNode:function(e,n){t.call(this,n),this.type="comment",this.comment=e,this.strip={inlineStandalone:!0}}};return i}(n),a=function(){"use strict";return function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,CONTENT:12,COMMENT:13,openRawBlock:14,END_RAW_BLOCK:15,OPEN_RAW_BLOCK:16,sexpr:17,CLOSE_RAW_BLOCK:18,openBlock:19,block_option0:20,closeBlock:21,openInverse:22,block_option1:23,OPEN_BLOCK:24,CLOSE:25,OPEN_INVERSE:26,inverseAndProgram:27,INVERSE:28,OPEN_ENDBLOCK:29,path:30,OPEN:31,OPEN_UNESCAPED:32,CLOSE_UNESCAPED:33,OPEN_PARTIAL:34,partialName:35,param:36,partial_option0:37,partial_option1:38,sexpr_repetition0:39,sexpr_option0:40,dataName:41,STRING:42,NUMBER:43,BOOLEAN:44,OPEN_SEXPR:45,CLOSE_SEXPR:46,hash:47,hash_repetition_plus0:48,hashSegment:49,ID:50,EQUALS:51,DATA:52,pathSegments:53,SEP:54,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",12:"CONTENT",13:"COMMENT",15:"END_RAW_BLOCK",16:"OPEN_RAW_BLOCK",18:"CLOSE_RAW_BLOCK",24:"OPEN_BLOCK",25:"CLOSE",26:"OPEN_INVERSE",28:"INVERSE",29:"OPEN_ENDBLOCK",31:"OPEN",32:"OPEN_UNESCAPED",33:"CLOSE_UNESCAPED",34:"OPEN_PARTIAL",42:"STRING",43:"NUMBER",44:"BOOLEAN",45:"OPEN_SEXPR",46:"CLOSE_SEXPR",50:"ID",51:"EQUALS",52:"DATA",54:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[10,3],[14,3],[9,4],[9,4],[19,3],[22,3],[27,2],[21,3],[8,3],[8,3],[11,5],[11,4],[17,3],[17,1],[36,1],[36,1],[36,1],[36,1],[36,1],[36,3],[47,1],[49,3],[35,1],[35,1],[35,1],[41,2],[30,1],[53,3],[53,1],[6,0],[6,2],[20,0],[20,1],[23,0],[23,1],[37,0],[37,1],[38,0],[38,1],[39,0],[39,2],[40,0],[40,1],[48,1],[48,2]],performAction:function(e,t,n,i,r,s,o){var a=s.length-1;switch(r){case 1:return i.prepareProgram(s[a-1].statements,!0),s[a-1];case 2:this.$=new i.ProgramNode(i.prepareProgram(s[a]),{},this._$);break;case 3:case 4:case 5:case 6:this.$=s[a];break;case 7:this.$=new i.ContentNode(s[a],this._$);break;case 8:this.$=new i.CommentNode(s[a],this._$);break;case 9:this.$=new i.RawBlockNode(s[a-2],s[a-1],s[a],this._$);break;case 10:this.$=new i.MustacheNode(s[a-1],null,"","",this._$);break;case 11:this.$=i.prepareBlock(s[a-3],s[a-2],s[a-1],s[a],!1,this._$);break;case 12:this.$=i.prepareBlock(s[a-3],s[a-2],s[a-1],s[a],!0,this._$);break;case 13:case 14:this.$=new i.MustacheNode(s[a-1],null,s[a-2],i.stripFlags(s[a-2],s[a]),this._$);break;case 15:this.$={strip:i.stripFlags(s[a-1],s[a-1]),program:s[a]};break;case 16:this.$={path:s[a-1],strip:i.stripFlags(s[a-2],s[a])};break;case 17:case 18:this.$=new i.MustacheNode(s[a-1],null,s[a-2],i.stripFlags(s[a-2],s[a]),this._$);break;case 19:this.$=new i.PartialNode(s[a-3],s[a-2],s[a-1],i.stripFlags(s[a-4],s[a]),this._$);break;case 20:this.$=new i.PartialNode(s[a-2],void 0,s[a-1],i.stripFlags(s[a-3],s[a]),this._$);break;case 21:this.$=new i.SexprNode([s[a-2]].concat(s[a-1]),s[a],this._$);break;case 22:this.$=new i.SexprNode([s[a]],null,this._$);break;case 23:this.$=s[a];break;case 24:this.$=new i.StringNode(s[a],this._$);break;case 25:this.$=new i.NumberNode(s[a],this._$);break;case 26:this.$=new i.BooleanNode(s[a],this._$);break;case 27:this.$=s[a];break;case 28:s[a-1].isHelper=!0,this.$=s[a-1];break;case 29:this.$=new i.HashNode(s[a],this._$);break;case 30:this.$=[s[a-2],s[a]];break;case 31:this.$=new i.PartialNameNode(s[a],this._$);break;case 32:this.$=new i.PartialNameNode(new i.StringNode(s[a],this._$),this._$);break;case 33:this.$=new i.PartialNameNode(new i.NumberNode(s[a],this._$));break;case 34:this.$=new i.DataNode(s[a],this._$);break;case 35:this.$=new i.IdNode(s[a],this._$);break;case 36:s[a-2].push({part:s[a],separator:s[a-1]}),this.$=s[a-2];break;case 37:this.$=[{part:s[a]}];break;case 38:this.$=[];break;case 39:s[a-1].push(s[a]);break;case 48:this.$=[];break;case 49:s[a-1].push(s[a]);break;case 52:this.$=[s[a]];break;case 53:s[a-1].push(s[a])}},table:[{3:1,4:2,5:[2,38],6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],31:[2,38],32:[2,38],34:[2,38]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:[1,10],13:[1,11],14:16,16:[1,20],19:14,22:15,24:[1,18],26:[1,19],28:[2,2],29:[2,2],31:[1,12],32:[1,13],34:[1,17]},{1:[2,1]},{5:[2,39],12:[2,39],13:[2,39],16:[2,39],24:[2,39],26:[2,39],28:[2,39],29:[2,39],31:[2,39],32:[2,39],34:[2,39]},{5:[2,3],12:[2,3],13:[2,3],16:[2,3],24:[2,3],26:[2,3],28:[2,3],29:[2,3],31:[2,3],32:[2,3],34:[2,3]},{5:[2,4],12:[2,4],13:[2,4],16:[2,4],24:[2,4],26:[2,4],28:[2,4],29:[2,4],31:[2,4],32:[2,4],34:[2,4]},{5:[2,5],12:[2,5],13:[2,5],16:[2,5],24:[2,5],26:[2,5],28:[2,5],29:[2,5],31:[2,5],32:[2,5],34:[2,5]},{5:[2,6],12:[2,6],13:[2,6],16:[2,6],24:[2,6],26:[2,6],28:[2,6],29:[2,6],31:[2,6],32:[2,6],34:[2,6]},{5:[2,7],12:[2,7],13:[2,7],16:[2,7],24:[2,7],26:[2,7],28:[2,7],29:[2,7],31:[2,7],32:[2,7],34:[2,7]},{5:[2,8],12:[2,8],13:[2,8],16:[2,8],24:[2,8],26:[2,8],28:[2,8],29:[2,8],31:[2,8],32:[2,8],34:[2,8]},{17:21,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:27,30:22,41:23,50:[1,26],52:[1,25],53:24},{4:28,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],28:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{4:29,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],28:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{12:[1,30]},{30:32,35:31,42:[1,33],43:[1,34],50:[1,26],53:24},{17:35,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:36,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:37,30:22,41:23,50:[1,26],52:[1,25],53:24},{25:[1,38]},{18:[2,48],25:[2,48],33:[2,48],39:39,42:[2,48],43:[2,48],44:[2,48],45:[2,48],46:[2,48],50:[2,48],52:[2,48]},{18:[2,22],25:[2,22],33:[2,22],46:[2,22]},{18:[2,35],25:[2,35],33:[2,35],42:[2,35],43:[2,35],44:[2,35],45:[2,35],46:[2,35],50:[2,35],52:[2,35],54:[1,40]},{30:41,50:[1,26],53:24},{18:[2,37],25:[2,37],33:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],50:[2,37],52:[2,37],54:[2,37]},{33:[1,42]},{20:43,27:44,28:[1,45],29:[2,40]},{23:46,27:47,28:[1,45],29:[2,42]},{15:[1,48]},{25:[2,46],30:51,36:49,38:50,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],47:57,48:58,49:60,50:[1,59],52:[1,25],53:24},{25:[2,31],42:[2,31],43:[2,31],44:[2,31],45:[2,31],50:[2,31],52:[2,31]},{25:[2,32],42:[2,32],43:[2,32],44:[2,32],45:[2,32],50:[2,32],52:[2,32]},{25:[2,33],42:[2,33],43:[2,33],44:[2,33],45:[2,33],50:[2,33],52:[2,33]},{25:[1,61]},{25:[1,62]},{18:[1,63]},{5:[2,17],12:[2,17],13:[2,17],16:[2,17],24:[2,17],26:[2,17],28:[2,17],29:[2,17],31:[2,17],32:[2,17],34:[2,17]},{18:[2,50],25:[2,50],30:51,33:[2,50],36:65,40:64,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],46:[2,50],47:66,48:58,49:60,50:[1,59],52:[1,25],53:24},{50:[1,67]},{18:[2,34],25:[2,34],33:[2,34],42:[2,34],43:[2,34],44:[2,34],45:[2,34],46:[2,34],50:[2,34],52:[2,34]},{5:[2,18],12:[2,18],13:[2,18],16:[2,18],24:[2,18],26:[2,18],28:[2,18],29:[2,18],31:[2,18],32:[2,18],34:[2,18]},{21:68,29:[1,69]},{29:[2,41]},{4:70,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{21:71,29:[1,69]},{29:[2,43]},{5:[2,9],12:[2,9],13:[2,9],16:[2,9],24:[2,9],26:[2,9],28:[2,9],29:[2,9],31:[2,9],32:[2,9],34:[2,9]},{25:[2,44],37:72,47:73,48:58,49:60,50:[1,74]},{25:[1,75]},{18:[2,23],25:[2,23],33:[2,23],42:[2,23],43:[2,23],44:[2,23],45:[2,23],46:[2,23],50:[2,23],52:[2,23]},{18:[2,24],25:[2,24],33:[2,24],42:[2,24],43:[2,24],44:[2,24],45:[2,24],46:[2,24],50:[2,24],52:[2,24]},{18:[2,25],25:[2,25],33:[2,25],42:[2,25],43:[2,25],44:[2,25],45:[2,25],46:[2,25],50:[2,25],52:[2,25]},{18:[2,26],25:[2,26],33:[2,26],42:[2,26],43:[2,26],44:[2,26],45:[2,26],46:[2,26],50:[2,26],52:[2,26]},{18:[2,27],25:[2,27],33:[2,27],42:[2,27],43:[2,27],44:[2,27],45:[2,27],46:[2,27],50:[2,27],52:[2,27]},{17:76,30:22,41:23,50:[1,26],52:[1,25],53:24},{25:[2,47]},{18:[2,29],25:[2,29],33:[2,29],46:[2,29],49:77,50:[1,74]},{18:[2,37],25:[2,37],33:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],50:[2,37],51:[1,78],52:[2,37],54:[2,37]},{18:[2,52],25:[2,52],33:[2,52],46:[2,52],50:[2,52]},{12:[2,13],13:[2,13],16:[2,13],24:[2,13],26:[2,13],28:[2,13],29:[2,13],31:[2,13],32:[2,13],34:[2,13]},{12:[2,14],13:[2,14],16:[2,14],24:[2,14],26:[2,14],28:[2,14],29:[2,14],31:[2,14],32:[2,14],34:[2,14]},{12:[2,10]},{18:[2,21],25:[2,21],33:[2,21],46:[2,21]},{18:[2,49],25:[2,49],33:[2,49],42:[2,49],43:[2,49],44:[2,49],45:[2,49],46:[2,49],50:[2,49],52:[2,49]},{18:[2,51],25:[2,51],33:[2,51],46:[2,51]},{18:[2,36],25:[2,36],33:[2,36],42:[2,36],43:[2,36],44:[2,36],45:[2,36],46:[2,36],50:[2,36],52:[2,36],54:[2,36]},{5:[2,11],12:[2,11],13:[2,11],16:[2,11],24:[2,11],26:[2,11],28:[2,11],29:[2,11],31:[2,11],32:[2,11],34:[2,11]},{30:79,50:[1,26],53:24},{29:[2,15]},{5:[2,12],12:[2,12],13:[2,12],16:[2,12],24:[2,12],26:[2,12],28:[2,12],29:[2,12],31:[2,12],32:[2,12],34:[2,12]},{25:[1,80]},{25:[2,45]},{51:[1,78]},{5:[2,20],12:[2,20],13:[2,20],16:[2,20],24:[2,20],26:[2,20],28:[2,20],29:[2,20],31:[2,20],32:[2,20],34:[2,20]},{46:[1,81]},{18:[2,53],25:[2,53],33:[2,53],46:[2,53],50:[2,53]},{30:51,36:82,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],50:[1,26],52:[1,25],53:24},{25:[1,83]},{5:[2,19],12:[2,19],13:[2,19],16:[2,19],24:[2,19],26:[2,19],28:[2,19],29:[2,19],31:[2,19],32:[2,19],34:[2,19]},{18:[2,28],25:[2,28],33:[2,28],42:[2,28],43:[2,28],44:[2,28],45:[2,28],46:[2,28],50:[2,28],52:[2,28]},{18:[2,30],25:[2,30],33:[2,30],46:[2,30],50:[2,30]},{5:[2,16],12:[2,16],13:[2,16],16:[2,16],24:[2,16],26:[2,16],28:[2,16],29:[2,16],31:[2,16],32:[2,16],34:[2,16]}],defaultActions:{4:[2,1],44:[2,41],47:[2,43],57:[2,47],63:[2,10],70:[2,15],73:[2,45]},parseError:function(e,t){throw new Error(e)},parse:function(e){var t=this,n=[0],i=[null],r=[],s=this.table,o="",a=0,l=0,c=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var u=this.lexer.yylloc;r.push(u);var d=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var h,p,f,m,g,v,y,b,_,w={};;){if(f=n[n.length-1],this.defaultActions[f]?m=this.defaultActions[f]:(null!==h&&void 0!==h||(h=function(){var e;return e=t.lexer.lex()||1,"number"!=typeof e&&(e=t.symbols_[e]||e),e}()),m=s[f]&&s[f][h]),void 0===m||!m.length||!m[0]){var x="";if(!c){_=[];for(v in s[f])this.terminals_[v]&&v>2&&_.push("'"+this.terminals_[v]+"'");x=this.lexer.showPosition?"Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+_.join(", ")+", got '"+(this.terminals_[h]||h)+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==h?"end of input":"'"+(this.terminals_[h]||h)+"'"),this.parseError(x,{text:this.lexer.match,token:this.terminals_[h]||h,line:this.lexer.yylineno,loc:u,expected:_})}}if(m[0]instanceof Array&&m.length>1)throw new Error("Parse Error: multiple actions possible at state: "+f+", token: "+h);switch(m[0]){case 1:n.push(h),i.push(this.lexer.yytext),r.push(this.lexer.yylloc),n.push(m[1]),h=null,p?(h=p,p=null):(l=this.lexer.yyleng,o=this.lexer.yytext,a=this.lexer.yylineno,u=this.lexer.yylloc,c>0&&c--);break;case 2:if(y=this.productions_[m[1]][1],w.$=i[i.length-y],w._$={first_line:r[r.length-(y||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(y||1)].first_column,last_column:r[r.length-1].last_column},d&&(w._$.range=[r[r.length-(y||1)].range[0],r[r.length-1].range[1]]),void 0!==(g=this.performAction.call(w,o,l,a,this.yy,m[1],i,r)))return g;y&&(n=n.slice(0,-1*y*2),i=i.slice(0,-1*y),r=r.slice(0,-1*y)),n.push(this.productions_[m[1]][0]),i.push(w.$),r.push(w._$),b=s[n[n.length-2]][n[n.length-1]],n.push(b);break;case 3:return!0}}return!0}},n=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,i,r;this._more||(this.yytext="",this.match="");for(var s=this._currentRules(),o=0;o<s.length&&(!(n=this._input.match(this.rules[s[o]]))||t&&!(n[0].length>t[0].length)||(t=n,i=o,this.options.flex));o++);return t?(r=t[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,s[i],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return void 0!==e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)}};return e.options={},e.performAction=function(e,t,n,i){function r(e,n){return t.yytext=t.yytext.substr(e,t.yyleng-n)}switch(n){case 0:if("\\\\"===t.yytext.slice(-2)?(r(0,1),this.begin("mu")):"\\"===t.yytext.slice(-1)?(r(0,1),this.begin("emu")):this.begin("mu"),t.yytext)return 12;break;case 1:return 12;case 2:return this.popState(),12;case 3:return t.yytext=t.yytext.substr(5,t.yyleng-9),this.popState(),15;case 4:return 12;case 5:return r(0,4),this.popState(),13;case 6:return 45;case 7:return 46;case 8:return 16;case 9:return this.popState(),this.begin("raw"),18;case 10:return 34;case 11:return 24;case 12:return 29;case 13:case 14:return this.popState(),28;case 15:case 16:return 26;case 17:return 32;case 18:return 31;case 19:this.popState(),this.begin("com");break;case 20:return r(3,5),this.popState(),13;case 21:return 31;case 22:return 51;case 23:case 24:return 50;case 25:return 54;case 26:break;case 27:return this.popState(),33;case 28:return this.popState(),25;case 29:return t.yytext=r(1,2).replace(/\\"/g,'"'),42;case 30:return t.yytext=r(1,2).replace(/\\'/g,"'"),42;case 31:return 52;case 32:case 33:return 44;case 34:return 43;case 35:return 50;case 36:return t.yytext=r(1,2),50;case 37:return"INVALID";case 38:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[5],inclusive:!1},raw:{rules:[3,4],inclusive:!1},INITIAL:{rules:[0,1,38],inclusive:!0}},e}();return t.lexer=n,e.prototype=t,t.Parser=e,new e}()}(),l=function(e){"use strict";function t(e,t){return{left:"~"===e.charAt(2),right:"~"===t.charAt(t.length-3)}}function n(e,t,n,i,l,u){if(e.sexpr.id.original!==i.path.original)throw new c(e.sexpr.id.original+" doesn't match "+i.path.original,e);var d=n&&n.program,h={left:e.strip.left,right:i.strip.right,openStandalone:s(t.statements),closeStandalone:r((d||t).statements)};if(e.strip.right&&o(t.statements,null,!0),d){var p=n.strip;p.left&&a(t.statements,null,!0),p.right&&o(d.statements,null,!0),i.strip.left&&a(d.statements,null,!0),r(t.statements)&&s(d.statements)&&(a(t.statements),o(d.statements))}else i.strip.left&&a(t.statements,null,!0);return l?new this.BlockNode(e,d,t,h,u):new this.BlockNode(e,t,d,h,u)}function i(e,t){for(var n=0,i=e.length;n<i;n++){var l=e[n],c=l.strip;if(c){var u=r(e,n,t,l.type),d=s(e,n,t),h=c.openStandalone&&u,p=c.closeStandalone&&d,f=c.inlineStandalone&&u&&d;c.right&&o(e,n,!0),c.left&&a(e,n,!0),f&&(o(e,n),a(e,n)&&"partial"===l.type&&(l.indent=/([ \t]+$)/.exec(e[n-1].original)?RegExp.$1:"")),h&&(o((l.program||l.inverse).statements),a(e,n)),p&&(o(e,n),a((l.inverse||l.program).statements))}}return e}function r(e,t,n){void 0===t&&(t=e.length);var i=e[t-1],r=e[t-2];return i?"content"===i.type?(r||!n?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(i.original):void 0:n}function s(e,t,n){void 0===t&&(t=-1);var i=e[t+1],r=e[t+2];return i?"content"===i.type?(r||!n?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(i.original):void 0:n}function o(e,t,n){var i=e[null==t?0:t+1];if(i&&"content"===i.type&&(n||!i.rightStripped)){var r=i.string;i.string=i.string.replace(n?/^\s+/:/^[ \t]*\r?\n?/,""),i.rightStripped=i.string!==r}}function a(e,t,n){var i=e[null==t?e.length-1:t-1];if(i&&"content"===i.type&&(n||!i.leftStripped)){var r=i.string;return i.string=i.string.replace(n?/\s+$/:/[ \t]+$/,""),i.leftStripped=i.string!==r,i.leftStripped}}var l={},c=e;return l.stripFlags=t,l.prepareBlock=n,l.prepareProgram=i,l}(n),c=function(e,t,n,i){"use strict";function r(e){return e.constructor===a.ProgramNode?e:(o.yy=u,o.parse(e))}var s={},o=e,a=t,l=n,c=i.extend;s.parser=o;var u={};return c(u,l,a),s.parse=r,s}(a,o,l,t),u=function(e,t){"use strict";function n(){}function i(e,t,n){if(null==e||"string"!=typeof e&&e.constructor!==n.AST.ProgramNode)throw new a("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);t=t||{},"data"in t||(t.data=!0),t.compat&&(t.useDepths=!0);var i=n.parse(e),r=(new n.Compiler).compile(i,t);return(new n.JavaScriptCompiler).compile(r,t)}function r(e,t,n){function i(){var i=n.parse(e),r=(new n.Compiler).compile(i,t),s=(new n.JavaScriptCompiler).compile(r,t,void 0,!0);return n.template(s)}if(null==e||"string"!=typeof e&&e.constructor!==n.AST.ProgramNode)throw new a("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+e);t=t||{},"data"in t||(t.data=!0),t.compat&&(t.useDepths=!0);var r,s=function(e,t){return r||(r=i()),r.call(this,e,t)};return s._setup=function(e){return r||(r=i()),r._setup(e)},s._child=function(e,t,n){return r||(r=i()),r._child(e,t,n)},s}function s(e,t){if(e===t)return!0;if(l(e)&&l(t)&&e.length===t.length){for(var n=0;n<e.length;n++)if(!s(e[n],t[n]))return!1;return!0}}var o={},a=e,l=t.isArray,c=[].slice;return o.Compiler=n,n.prototype={compiler:n,equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var n=0;n<t;n++){var i=this.opcodes[n],r=e.opcodes[n];if(i.opcode!==r.opcode||!s(i.args,r.args))return!1}for(t=this.children.length,n=0;n<t;n++)if(!this.children[n].equals(e.children[n]))return!1;return!0},guid:0,compile:function(e,t){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=t,this.stringParams=t.stringParams,this.trackIds=t.trackIds;var n=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},n)for(var i in n)this.options.knownHelpers[i]=n[i];return this.accept(e)},accept:function(e){return this[e.type](e)},program:function(e){for(var t=e.statements,n=0,i=t.length;n<i;n++)this.accept(t[n]);return this.isSimple=1===i,
this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t,n=(new this.compiler).compile(e,this.options),i=this.guid++;this.usePartial=this.usePartial||n.usePartial,this.children[i]=n;for(var r=0,s=n.depths.list.length;r<s;r++)(t=n.depths.list[r])<2||this.addDepth(t-1);return i},block:function(e){var t=e.mustache,n=e.program,i=e.inverse;n&&(n=this.compileProgram(n)),i&&(i=this.compileProgram(i));var r=t.sexpr,s=this.classifySexpr(r);"helper"===s?this.helperSexpr(r,n,i):"simple"===s?(this.simpleSexpr(r),this.opcode("pushProgram",n),this.opcode("pushProgram",i),this.opcode("emptyHash"),this.opcode("blockValue",r.id.original)):(this.ambiguousSexpr(r,n,i),this.opcode("pushProgram",n),this.opcode("pushProgram",i),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(e){var t,n,i=e.pairs;for(this.opcode("pushHash"),t=0,n=i.length;t<n;t++)this.pushParam(i[t][1]);for(;t--;)this.opcode("assignToHash",i[t][0]);this.opcode("popHash")},partial:function(e){var t=e.partialName;this.usePartial=!0,e.hash?this.accept(e.hash):this.opcode("push","undefined"),e.context?this.accept(e.context):(this.opcode("getContext",0),this.opcode("pushContext")),this.opcode("invokePartial",t.name,e.indent||""),this.opcode("append")},content:function(e){e.string&&this.opcode("appendContent",e.string)},mustache:function(e){this.sexpr(e.sexpr),e.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousSexpr:function(e,t,n){var i=e.id,r=i.parts[0],s=null!=t||null!=n;this.opcode("getContext",i.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.ID(i),this.opcode("invokeAmbiguous",r,s)},simpleSexpr:function(e){var t=e.id;"DATA"===t.type?this.DATA(t):t.parts.length?this.ID(t):(this.addDepth(t.depth),this.opcode("getContext",t.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,t,n){var i=this.setupFullMustacheParams(e,t,n),r=e.id,s=r.parts[0];if(this.options.knownHelpers[s])this.opcode("invokeKnownHelper",i.length,s);else{if(this.options.knownHelpersOnly)throw new a("You specified knownHelpersOnly, but used the unknown helper "+s,e);r.falsy=!0,this.ID(r),this.opcode("invokeHelper",i.length,r.original,r.isSimple)}},sexpr:function(e){var t=this.classifySexpr(e);"simple"===t?this.simpleSexpr(e):"helper"===t?this.helperSexpr(e):this.ambiguousSexpr(e)},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth),e.parts[0]?this.opcode("lookupOnContext",e.parts,e.falsy,e.isScoped):this.opcode("pushContext")},DATA:function(e){this.options.data=!0,this.opcode("lookupData",e.id.depth,e.id.parts)},STRING:function(e){this.opcode("pushString",e.string)},NUMBER:function(e){this.opcode("pushLiteral",e.number)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:c.call(arguments,1)})},addDepth:function(e){0!==e&&(this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e)))},classifySexpr:function(e){var t=e.isHelper,n=e.eligibleHelper,i=this.options;if(n&&!t){var r=e.id.parts[0];i.knownHelpers[r]?t=!0:i.knownHelpersOnly&&(n=!1)}return t?"helper":n?"ambiguous":"simple"},pushParams:function(e){for(var t=0,n=e.length;t<n;t++)this.pushParam(e[t])},pushParam:function(e){this.stringParams?(e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",e.stringModeValue,e.type),"sexpr"===e.type&&this.sexpr(e)):(this.trackIds&&this.opcode("pushId",e.type,e.idName||e.stringModeValue),this.accept(e))},setupFullMustacheParams:function(e,t,n){var i=e.params;return this.pushParams(i),this.opcode("pushProgram",t),this.opcode("pushProgram",n),e.hash?this.hash(e.hash):this.opcode("emptyHash"),i}},o.precompile=i,o.compile=r,o}(n,t),d=function(e,t){"use strict";function n(e){this.value=e}function i(){}var r=e.COMPILER_REVISION,s=e.REVISION_CHANGES,o=t;i.prototype={nameLookup:function(e,t){return i.isValidJavaScriptVariableName(t)?e+"."+t:e+"['"+t+"']"},depthedLookup:function(e){return this.aliases.lookup="this.lookup",'lookup(depths, "'+e+'")'},compilerInfo:function(){var e=r;return[e,s[e]]},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":{appendToBuffer:!0,content:e,toString:function(){return"buffer += "+e+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(e,t,n,i){this.environment=e,this.options=t,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!i,this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.compileChildren(e,t),this.useDepths=this.useDepths||e.depths.list.length||this.options.compat;var r,s,a,l=e.opcodes;for(s=0,a=l.length;s<a;s++)r=l[s],this[r.opcode].apply(this,r.args);if(this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new o("Compile completed with content left on stack");var c=this.createFunctionContext(i);if(this.isChild)return c;var u={compiler:this.compilerInfo(),main:c},d=this.context.programs;for(s=0,a=d.length;s<a;s++)d[s]&&(u[s]=d[s]);return this.environment.usePartial&&(u.usePartial=!0),this.options.data&&(u.useData=!0),this.useDepths&&(u.useDepths=!0),this.options.compat&&(u.compat=!0),i||(u.compiler=JSON.stringify(u.compiler),u=this.objectLiteral(u)),u},preamble:function(){this.lastContext=0,this.source=[]},createFunctionContext:function(e){var t="",n=this.stackVars.concat(this.registers.list);n.length>0&&(t+=", "+n.join(", "));for(var i in this.aliases)this.aliases.hasOwnProperty(i)&&(t+=", "+i+"="+this.aliases[i]);var r=["depth0","helpers","partials","data"];this.useDepths&&r.push("depths");var s=this.mergeSource(t);return e?(r.push(s),Function.apply(this,r)):"function("+r.join(",")+") {\n  "+s+"}"},mergeSource:function(e){for(var t,n,i="",r=!this.forceBuffer,s=0,o=this.source.length;s<o;s++){var a=this.source[s];a.appendToBuffer?t=t?t+"\n    + "+a.content:a.content:(t&&(i?i+="buffer += "+t+";\n  ":(n=!0,i=t+";\n  "),t=void 0),i+=a+"\n  ",this.environment.isSimple||(r=!1))}return r?!t&&i||(i+="return "+(t||'""')+";\n"):(e+=", buffer = "+(n?"":this.initializeBuffer()),i+=t?"return buffer + "+t+";\n":"return buffer;\n"),e&&(i="var "+e.substring(2)+(n?"":";\n  ")+i),i},blockValue:function(e){this.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=[this.contextName(0)];this.setupParams(e,0,t);var n=this.popStack();t.splice(1,0,n),this.push("blockHelperMissing.call("+t.join(", ")+")")},ambiguousBlockValue:function(){this.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=[this.contextName(0)];this.setupParams("",0,e,!0),this.flushInline();var t=this.topStack();e.splice(1,0,t),this.pushSource("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.pendingContent&&(e=this.pendingContent+e),this.pendingContent=e},append:function(){this.flushInline();var e=this.popStack();this.pushSource("if ("+e+" != null) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(e){this.lastContext=e},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(e,t,n){var i=0,r=e.length;for(n||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(e[i++]));i<r;i++)this.replaceStack(function(n){var r=this.nameLookup(n,e[i],"context");return t?" && "+r:" != null ? "+r+" : "+n})},lookupData:function(e,t){e?this.pushStackLiteral("this.data(data, "+e+")"):this.pushStackLiteral("data");for(var n=t.length,i=0;i<n;i++)this.replaceStack(function(e){return" && "+this.nameLookup(e,t[i],"data")})},resolvePossibleLambda:function(){this.aliases.lambda="this.lambda",this.push("lambda("+this.popStack()+", "+this.contextName(0)+")")},pushStringParam:function(e,t){this.pushContext(),this.pushString(t),"sexpr"!==t&&("string"==typeof e?this.pushString(e):this.pushStackLiteral(e))},emptyHash:function(){this.pushStackLiteral("{}"),this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}"))},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var e=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push("{"+e.ids.join(",")+"}"),this.stringParams&&(this.push("{"+e.contexts.join(",")+"}"),this.push("{"+e.types.join(",")+"}")),this.push("{\n    "+e.values.join(",\n    ")+"\n  }")},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){return this.inlineStack.push(e),e},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){null!=e?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},invokeHelper:function(e,t,n){this.aliases.helperMissing="helpers.helperMissing";var i=this.popStack(),r=this.setupHelper(e,t),s=(n?r.name+" || ":"")+i+" || helperMissing";this.push("(("+s+").call("+r.callParams+"))")},invokeKnownHelper:function(e,t){var n=this.setupHelper(e,t);this.push(n.name+".call("+n.callParams+")")},invokeAmbiguous:function(e,t){this.aliases.functionType='"function"',this.aliases.helperMissing="helpers.helperMissing",this.useRegister("helper");var n=this.popStack();this.emptyHash();var i=this.setupHelper(0,e,t),r=this.lastHelper=this.nameLookup("helpers",e,"helper");this.push("((helper = (helper = "+r+" || "+n+") != null ? helper : helperMissing"+(i.paramsInit?"),("+i.paramsInit:"")+"),(typeof helper === functionType ? helper.call("+i.callParams+") : helper))")},invokePartial:function(e,t){var n=[this.nameLookup("partials",e,"partial"),"'"+t+"'","'"+e+"'",this.popStack(),this.popStack(),"helpers","partials"];this.options.data?n.push("data"):this.options.compat&&n.push("undefined"),this.options.compat&&n.push("depths"),this.push("this.invokePartial("+n.join(", ")+")")},assignToHash:function(e){var t,n,i,r=this.popStack();this.trackIds&&(i=this.popStack()),this.stringParams&&(n=this.popStack(),t=this.popStack());var s=this.hash;t&&s.contexts.push("'"+e+"': "+t),n&&s.types.push("'"+e+"': "+n),i&&s.ids.push("'"+e+"': "+i),s.values.push("'"+e+"': ("+r+")")},pushId:function(e,t){"ID"===e||"DATA"===e?this.pushString(t):"sexpr"===e?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:i,compileChildren:function(e,t){for(var n,i,r=e.children,s=0,o=r.length;s<o;s++){n=r[s],i=new this.compiler;var a=this.matchExistingProgram(n);null==a?(this.context.programs.push(""),a=this.context.programs.length,n.index=a,n.name="program"+a,this.context.programs[a]=i.compile(n,t,this.context,!this.precompile),this.context.environments[a]=n,this.useDepths=this.useDepths||i.useDepths):(n.index=a,n.name="program"+a)}},matchExistingProgram:function(e){for(var t=0,n=this.context.environments.length;t<n;t++){var i=this.context.environments[t];if(i&&i.equals(e))return t}},programExpression:function(e){var t=this.environment.children[e],n=(t.depths.list,this.useDepths),i=[t.index,"data"];return n&&i.push("depths"),"this.program("+i.join(", ")+")"},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.push(new n(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=void 0),e&&this.source.push(e)},pushStack:function(e){this.flushInline();var t=this.incrStack();return this.pushSource(t+" = "+e+";"),this.compileStack.push(t),t},replaceStack:function(e){var t,i,r,s="";this.isInline();if(!this.isInline())throw new o("replaceStack on non-inline");var a=this.popStack(!0);if(a instanceof n)s=t=a.value,r=!0;else{i=!this.stackSlot;var l=i?this.incrStack():this.topStackName();s="("+this.push(l)+" = "+a+")",t=this.topStack()}var c=e.call(this,t);r||this.popStack(),i&&this.stackSlot--,this.push("("+s+c+")")},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;if(e.length){this.inlineStack=[];for(var t=0,i=e.length;t<i;t++){var r=e[t];r instanceof n?this.compileStack.push(r):this.pushStack(r)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),i=(t?this.inlineStack:this.compileStack).pop();if(!e&&i instanceof n)return i.value;if(!t){if(!this.stackSlot)throw new o("Invalid stack pop");this.stackSlot--}return i},topStack:function(){var e=this.isInline()?this.inlineStack:this.compileStack,t=e[e.length-1];return t instanceof n?t.value:t},contextName:function(e){return this.useDepths&&e?"depths["+e+"]":"depth"+e},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(this.quotedString(n)+":"+e[n]);return"{"+t.join(",")+"}"},setupHelper:function(e,t,n){var i=[];return{params:i,paramsInit:this.setupParams(t,e,i,n),name:this.nameLookup("helpers",t,"helper"),callParams:[this.contextName(0)].concat(i).join(", ")}},setupOptions:function(e,t,n){var i,r,s,o={},a=[],l=[],c=[];o.name=this.quotedString(e),o.hash=this.popStack(),this.trackIds&&(o.hashIds=this.popStack()),this.stringParams&&(o.hashTypes=this.popStack(),o.hashContexts=this.popStack()),r=this.popStack(),((s=this.popStack())||r)&&(s||(s="this.noop"),r||(r="this.noop"),o.fn=s,o.inverse=r);for(var u=t;u--;)i=this.popStack(),n[u]=i,this.trackIds&&(c[u]=this.popStack()),this.stringParams&&(l[u]=this.popStack(),a[u]=this.popStack());return this.trackIds&&(o.ids="["+c.join(",")+"]"),this.stringParams&&(o.types="["+l.join(",")+"]",o.contexts="["+a.join(",")+"]"),this.options.data&&(o.data="data"),o},setupParams:function(e,t,n,i){var r=this.objectLiteral(this.setupOptions(e,t,n));return i?(this.useRegister("options"),n.push("options"),"options="+r):(n.push(r),"")}};for(var a="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),l=i.RESERVED_WORDS={},c=0,u=a.length;c<u;c++)l[a[c]]=!0;return i.isValidJavaScriptVariableName=function(e){return!i.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e)},i}(i,n);return function(e,t,n,i,r){"use strict";var s=e,o=t,a=n.parser,l=n.parse,c=i.Compiler,u=i.compile,d=i.precompile,h=r,p=s.create,f=function(){var e=p();return e.compile=function(t,n){return u(t,n,e)},e.precompile=function(t,n){return d(t,n,e)},e.AST=o,e.Compiler=c,e.JavaScriptCompiler=h,e.Parser=a,e.parse=l,e};return s=f(),s.create=f,s.default=s,s}(s,o,c,u,d)}),define("handlebars",["handlebars-lib"],function(e){return this.Handlebars=e,e}),function(e){define("jsUri",[],function(){return function(){return function(e){function t(e){return e=decodeURIComponent(e),e=e.replace("+"," ")}function n(e){var t=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],i=t.exec(e||""),r={};return n.forEach(function(e,t){r[e]=i[t]||""}),r}function i(e){var t,n,i,r,s,o,a=[];if(void 0===e||null===e||""===e)return a;for(0===e.indexOf("?")&&(e=e.substring(1)),n=e.toString().split(/[&;]/),t=0;t<n.length;t++)i=n[t],r=i.split("="),s=r[0],o=-1===i.indexOf("=")?null:null===r[1]?"":r[1],a.push([s,o]);return a}function r(e){this.uriParts=n(e),this.queryPairs=i(this.uriParts.query),this.hasAuthorityPrefixUserPref=null}Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var n=0,i=this.length;n<i;++n)e.call(t||this,this[n],n,this)}),["protocol","userInfo","host","port","path","anchor"].forEach(function(e){r.prototype[e]=function(t){return void 0!==t&&(this.uriParts[e]=t),this.uriParts[e]}}),r.prototype.hasAuthorityPrefix=function(e){return void 0!==e&&(this.hasAuthorityPrefixUserPref=e),null===this.hasAuthorityPrefixUserPref?-1!==this.uriParts.source.indexOf("//"):this.hasAuthorityPrefixUserPref},r.prototype.query=function(e){var t,n,r="";for(void 0!==e&&(this.queryPairs=i(e)),t=0;t<this.queryPairs.length;t++)n=this.queryPairs[t],r.length>0&&(r+="&"),null===n[1]?r+=n[0]:r+=n.join("=");return r.length>0?"?"+r:r},r.prototype.getQueryParamValue=function(e){var n,i;for(i=0;i<this.queryPairs.length;i++)if(n=this.queryPairs[i],t(e)===t(n[0]))return n[1]},r.prototype.getQueryParamValues=function(e){var n,i,r=[];for(n=0;n<this.queryPairs.length;n++)i=this.queryPairs[n],t(e)===t(i[0])&&r.push(i[1]);return r},r.prototype.deleteQueryParam=function(e,n){var i,r,s,o,a=[];for(i=0;i<this.queryPairs.length;i++)r=this.queryPairs[i],s=t(r[0])===t(e),o=t(r[1])===t(n),(1===arguments.length&&!s||2===arguments.length&&!s&&!o)&&a.push(r);return this.queryPairs=a,this},r.prototype.addQueryParam=function(e,t,n){return 3===arguments.length&&-1!==n?(n=Math.min(n,this.queryPairs.length),this.queryPairs.splice(n,0,[e,t])):arguments.length>0&&this.queryPairs.push([e,t]),this},r.prototype.replaceQueryParam=function(e,n,i){var r,s,o=-1;if(3===arguments.length){for(r=0;r<this.queryPairs.length;r++)if(s=this.queryPairs[r],t(s[0])===t(e)&&decodeURIComponent(s[1])===t(i)){o=r;break}this.deleteQueryParam(e,i).addQueryParam(e,n,o)}else{for(r=0;r<this.queryPairs.length;r++)if(s=this.queryPairs[r],t(s[0])===t(e)){o=r;break}this.deleteQueryParam(e),this.addQueryParam(e,n,o)}return this},["protocol","hasAuthorityPrefix","userInfo","host","port","path","query","anchor"].forEach(function(e){var t="set"+e.charAt(0).toUpperCase()+e.slice(1);r.prototype[t]=function(t){return this[e](t),this}}),r.prototype.scheme=function(){var e="";return this.protocol()?(e+=this.protocol(),this.protocol().indexOf(":")!==this.protocol().length-1&&(e+=":"),e+="//"):this.hasAuthorityPrefix()&&this.host()&&(e+="//"),e},r.prototype.origin=function(){var e=this.scheme();return this.userInfo()&&this.host()&&(e+=this.userInfo(),this.userInfo().indexOf("@")!==this.userInfo().length-1&&(e+="@")),this.host()&&(e+=this.host(),this.port()&&(e+=":"+this.port())),e},r.prototype.toString=function(){var e=this.origin();return this.path()?e+=this.path():this.host()&&(this.query().toString()||this.anchor())&&(e+="/"),this.query().toString()&&(0!==this.query().toString().indexOf("?")&&(e+="?"),e+=this.query().toString()),this.anchor()&&(0!==this.anchor().indexOf("#")&&(e+="#"),e+=this.anchor()),e},r.prototype.clone=function(){return new r(this.toString())},"undefined"==typeof module?e.Uri=r:module.exports=r}(this),e.Uri=Uri}.apply(e,arguments)})}(this),define("env",["require","exports","module","underscore","handlebars","jsUri"],function(e,t,n){"use strict";var i=e("underscore"),r=e("handlebars"),s=e("jsUri"),o=function(e){var t={apiBaseUrl:"//api-staging.mojang.com",authBaseUrl:"//yggdrasil-auth-staging.mojang.zone",endpoints:{},agent:"minecraft"};return i.extend(t,e),t.endpoints.user="/user",t.endpoints.userProfiles="/user/profiles/agent/{{agent}}",t.endpoints.register="/user",t.endpoints.verify="/user/email/{{email}}/token/{{token}}",t.endpoints.resendVerification="/user/verification",t.endpoints.profileName="/user/profile/agent/{{agent}}/name/{{profileName}}",t.endpoints.createOrder="/order",t.endpoints.getOrder="/order/{{id}}",t.endpoints.consent="/user/parentalconsent",t.endpoints.location="/user/location",t.endpoints.countries="/globalization/countries",t.endpoints.product="/catalog/product/{{productId}}",t.endpoints.variant="/catalog/product/variant/{{variantId}}",t.endpoints.prices="/catalog/prices",t.endpoints.orderPrice="/order/price",t.endpoints.paymentMethods="/payment/methods",t.endpoints.secureLocation="/user/security/location",t.endpoints.securityChallenges="/user/security/challenges",t.endpoints.auth={route:"/authenticate",host:t.authBaseUrl},t.endpoints.verifyAdyenOrder="/payment/adyen/verification",t.endpoints.orders="/orders",t.endpoints.order="/order",t.endpoints.redeemGift="/token/redeem",t.endpoints.createProfile="/user/profile/token",i.extend(t.endpoints,e.endpoints),{endpoints:t.endpoints,options:t,buildEndpointURI:function(e,n){var r,o;return i.isObject(e)&&e.host?(r=new s(e.host),o=e.route):(r=new s(t.apiBaseUrl),o=e),n&&(n=this.sanitizeData(n),o=this.compilePathWithData(o,n)),r.setPath(o).toString()},compilePathWithData:function(e,t){return r.compile(e)(t)},sanitizeData:function(e){for(var t in e)e.hasOwnProperty(t)&&(e[t]=encodeURIComponent(e[t]));return e}}},a=null;o.getInstance=function(){if(!a)throw"No instance created yet";return a},o.start=function(e){return a||(a=new o(e)),a},o.getEndpoint=function(e,t){return a||o.start(),a.buildEndpointURI(a.endpoints[e],t)},o.getCurrentSettings=function(){if(!a)throw"EnvHandler not instantiated";return a.options},n.exports=o}),define("app-config",["require","module"],function(e){"use strict";var t=e("module");return t.config?t.config():{}}),function(e,t){function n(e){return d.PF.compile(e||"nplurals=2; plural=(n != 1);")}function i(e,t){this._key=e,this._i18n=t}var r=Array.prototype,s=Object.prototype,o=r.slice,a=s.hasOwnProperty,l=r.forEach,c={},u={forEach:function(e,t,n){var i,r,s;if(null!==e)if(l&&e.forEach===l)e.forEach(t,n);else if(e.length===+e.length){for(i=0,r=e.length;i<r;i++)if(i in e&&t.call(n,e[i],i,e)===c)return}else for(s in e)if(a.call(e,s)&&t.call(n,e[s],s,e)===c)return},extend:function(e){return this.forEach(o.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e}},d=function(e){if(this.defaults={locale_data:{messages:{"":{domain:"messages",lang:"en",plural_forms:"nplurals=2; plural=(n != 1);"}}},domain:"messages",debug:!1},this.options=u.extend({},this.defaults,e),this.textdomain(this.options.domain),e.domain&&!this.options.locale_data[this.options.domain])throw new Error("Text domain set to non-existent domain: `"+e.domain+"`")};d.context_delimiter=String.fromCharCode(4),u.extend(i.prototype,{onDomain:function(e){return this._domain=e,this},withContext:function(e){return this._context=e,this},ifPlural:function(e,t){return this._val=e,this._pkey=t,this},fetch:function(e){return"[object Array]"!={}.toString.call(e)&&(e=[].slice.call(arguments,0)),(e&&e.length?d.sprintf:function(e){return e})(this._i18n.dcnpgettext(this._domain,this._context,this._key,this._pkey,this._val),e)}}),u.extend(d.prototype,{translate:function(e){return new i(e,this)},textdomain:function(e){if(!e)return this._textdomain;this._textdomain=e},gettext:function(e){return this.dcnpgettext.call(this,void 0,void 0,e)},dgettext:function(e,t){return this.dcnpgettext.call(this,e,void 0,t)},dcgettext:function(e,t){return this.dcnpgettext.call(this,e,void 0,t)},ngettext:function(e,t,n){return this.dcnpgettext.call(this,void 0,void 0,e,t,n)},dngettext:function(e,t,n,i){return this.dcnpgettext.call(this,e,void 0,t,n,i)},dcngettext:function(e,t,n,i){return this.dcnpgettext.call(this,e,void 0,t,n,i)},pgettext:function(e,t){return this.dcnpgettext.call(this,void 0,e,t)},dpgettext:function(e,t,n){return this.dcnpgettext.call(this,e,t,n)},dcpgettext:function(e,t,n){return this.dcnpgettext.call(this,e,t,n)},npgettext:function(e,t,n,i){return this.dcnpgettext.call(this,void 0,e,t,n,i)},dnpgettext:function(e,t,n,i,r){return this.dcnpgettext.call(this,e,t,n,i,r)},dcnpgettext:function(e,t,i,r,s){r=r||i,e=e||this._textdomain;var o;if(!this.options)return o=new d,o.dcnpgettext.call(o,void 0,void 0,i,r,s);if(!this.options.locale_data)throw new Error("No locale data provided.");if(!this.options.locale_data[e])throw new Error("Domain `"+e+"` was not found.");if(!this.options.locale_data[e][""])throw new Error("No locale meta information provided.");if(!i)throw new Error("No translation key found.");var a,l,c,u=t?t+d.context_delimiter+i:i,h=this.options.locale_data,p=h[e],f=(h.messages||this.defaults.locale_data.messages)[""],m=p[""].plural_forms||p[""]["Plural-Forms"]||p[""]["plural-forms"]||f.plural_forms||f["Plural-Forms"]||f["plural-forms"];if(void 0===s)c=0;else{if("number"!=typeof s&&(s=parseInt(s,10),isNaN(s)))throw new Error("The number that was passed in is not a number.");c=n(m)(s)}if(!p)throw new Error("No domain named `"+e+"` could be found.");return!(a=p[u])||c>a.length?(this.options.missing_key_callback&&this.options.missing_key_callback(u,e),l=[i,r],!0===this.options.debug&&console.log(l[n(m)(s)]),l[n()(s)]):(l=a[c])||(l=[i,r],l[n()(s)])}});var h=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function t(e,t){for(var n=[];t>0;n[--t]=e);return n.join("")}var n=function(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};return n.format=function(n,i){var r,s,o,a,l,c,u,d=1,p=n.length,f="",m=[];for(s=0;s<p;s++)if("string"===(f=e(n[s])))m.push(n[s]);else if("array"===f){if(a=n[s],a[2])for(r=i[d],o=0;o<a[2].length;o++){if(!r.hasOwnProperty(a[2][o]))throw h('[sprintf] property "%s" does not exist',a[2][o]);r=r[a[2][o]]}else r=a[1]?i[a[1]]:i[d++];if(/[^s]/.test(a[8])&&"number"!=e(r))throw h("[sprintf] expecting number but found %s",e(r));switch(void 0!==r&&null!==r||(r=""),a[8]){case"b":r=r.toString(2);break;case"c":r=String.fromCharCode(r);break;case"d":r=parseInt(r,10);break;case"e":r=a[7]?r.toExponential(a[7]):r.toExponential();break;case"f":r=a[7]?parseFloat(r).toFixed(a[7]):parseFloat(r);break;case"o":r=r.toString(8);break;case"s":r=(r=String(r))&&a[7]?r.substring(0,a[7]):r;break;case"u":r=Math.abs(r);break;case"x":r=r.toString(16);break;case"X":r=r.toString(16).toUpperCase()}r=/[def]/.test(a[8])&&a[3]&&r>=0?"+"+r:r,c=a[4]?"0"==a[4]?"0":a[4].charAt(1):" ",u=a[6]-String(r).length,l=a[6]?t(c,u):"",m.push(a[5]?r+l:l+r)}return m.join("")},n.cache={},n.parse=function(e){for(var t=e,n=[],i=[],r=0;t;){if(null!==(n=/^[^\x25]+/.exec(t)))i.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(t)))i.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw"[sprintf] huh?";if(n[2]){r|=1;var s=[],o=n[2],a=[];if(null===(a=/^([a-z_][a-z_\d]*)/i.exec(o)))throw"[sprintf] huh?";for(s.push(a[1]);""!==(o=o.substring(a[0].length));)if(null!==(a=/^\.([a-z_][a-z_\d]*)/i.exec(o)))s.push(a[1]);else{if(null===(a=/^\[(\d+)\]/.exec(o)))throw"[sprintf] huh?";s.push(a[1])}n[2]=s}else r|=2;if(3===r)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";i.push(n)}t=t.substring(n[0].length)}return i},n}(),p=function(e,t){return t.unshift(e),h.apply(null,t)};d.parse_plural=function(e,t){return e=e.replace(/n/g,t),d.parse_expression(e)},d.sprintf=function(e,t){return"[object Array]"=={}.toString.call(t)?p(e,[].slice.call(t)):h.apply(this,[].slice.call(arguments))},d.prototype.sprintf=function(){return d.sprintf.apply(this,arguments)},d.PF={},d.PF.parse=function(e){var t=d.PF.extractPluralExpr(e);return d.PF.parser.parse.call(d.PF.parser,t)},d.PF.compile=function(e){function t(e){return!0===e?1:e||0}var n=d.PF.parse(e);return function(e){return t(d.PF.interpreter(n)(e))}},d.PF.interpreter=function(e){return function(t){switch(e.type){case"GROUP":return d.PF.interpreter(e.expr)(t);case"TERNARY":return d.PF.interpreter(e.expr)(t)?d.PF.interpreter(e.truthy)(t):d.PF.interpreter(e.falsey)(t);case"OR":return d.PF.interpreter(e.left)(t)||d.PF.interpreter(e.right)(t);case"AND":return d.PF.interpreter(e.left)(t)&&d.PF.interpreter(e.right)(t);case"LT":return d.PF.interpreter(e.left)(t)<d.PF.interpreter(e.right)(t);case"GT":return d.PF.interpreter(e.left)(t)>d.PF.interpreter(e.right)(t);case"LTE":return d.PF.interpreter(e.left)(t)<=d.PF.interpreter(e.right)(t);case"GTE":return d.PF.interpreter(e.left)(t)>=d.PF.interpreter(e.right)(t);case"EQ":return d.PF.interpreter(e.left)(t)==d.PF.interpreter(e.right)(t);case"NEQ":return d.PF.interpreter(e.left)(t)!=d.PF.interpreter(e.right)(t);case"MOD":return d.PF.interpreter(e.left)(t)%d.PF.interpreter(e.right)(t);case"VAR":return t;case"NUM":return e.val;default:throw new Error("Invalid Token found.")}}},d.PF.extractPluralExpr=function(e){e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),/;\s*$/.test(e)||(e=e.concat(";"));var t,n=/nplurals\=(\d+);/,i=/plural\=(.*);/,r=e.match(n),s={};if(!(r.length>1))throw new Error("nplurals not found in plural_forms string: "+e);if(s.nplurals=r[1],e=e.replace(n,""),!((t=e.match(i))&&t.length>1))throw new Error("`plural` expression not found: "+e);return t[1]},d.PF.parser=function(){var e={trace:function(){},yy:{},symbols_:{error:2,expressions:3,e:4,EOF:5,"?":6,":":7,"||":8,"&&":9,"<":10,"<=":11,">":12,">=":13,"!=":14,"==":15,"%":16,"(":17,")":18,n:19,NUMBER:20,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",6:"?",7:":",8:"||",9:"&&",10:"<",11:"<=",12:">",13:">=",14:"!=",15:"==",16:"%",17:"(",18:")",19:"n",20:"NUMBER"},productions_:[0,[3,2],[4,5],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,1],[4,1]],performAction:function(e,t,n,i,r,s,o){var a=s.length-1;switch(r){case 1:return{type:"GROUP",expr:s[a-1]};case 2:this.$={type:"TERNARY",expr:s[a-4],truthy:s[a-2],falsey:s[a]};break;case 3:this.$={type:"OR",left:s[a-2],right:s[a]};break;case 4:this.$={type:"AND",left:s[a-2],right:s[a]};break;case 5:this.$={type:"LT",left:s[a-2],right:s[a]};break;case 6:this.$={type:"LTE",left:s[a-2],right:s[a]};break;case 7:this.$={type:"GT",left:s[a-2],right:s[a]};break;case 8:this.$={type:"GTE",left:s[a-2],right:s[a]};break;case 9:this.$={type:"NEQ",left:s[a-2],right:s[a]};break;case 10:this.$={type:"EQ",left:s[a-2],right:s[a]};break;case 11:this.$={type:"MOD",left:s[a-2],right:s[a]};break;case 12:this.$={type:"GROUP",expr:s[a-1]};break;case 13:this.$={type:"VAR"};break;case 14:this.$={type:"NUM",val:Number(e)}}},table:[{3:1,4:2,17:[1,3],19:[1,4],20:[1,5]},{1:[3]},{5:[1,6],6:[1,7],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16]},{4:17,17:[1,3],19:[1,4],20:[1,5]},{5:[2,13],6:[2,13],7:[2,13],8:[2,13],9:[2,13],10:[2,13],11:[2,13],12:[2,13],13:[2,13],14:[2,13],15:[2,13],16:[2,13],18:[2,13]},{5:[2,14],6:[2,14],7:[2,14],8:[2,14],9:[2,14],10:[2,14],11:[2,14],12:[2,14],13:[2,14],14:[2,14],15:[2,14],16:[2,14],18:[2,14]},{1:[2,1]},{4:18,17:[1,3],19:[1,4],20:[1,5]},{4:19,17:[1,3],19:[1,4],20:[1,5]},{4:20,17:[1,3],19:[1,4],20:[1,5]},{4:21,17:[1,3],19:[1,4],20:[1,5]},{4:22,17:[1,3],19:[1,4],20:[1,5]},{4:23,17:[1,3],19:[1,4],20:[1,5]},{4:24,17:[1,3],19:[1,4],20:[1,5]},{4:25,17:[1,3],19:[1,4],20:[1,5]},{4:26,17:[1,3],19:[1,4],20:[1,5]},{4:27,17:[1,3],19:[1,4],20:[1,5]},{6:[1,7],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[1,28]},{6:[1,7],7:[1,29],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16]},{5:[2,3],6:[2,3],7:[2,3],8:[2,3],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,3]},{5:[2,4],6:[2,4],7:[2,4],8:[2,4],9:[2,4],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,4]},{5:[2,5],6:[2,5],7:[2,5],8:[2,5],9:[2,5],10:[2,5],11:[2,5],12:[2,5],13:[2,5],14:[2,5],15:[2,5],16:[1,16],18:[2,5]},{5:[2,6],6:[2,6],7:[2,6],8:[2,6],9:[2,6],10:[2,6],11:[2,6],12:[2,6],
13:[2,6],14:[2,6],15:[2,6],16:[1,16],18:[2,6]},{5:[2,7],6:[2,7],7:[2,7],8:[2,7],9:[2,7],10:[2,7],11:[2,7],12:[2,7],13:[2,7],14:[2,7],15:[2,7],16:[1,16],18:[2,7]},{5:[2,8],6:[2,8],7:[2,8],8:[2,8],9:[2,8],10:[2,8],11:[2,8],12:[2,8],13:[2,8],14:[2,8],15:[2,8],16:[1,16],18:[2,8]},{5:[2,9],6:[2,9],7:[2,9],8:[2,9],9:[2,9],10:[2,9],11:[2,9],12:[2,9],13:[2,9],14:[2,9],15:[2,9],16:[1,16],18:[2,9]},{5:[2,10],6:[2,10],7:[2,10],8:[2,10],9:[2,10],10:[2,10],11:[2,10],12:[2,10],13:[2,10],14:[2,10],15:[2,10],16:[1,16],18:[2,10]},{5:[2,11],6:[2,11],7:[2,11],8:[2,11],9:[2,11],10:[2,11],11:[2,11],12:[2,11],13:[2,11],14:[2,11],15:[2,11],16:[2,11],18:[2,11]},{5:[2,12],6:[2,12],7:[2,12],8:[2,12],9:[2,12],10:[2,12],11:[2,12],12:[2,12],13:[2,12],14:[2,12],15:[2,12],16:[2,12],18:[2,12]},{4:30,17:[1,3],19:[1,4],20:[1,5]},{5:[2,2],6:[1,7],7:[2,2],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,2]}],defaultActions:{6:[2,1]},parseError:function(e,t){throw new Error(e)},parse:function(e){function t(){var e;return e=n.lexer.lex()||1,"number"!=typeof e&&(e=n.symbols_[e]||e),e}var n=this,i=[0],r=[null],s=[],o=this.table,a="",l=0,c=0,u=0,d=2;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;s.push(h),"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,m,g,v,y,b,_,w,x={};;){if(m=i[i.length-1],this.defaultActions[m]?g=this.defaultActions[m]:(null==p&&(p=t()),g=o[m]&&o[m][p]),void 0===g||!g.length||!g[0]){if(!u){w=[];for(y in o[m])this.terminals_[y]&&y>2&&w.push("'"+this.terminals_[y]+"'");var k="";k=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+this.terminals_[p]+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(k,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:h,expected:w})}if(3==u){if(1==p)throw new Error(k||"Parsing halted.");c=this.lexer.yyleng,a=this.lexer.yytext,l=this.lexer.yylineno,h=this.lexer.yylloc,p=t()}for(;;){if(d.toString()in o[m])break;if(0==m)throw new Error(k||"Parsing halted.");!function(e){i.length=i.length-2*e,r.length=r.length-e,s.length=s.length-e}(1),m=i[i.length-1]}f=p,p=d,m=i[i.length-1],g=o[m]&&o[m][d],u=3}if(g[0]instanceof Array&&g.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+p);switch(g[0]){case 1:i.push(p),r.push(this.lexer.yytext),s.push(this.lexer.yylloc),i.push(g[1]),p=null,f?(p=f,f=null):(c=this.lexer.yyleng,a=this.lexer.yytext,l=this.lexer.yylineno,h=this.lexer.yylloc,u>0&&u--);break;case 2:if(b=this.productions_[g[1]][1],x.$=r[r.length-b],x._$={first_line:s[s.length-(b||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(b||1)].first_column,last_column:s[s.length-1].last_column},void 0!==(v=this.performAction.call(x,a,c,l,this.yy,g[1],r,s)))return v;b&&(i=i.slice(0,-1*b*2),r=r.slice(0,-1*b),s=s.slice(0,-1*b)),i.push(this.productions_[g[1]][0]),r.push(x.$),s.push(x._$),_=o[i[i.length-2]][i[i.length-1]],i.push(_);break;case 3:return!0}}return!0}},t=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parseError)throw new Error(e);this.yy.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.match+=e,this.matched+=e,e.match(/\n/)&&this.yylineno++,this._input=this._input.slice(1),e},unput:function(e){return this._input=e+this._input,this},more:function(){return this._more=!0,this},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t;this._more||(this.yytext="",this.match="");for(var n=this._currentRules(),i=0;i<n.length;i++)if(e=this._input.match(this.rules[n[i]]))return t=e[0].match(/\n.*/g),t&&(this.yylineno+=t.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:t?t[t.length-1].length-1:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],this.performAction.call(this,this.yy,this,n[i],this.conditionStack[this.conditionStack.length-1])||void 0;if(""===this._input)return this.EOF;this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return void 0!==e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)}};return e.performAction=function(e,t,n,i){switch(n){case 0:break;case 1:return 20;case 2:return 19;case 3:return 8;case 4:return 9;case 5:return 6;case 6:return 7;case 7:return 11;case 8:return 13;case 9:return 10;case 10:return 12;case 11:return 14;case 12:return 15;case 13:return 16;case 14:return 17;case 15:return 18;case 16:return 5;case 17:return"INVALID"}},e.rules=[/^\s+/,/^[0-9]+(\.[0-9]+)?\b/,/^n\b/,/^\|\|/,/^&&/,/^\?/,/^:/,/^<=/,/^>=/,/^</,/^>/,/^!=/,/^==/,/^%/,/^\(/,/^\)/,/^$/,/^./],e.conditions={INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],inclusive:!0}},e}();return e.lexer=t,e}(),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=d),exports.Jed=d):("function"==typeof define&&define.amd&&define("jed",[],function(){return d}),e.Jed=d)}(this),define("i18n",["require","exports","module","underscore","jed"],function(e,t,n){"use strict";var i=e("underscore"),r=e("jed"),s=function(e){var t=e.locale_data.messages;return i.each(i.keys(t),function(e){i.isArray(t[e])&&null===t[e][0]&&t[e].shift()}),e},o=function(e){var t;return t=new r(e?s(e):{}),i.extend(a,t),t},a={init:function(e){o(e)}};n.exports=a}),define("appPubSubTopics",["require","exports","module"],function(e,t,n){"use strict";var i={};i.SHOW_MODAL="modal.show",i.HIDE_MODAL="modal.hide",i.PROGRESS_REGISTER="progress.register",i.PROGRESS_UNREGISTER="progress.unregister",i.PROGRESS_UPDATE="progress.update",i.PROGRESS_SHOW="progress.show",i.PROGRESS_HIDE="progress.hide",i.USER_ATTRIBUTES_CHANGED="user.attributes.changed",i.USER_UPDATE_REQUESTED="user.update.requested",i.USER_LOGIN="user.login",i.USER_REGISTER="user.register",i.USER_UNAUTHORIZED="user.unauthorized",i.AUTH_SUCCESS="auth.success",i.AUTH_ERROR="auth.error",i.LOGIN_SUCCESS="login.success",i.LOGIN_ERROR="login.error",i.LOCATION_UNAUTHORIZED="location.unauthorized",i.LOCATION_AUTHORIZED="location.authorized",i.LOCATION_AUTHORIZATION_FAILED="location.authorization.failed",i.LOCATION_ERROR="location.error",i.VERIFY_EMAIL="verify.email",i.REQUEST_VERIFICATION_EMAIL="request.verification.email",i.ORDER_SELECT_PAYMENT_METHOD="order.paymentMethod.select",i.ORDER_ERROR="order.error",i.ORDER_PLACE_ERROR="order.place.error",i.ORDER_PLACE_SUCCESS="order.place.success",i.ORDER_PLACE_PROCESSING="order.place.processing",i.COUNTRY_CHANGED="country.changed",n.exports=i}),function(e,t){"use strict";"object"==typeof exports&&module?module.exports=t():"function"==typeof define&&define.amd?define("pubsub",t):e.PubSub=t()}("object"==typeof window&&window||this,function(){"use strict";function e(e){var t;for(t in e)if(e.hasOwnProperty(t))return!0;return!1}function t(e){return function(){throw e}}function n(e,n,i){try{e(n,i)}catch(e){setTimeout(t(e),0)}}function i(e,t,n){e(t,n)}function r(e,t,r,s){var o,a=c[t],l=s?i:n;if(c.hasOwnProperty(t))for(o in a)a.hasOwnProperty(o)&&l(a[o],e,r)}function s(e,t,n){return function(){var i=String(e),s=i.lastIndexOf(".");for(r(e,e,t,n);-1!==s;)i=i.substr(0,s),s=i.lastIndexOf("."),r(e,i,t)}}function o(t){for(var n=String(t),i=Boolean(c.hasOwnProperty(n)&&e(c[n])),r=n.lastIndexOf(".");!i&&-1!==r;)n=n.substr(0,r),r=n.lastIndexOf("."),i=Boolean(c.hasOwnProperty(n)&&e(c[n]));return i}function a(e,t,n,i){var r=s(e,t,i);return!!o(e)&&(!0===n?r():setTimeout(r,0),!0)}var l={},c={},u=-1;return l.publish=function(e,t){return a(e,t,!1,l.immediateExceptions)},l.publishSync=function(e,t){return a(e,t,!0,l.immediateExceptions)},l.subscribe=function(e,t){if("function"!=typeof t)return!1;c.hasOwnProperty(e)||(c[e]={});var n="uid_"+String(++u);return c[e][n]=t,n},l.unsubscribe=function(e){var t,n,i,r="string"==typeof e,s=!1;for(t in c)if(c.hasOwnProperty(t)){if(n=c[t],r&&n[e]){delete n[e],s=e;break}if(!r)for(i in n)n.hasOwnProperty(i)&&n[i]===e&&(delete n[i],s=!0)}return s},l}),define("core/controller",["require","exports","module","underscore","pubsub"],function(e,t,n){"use strict";var i=e("underscore"),r=e("pubsub"),s=function(){this.initialize.apply(this,arguments)};s.extend=function(e,t){var n,r=this;n=e&&i.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},i.extend(n,r,t);var s=function(){this.constructor=n};return s.prototype=r.prototype,n.prototype=new s,e&&i.extend(n.prototype,e),n.__super__=r.prototype,n},n.exports=s.extend({pubSub:r})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("moment",t):e.moment=t()}(this,function(){"use strict";function e(){return An.apply(null,arguments)}function t(e){return"[object Array]"===Object.prototype.toString.call(e)}function n(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function i(e,t){var n,i=[];for(n=0;n<e.length;++n)i.push(t(e[n],n));return i}function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function s(e,t){for(var n in t)r(t,n)&&(e[n]=t[n]);return r(t,"toString")&&(e.toString=t.toString),r(t,"valueOf")&&(e.valueOf=t.valueOf),e}function o(e,t,n,i){return Me(e,t,n,i,!0).utc()}function a(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function l(e){return null==e._pf&&(e._pf=a()),e._pf}function c(e){if(null==e._isValid){var t=l(e);e._isValid=!(isNaN(e._d.getTime())||!(t.overflow<0)||t.empty||t.invalidMonth||t.invalidWeekday||t.nullInput||t.invalidFormat||t.userInvalidated),e._strict&&(e._isValid=e._isValid&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)}return e._isValid}function u(e){var t=o(NaN);return null!=e?s(l(t),e):l(t).userInvalidated=!0,t}function d(e,t){var n,i,r;if(void 0!==t._isAMomentObject&&(e._isAMomentObject=t._isAMomentObject),void 0!==t._i&&(e._i=t._i),void 0!==t._f&&(e._f=t._f),void 0!==t._l&&(e._l=t._l),void 0!==t._strict&&(e._strict=t._strict),void 0!==t._tzm&&(e._tzm=t._tzm),void 0!==t._isUTC&&(e._isUTC=t._isUTC),void 0!==t._offset&&(e._offset=t._offset),void 0!==t._pf&&(e._pf=l(t)),void 0!==t._locale&&(e._locale=t._locale),Nn.length>0)for(n in Nn)i=Nn[n],void 0!==(r=t[i])&&(e[i]=r);return e}function h(t){d(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),!1===In&&(In=!0,e.updateOffset(this),In=!1)}function p(e){return e instanceof h||null!=e&&null!=e._isAMomentObject}function f(e){return e<0?Math.ceil(e):Math.floor(e)}function m(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=f(t)),n}function g(e,t,n){var i,r=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),o=0;for(i=0;i<r;i++)(n&&e[i]!==t[i]||!n&&m(e[i])!==m(t[i]))&&o++;return o+s}function v(){}function y(e){return e?e.toLowerCase().replace("_","-"):e}function b(e){for(var t,n,i,r,s=0;s<e.length;){for(r=y(e[s]).split("-"),t=r.length,n=y(e[s+1]),n=n?n.split("-"):null;t>0;){if(i=_(r.slice(0,t).join("-")))return i;if(n&&n.length>=t&&g(r,n,!0)>=t-1)break;t--}s++}return null}function _(e){var t=null;if(!Un[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=Fn._abbr,require("./locale/"+e),w(t)}catch(e){}return Un[e]}function w(e,t){var n;return e&&(n=void 0===t?k(e):x(e,t))&&(Fn=n),Fn._abbr}function x(e,t){return null!==t?(t.abbr=e,Un[e]=Un[e]||new v,Un[e].set(t),w(e),Un[e]):(delete Un[e],null)}function k(e){var n;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Fn;if(!t(e)){if(n=_(e))return n;e=[e]}return b(e)}function E(e,t){var n=e.toLowerCase();Rn[n]=Rn[n+"s"]=Rn[t]=e}function S(e){return"string"==typeof e?Rn[e]||Rn[e.toLowerCase()]:void 0}function C(e){var t,n,i={};for(n in e)r(e,n)&&(t=S(n))&&(i[t]=e[n]);return i}function M(t,n){return function(i){return null!=i?(P(this,t,i),e.updateOffset(this,n),this):O(this,t)}}function O(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function P(e,t,n){return e._d["set"+(e._isUTC?"UTC":"")+t](n)}function D(e,t){var n;if("object"==typeof e)for(n in e)this.set(n,e[n]);else if(e=S(e),"function"==typeof this[e])return this[e](t);return this}function V(e,t,n){var i=""+Math.abs(e),r=t-i.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}function T(e,t,n,i){var r=i;"string"==typeof i&&(r=function(){return this[i]()}),e&&(Bn[e]=r),t&&(Bn[t[0]]=function(){return V(r.apply(this,arguments),t[1],t[2])}),n&&(Bn[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)})}function A(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function F(e){var t,n,i=e.match(Ln);for(t=0,n=i.length;t<n;t++)Bn[i[t]]?i[t]=Bn[i[t]]:i[t]=A(i[t]);return function(r){var s="";for(t=0;t<n;t++)s+=i[t]instanceof Function?i[t].call(r,e):i[t];return s}}function N(e,t){return e.isValid()?(t=I(t,e.localeData()),qn[t]=qn[t]||F(t),qn[t](e)):e.localeData().invalidDate()}function I(e,t){function n(e){return t.longDateFormat(e)||e}var i=5;for($n.lastIndex=0;i>=0&&$n.test(e);)e=e.replace($n,n),$n.lastIndex=0,i-=1;return e}function U(e){return"function"==typeof e&&"[object Function]"===Object.prototype.toString.call(e)}function R(e,t,n){ii[e]=U(t)?t:function(e){return e&&n?n:t}}function L(e,t){return r(ii,e)?ii[e](t._strict,t._locale):new RegExp($(e))}function $(e){return e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,i,r){return t||n||i||r}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function q(e,t){var n,i=t;for("string"==typeof e&&(e=[e]),"number"==typeof t&&(i=function(e,n){n[t]=m(e)}),n=0;n<e.length;n++)ri[e[n]]=i}function B(e,t){q(e,function(e,n,i,r){i._w=i._w||{},t(e,i._w,i,r)})}function H(e,t,n){null!=t&&r(ri,e)&&ri[e](t,n._a,n,e)}function z(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function j(e){return this._months[e.month()]}function Y(e){return this._monthsShort[e.month()]}function G(e,t,n){var i,r,s;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=o([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(s="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(s.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[i].test(e))return i;if(n&&"MMM"===t&&this._shortMonthsParse[i].test(e))return i;if(!n&&this._monthsParse[i].test(e))return i}}function W(e,t){var n;return"string"==typeof t&&"number"!=typeof(t=e.localeData().monthsParse(t))?e:(n=Math.min(e.date(),z(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e)}function Q(t){return null!=t?(W(this,t),e.updateOffset(this,!0),this):O(this,"Month")}function J(){return z(this.year(),this.month())}function Z(e){var t,n=e._a;return n&&-2===l(e).overflow&&(t=n[oi]<0||n[oi]>11?oi:n[ai]<1||n[ai]>z(n[si],n[oi])?ai:n[li]<0||n[li]>24||24===n[li]&&(0!==n[ci]||0!==n[ui]||0!==n[di])?li:n[ci]<0||n[ci]>59?ci:n[ui]<0||n[ui]>59?ui:n[di]<0||n[di]>999?di:-1,l(e)._overflowDayOfYear&&(t<si||t>ai)&&(t=ai),l(e).overflow=t),e}function K(t){!1===e.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function X(e,t){var n=!0;return s(function(){return n&&(K(e+"\n"+(new Error).stack),n=!1),t.apply(this,arguments)},t)}function ee(e,t){fi[e]||(K(t),fi[e]=!0)}function te(e){var t,n,i=e._i,r=mi.exec(i);if(r){for(l(e).iso=!0,t=0,n=gi.length;t<n;t++)if(gi[t][1].exec(i)){e._f=gi[t][0];break}for(t=0,n=vi.length;t<n;t++)if(vi[t][1].exec(i)){e._f+=(r[6]||" ")+vi[t][0];break}i.match(ei)&&(e._f+="Z"),_e(e)}else e._isValid=!1}function ne(t){var n=yi.exec(t._i);if(null!==n)return void(t._d=new Date(+n[1]));te(t),!1===t._isValid&&(delete t._isValid,e.createFromInputFallback(t))}function ie(e,t,n,i,r,s,o){var a=new Date(e,t,n,i,r,s,o);return e<1970&&a.setFullYear(e),a}function re(e){var t=new Date(Date.UTC.apply(null,arguments));return e<1970&&t.setUTCFullYear(e),t}function se(e){return oe(e)?366:365}function oe(e){return e%4==0&&e%100!=0||e%400==0}function ae(){return oe(this.year())}function le(e,t,n){var i,r=n-t,s=n-e.day();return s>r&&(s-=7),s<r-7&&(s+=7),i=Oe(e).add(s,"d"),{week:Math.ceil(i.dayOfYear()/7),year:i.year()}}function ce(e){return le(e,this._week.dow,this._week.doy).week}function ue(){return this._week.dow}function de(){return this._week.doy}function he(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function pe(e){var t=le(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function fe(e,t,n,i,r){var s,o=6+r-i,a=re(e,0,1+o),l=a.getUTCDay();return l<r&&(l+=7),n=null!=n?1*n:r,s=1+o+7*(t-1)-l+n,{year:s>0?e:e-1,dayOfYear:s>0?s:se(e-1)+s}}function me(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function ge(e,t,n){return null!=e?e:null!=t?t:n}function ve(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function ye(e){var t,n,i,r,s=[];if(!e._d){for(i=ve(e),e._w&&null==e._a[ai]&&null==e._a[oi]&&be(e),e._dayOfYear&&(r=ge(e._a[si],i[si]),e._dayOfYear>se(r)&&(l(e)._overflowDayOfYear=!0),n=re(r,0,e._dayOfYear),e._a[oi]=n.getUTCMonth(),e._a[ai]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=s[t]=i[t];for(;t<7;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[li]&&0===e._a[ci]&&0===e._a[ui]&&0===e._a[di]&&(e._nextDay=!0,e._a[li]=0),e._d=(e._useUTC?re:ie).apply(null,s),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[li]=24)}}function be(e){var t,n,i,r,s,o,a;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(s=1,o=4,n=ge(t.GG,e._a[si],le(Oe(),1,4).year),i=ge(t.W,1),r=ge(t.E,1)):(s=e._locale._week.dow,o=e._locale._week.doy,n=ge(t.gg,e._a[si],le(Oe(),s,o).year),i=ge(t.w,1),null!=t.d?(r=t.d)<s&&++i:r=null!=t.e?t.e+s:s),a=fe(n,i,r,o,s),e._a[si]=a.year,e._dayOfYear=a.dayOfYear}function _e(t){if(t._f===e.ISO_8601)return void te(t);t._a=[],l(t).empty=!0;var n,i,r,s,o,a=""+t._i,c=a.length,u=0;for(r=I(t._f,t._locale).match(Ln)||[],n=0;n<r.length;n++)s=r[n],i=(a.match(L(s,t))||[])[0],i&&(o=a.substr(0,a.indexOf(i)),o.length>0&&l(t).unusedInput.push(o),a=a.slice(a.indexOf(i)+i.length),u+=i.length),Bn[s]?(i?l(t).empty=!1:l(t).unusedTokens.push(s),H(s,i,t)):t._strict&&!i&&l(t).unusedTokens.push(s);l(t).charsLeftOver=c-u,a.length>0&&l(t).unusedInput.push(a),!0===l(t).bigHour&&t._a[li]<=12&&t._a[li]>0&&(l(t).bigHour=void 0),t._a[li]=we(t._locale,t._a[li],t._meridiem),ye(t),Z(t)}function we(e,t,n){var i;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(i=e.isPM(n),i&&t<12&&(t+=12),i||12!==t||(t=0),t):t}function xe(e){var t,n,i,r,o;if(0===e._f.length)return l(e).invalidFormat=!0,void(e._d=new Date(NaN));for(r=0;r<e._f.length;r++)o=0,t=d({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[r],_e(t),c(t)&&(o+=l(t).charsLeftOver,o+=10*l(t).unusedTokens.length,l(t).score=o,(null==i||o<i)&&(i=o,n=t));s(e,n||t)}function ke(e){if(!e._d){var t=C(e._i);e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],ye(e)}}function Ee(e){var t=new h(Z(Se(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Se(e){var i=e._i,r=e._f;return e._locale=e._locale||k(e._l),null===i||void 0===r&&""===i?u({nullInput:!0}):("string"==typeof i&&(e._i=i=e._locale.preparse(i)),p(i)?new h(Z(i)):(t(r)?xe(e):r?_e(e):n(i)?e._d=i:Ce(e),e))}function Ce(r){var s=r._i;void 0===s?r._d=new Date:n(s)?r._d=new Date(+s):"string"==typeof s?ne(r):t(s)?(r._a=i(s.slice(0),function(e){return parseInt(e,10)}),ye(r)):"object"==typeof s?ke(r):"number"==typeof s?r._d=new Date(s):e.createFromInputFallback(r)}function Me(e,t,n,i,r){var s={};return"boolean"==typeof n&&(i=n,n=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=r,s._l=n,s._i=e,s._f=t,s._strict=i,Ee(s)}function Oe(e,t,n,i){return Me(e,t,n,i,!1)}function Pe(e,n){var i,r;if(1===n.length&&t(n[0])&&(n=n[0]),!n.length)return Oe();for(i=n[0],r=1;r<n.length;++r)n[r].isValid()&&!n[r][e](i)||(i=n[r]);return i}function De(){return Pe("isBefore",[].slice.call(arguments,0))}function Ve(){return Pe("isAfter",[].slice.call(arguments,0))}function Te(e){var t=C(e),n=t.year||0,i=t.quarter||0,r=t.month||0,s=t.week||0,o=t.day||0,a=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._milliseconds=+u+1e3*c+6e4*l+36e5*a,this._days=+o+7*s,this._months=+r+3*i+12*n,this._data={},this._locale=k(),this._bubble()}function Ae(e){return e instanceof Te}function Fe(e,t){T(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+V(~~(e/60),2)+t+V(~~e%60,2)})}function Ne(e){var t=(e||"").match(ei)||[],n=t[t.length-1]||[],i=(n+"").match(ki)||["-",0,0],r=60*i[1]+m(i[2]);return"+"===i[0]?r:-r}function Ie(t,i){var r,s;return i._isUTC?(r=i.clone(),s=(p(t)||n(t)?+t:+Oe(t))-+r,r._d.setTime(+r._d+s),e.updateOffset(r,!1),r):Oe(t).local()}function Ue(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Re(t,n){var i,r=this._offset||0;return null!=t?("string"==typeof t&&(t=Ne(t)),Math.abs(t)<16&&(t*=60),!this._isUTC&&n&&(i=Ue(this)),this._offset=t,this._isUTC=!0,null!=i&&this.add(i,"m"),r!==t&&(!n||this._changeInProgress?et(this,Qe(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?r:Ue(this)}function Le(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function $e(e){return this.utcOffset(0,e)}function qe(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ue(this),"m")),this}function Be(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Ne(this._i)),this}function He(e){return e=e?Oe(e).utcOffset():0,(this.utcOffset()-e)%60==0}function ze(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function je(){if(void 0!==this._isDSTShifted)return this._isDSTShifted;var e={};if(d(e,this),e=Se(e),e._a){var t=e._isUTC?o(e._a):Oe(e._a);this._isDSTShifted=this.isValid()&&g(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Ye(){return!this._isUTC}function Ge(){return this._isUTC}function We(){return this._isUTC&&0===this._offset}function Qe(e,t){var n,i,s,o=e,a=null;return Ae(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(o={},t?o[t]=e:o.milliseconds=e):(a=Ei.exec(e))?(n="-"===a[1]?-1:1,o={y:0,d:m(a[ai])*n,h:m(a[li])*n,m:m(a[ci])*n,s:m(a[ui])*n,ms:m(a[di])*n}):(a=Si.exec(e))?(n="-"===a[1]?-1:1,o={y:Je(a[2],n),M:Je(a[3],n),d:Je(a[4],n),h:Je(a[5],n),m:Je(a[6],n),s:Je(a[7],n),w:Je(a[8],n)}):null==o?o={}:"object"==typeof o&&("from"in o||"to"in o)&&(s=Ke(Oe(o.from),Oe(o.to)),o={},o.ms=s.milliseconds,o.M=s.months),i=new Te(o),Ae(e)&&r(e,"_locale")&&(i._locale=e._locale),i}function Je(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Ze(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Ke(e,t){var n;return t=Ie(t,e),e.isBefore(t)?n=Ze(e,t):(n=Ze(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function Xe(e,t){return function(n,i){var r,s;return null===i||isNaN(+i)||(ee(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),s=n,n=i,i=s),n="string"==typeof n?+n:n,r=Qe(n,i),et(this,r,e),this}}function et(t,n,i,r){var s=n._milliseconds,o=n._days,a=n._months;r=null==r||r,s&&t._d.setTime(+t._d+s*i),o&&P(t,"Date",O(t,"Date")+o*i),a&&W(t,O(t,"Month")+a*i),r&&e.updateOffset(t,o||a)}function tt(e,t){var n=e||Oe(),i=Ie(n,this).startOf("day"),r=this.diff(i,"days",!0),s=r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse";return this.format(t&&t[s]||this.localeData().calendar(s,this,Oe(n)))}function nt(){return new h(this)}function it(e,t){return t=S(void 0!==t?t:"millisecond"),"millisecond"===t?(e=p(e)?e:Oe(e),+this>+e):(p(e)?+e:+Oe(e))<+this.clone().startOf(t)}function rt(e,t){var n;return t=S(void 0!==t?t:"millisecond"),"millisecond"===t?(e=p(e)?e:Oe(e),+this<+e):(n=p(e)?+e:+Oe(e),+this.clone().endOf(t)<n)}function st(e,t,n){return this.isAfter(e,n)&&this.isBefore(t,n)}function ot(e,t){var n;return t=S(t||"millisecond"),"millisecond"===t?(e=p(e)?e:Oe(e),+this==+e):(n=+Oe(e),+this.clone().startOf(t)<=n&&n<=+this.clone().endOf(t))}function at(e,t,n){var i,r,s=Ie(e,this),o=6e4*(s.utcOffset()-this.utcOffset());return t=S(t),"year"===t||"month"===t||"quarter"===t?(r=lt(this,s),"quarter"===t?r/=3:"year"===t&&(r/=12)):(i=this-s,r="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?(i-o)/864e5:"week"===t?(i-o)/6048e5:i),n?r:f(r)}function lt(e,t){var n,i,r=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(r,"months");return t-s<0?(n=e.clone().add(r-1,"months"),i=(t-s)/(s-n)):(n=e.clone().add(r+1,"months"),i=(t-s)/(n-s)),-(r+i)}function ct(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ut(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():N(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):N(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function dt(t){var n=N(this,t||e.defaultFormat);return this.localeData().postformat(n)}function ht(e,t){return this.isValid()?Qe({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function pt(e){return this.from(Oe(),e)}function ft(e,t){return this.isValid()?Qe({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function mt(e){return this.to(Oe(),e)}function gt(e){var t;return void 0===e?this._locale._abbr:(t=k(e),null!=t&&(this._locale=t),this)}function vt(){return this._locale}function yt(e){switch(e=S(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function bt(e){return e=S(e),void 0===e||"millisecond"===e?this:this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")}function _t(){return+this._d-6e4*(this._offset||0)}function wt(){return Math.floor(+this/1e3)}function xt(){return this._offset?new Date(+this):this._d}function kt(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Et(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function St(){return c(this)}function Ct(){return s({},l(this))}function Mt(){return l(this).overflow}function Ot(e,t){T(0,[e,e.length],0,t)}function Pt(e,t,n){return le(Oe([e,11,31+t-n]),t,n).week}function Dt(e){var t=le(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==e?t:this.add(e-t,"y")}function Vt(e){var t=le(this,1,4).year;return null==e?t:this.add(e-t,"y")}function Tt(){return Pt(this.year(),1,4)}function At(){var e=this.localeData()._week;return Pt(this.year(),e.dow,e.doy)}function Ft(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Nt(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function It(e){return this._weekdays[e.day()]}function Ut(e){return this._weekdaysShort[e.day()]}function Rt(e){return this._weekdaysMin[e.day()]}function Lt(e){var t,n,i;for(this._weekdaysParse=this._weekdaysParse||[],t=0;t<7;t++)if(this._weekdaysParse[t]||(n=Oe([2e3,1]).day(t),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(i.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t}function $t(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Nt(e,this.localeData()),this.add(e-t,"d")):t}function qt(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Bt(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)}function Ht(e,t){T(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function zt(e,t){return t._meridiemParse}function jt(e){return"p"===(e+"").toLowerCase().charAt(0)}function Yt(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function Gt(e,t){t[di]=m(1e3*("0."+e))}function Wt(){return this._isUTC?"UTC":""}function Qt(){return this._isUTC?"Coordinated Universal Time":""}function Jt(e){return Oe(1e3*e)}function Zt(){return Oe.apply(null,arguments).parseZone()}function Kt(e,t,n){var i=this._calendar[e];return"function"==typeof i?i.call(t,n):i}function Xt(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function en(){return this._invalidDate}function tn(e){return this._ordinal.replace("%d",e)}function nn(e){return e}function rn(e,t,n,i){var r=this._relativeTime[n];return"function"==typeof r?r(e,t,n,i):r.replace(/%d/i,e)}function sn(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)}function on(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function an(e,t,n,i){var r=k(),s=o().set(i,t);return r[n](s,e)}function ln(e,t,n,i,r){if("number"==typeof e&&(t=e,e=void 0),e=e||"",null!=t)return an(e,t,n,r);var s,o=[];for(s=0;s<i;s++)o[s]=an(e,s,n,r);return o}function cn(e,t){return ln(e,t,"months",12,"month")}function un(e,t){return ln(e,t,"monthsShort",12,"month")}function dn(e,t){return ln(e,t,"weekdays",7,"day")}function hn(e,t){return ln(e,t,"weekdaysShort",7,"day")}function pn(e,t){return ln(e,t,"weekdaysMin",7,"day")}function fn(){var e=this._data;return this._milliseconds=Yi(this._milliseconds),this._days=Yi(this._days),this._months=Yi(this._months),e.milliseconds=Yi(e.milliseconds),e.seconds=Yi(e.seconds),e.minutes=Yi(e.minutes),e.hours=Yi(e.hours),e.months=Yi(e.months),e.years=Yi(e.years),this}function mn(e,t,n,i){var r=Qe(t,n);return e._milliseconds+=i*r._milliseconds,e._days+=i*r._days,e._months+=i*r._months,e._bubble()}function gn(e,t){
return mn(this,e,t,1)}function vn(e,t){return mn(this,e,t,-1)}function yn(e){return e<0?Math.floor(e):Math.ceil(e)}function bn(){var e,t,n,i,r,s=this._milliseconds,o=this._days,a=this._months,l=this._data;return s>=0&&o>=0&&a>=0||s<=0&&o<=0&&a<=0||(s+=864e5*yn(wn(a)+o),o=0,a=0),l.milliseconds=s%1e3,e=f(s/1e3),l.seconds=e%60,t=f(e/60),l.minutes=t%60,n=f(t/60),l.hours=n%24,o+=f(n/24),r=f(_n(o)),a+=r,o-=yn(wn(r)),i=f(a/12),a%=12,l.days=o,l.months=a,l.years=i,this}function _n(e){return 4800*e/146097}function wn(e){return 146097*e/4800}function xn(e){var t,n,i=this._milliseconds;if("month"===(e=S(e))||"year"===e)return t=this._days+i/864e5,n=this._months+_n(t),"month"===e?n:n/12;switch(t=this._days+Math.round(wn(this._months)),e){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return 24*t+i/36e5;case"minute":return 1440*t+i/6e4;case"second":return 86400*t+i/1e3;case"millisecond":return Math.floor(864e5*t)+i;default:throw new Error("Unknown unit "+e)}}function kn(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*m(this._months/12)}function En(e){return function(){return this.as(e)}}function Sn(e){return e=S(e),this[e+"s"]()}function Cn(e){return function(){return this._data[e]}}function Mn(){return f(this.days()/7)}function On(e,t,n,i,r){return r.relativeTime(t||1,!!n,e,i)}function Pn(e,t,n){var i=Qe(e).abs(),r=lr(i.as("s")),s=lr(i.as("m")),o=lr(i.as("h")),a=lr(i.as("d")),l=lr(i.as("M")),c=lr(i.as("y")),u=r<cr.s&&["s",r]||1===s&&["m"]||s<cr.m&&["mm",s]||1===o&&["h"]||o<cr.h&&["hh",o]||1===a&&["d"]||a<cr.d&&["dd",a]||1===l&&["M"]||l<cr.M&&["MM",l]||1===c&&["y"]||["yy",c];return u[2]=t,u[3]=+e>0,u[4]=n,On.apply(null,u)}function Dn(e,t){return void 0!==cr[e]&&(void 0===t?cr[e]:(cr[e]=t,!0))}function Vn(e){var t=this.localeData(),n=Pn(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function Tn(){var e,t,n,i=ur(this._milliseconds)/1e3,r=ur(this._days),s=ur(this._months);e=f(i/60),t=f(e/60),i%=60,e%=60,n=f(s/12),s%=12;var o=n,a=s,l=r,c=t,u=e,d=i,h=this.asSeconds();return h?(h<0?"-":"")+"P"+(o?o+"Y":"")+(a?a+"M":"")+(l?l+"D":"")+(c||u||d?"T":"")+(c?c+"H":"")+(u?u+"M":"")+(d?d+"S":""):"P0D"}var An,Fn,Nn=e.momentProperties=[],In=!1,Un={},Rn={},Ln=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,$n=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,qn={},Bn={},Hn=/\d/,zn=/\d\d/,jn=/\d{3}/,Yn=/\d{4}/,Gn=/[+-]?\d{6}/,Wn=/\d\d?/,Qn=/\d{1,3}/,Jn=/\d{1,4}/,Zn=/[+-]?\d{1,6}/,Kn=/\d+/,Xn=/[+-]?\d+/,ei=/Z|[+-]\d\d:?\d\d/gi,ti=/[+-]?\d+(\.\d{1,3})?/,ni=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,ii={},ri={},si=0,oi=1,ai=2,li=3,ci=4,ui=5,di=6;T("M",["MM",2],"Mo",function(){return this.month()+1}),T("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),T("MMMM",0,0,function(e){return this.localeData().months(this,e)}),E("month","M"),R("M",Wn),R("MM",Wn,zn),R("MMM",ni),R("MMMM",ni),q(["M","MM"],function(e,t){t[oi]=m(e)-1}),q(["MMM","MMMM"],function(e,t,n,i){var r=n._locale.monthsParse(e,i,n._strict);null!=r?t[oi]=r:l(n).invalidMonth=e});var hi="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),pi="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),fi={};e.suppressDeprecationWarnings=!1;var mi=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gi=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],vi=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],yi=/^\/?Date\((\-?\d+)/i;e.createFromInputFallback=X("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),T(0,["YY",2],0,function(){return this.year()%100}),T(0,["YYYY",4],0,"year"),T(0,["YYYYY",5],0,"year"),T(0,["YYYYYY",6,!0],0,"year"),E("year","y"),R("Y",Xn),R("YY",Wn,zn),R("YYYY",Jn,Yn),R("YYYYY",Zn,Gn),R("YYYYYY",Zn,Gn),q(["YYYYY","YYYYYY"],si),q("YYYY",function(t,n){n[si]=2===t.length?e.parseTwoDigitYear(t):m(t)}),q("YY",function(t,n){n[si]=e.parseTwoDigitYear(t)}),e.parseTwoDigitYear=function(e){return m(e)+(m(e)>68?1900:2e3)};var bi=M("FullYear",!1);T("w",["ww",2],"wo","week"),T("W",["WW",2],"Wo","isoWeek"),E("week","w"),E("isoWeek","W"),R("w",Wn),R("ww",Wn,zn),R("W",Wn),R("WW",Wn,zn),B(["w","ww","W","WW"],function(e,t,n,i){t[i.substr(0,1)]=m(e)});var _i={dow:0,doy:6};T("DDD",["DDDD",3],"DDDo","dayOfYear"),E("dayOfYear","DDD"),R("DDD",Qn),R("DDDD",jn),q(["DDD","DDDD"],function(e,t,n){n._dayOfYear=m(e)}),e.ISO_8601=function(){};var wi=X("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var e=Oe.apply(null,arguments);return e<this?this:e}),xi=X("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var e=Oe.apply(null,arguments);return e>this?this:e});Fe("Z",":"),Fe("ZZ",""),R("Z",ei),R("ZZ",ei),q(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Ne(e)});var ki=/([\+\-]|\d\d)/gi;e.updateOffset=function(){};var Ei=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Si=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;Qe.fn=Te.prototype;var Ci=Xe(1,"add"),Mi=Xe(-1,"subtract");e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var Oi=X("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});T(0,["gg",2],0,function(){return this.weekYear()%100}),T(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Ot("gggg","weekYear"),Ot("ggggg","weekYear"),Ot("GGGG","isoWeekYear"),Ot("GGGGG","isoWeekYear"),E("weekYear","gg"),E("isoWeekYear","GG"),R("G",Xn),R("g",Xn),R("GG",Wn,zn),R("gg",Wn,zn),R("GGGG",Jn,Yn),R("gggg",Jn,Yn),R("GGGGG",Zn,Gn),R("ggggg",Zn,Gn),B(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,i){t[i.substr(0,2)]=m(e)}),B(["gg","GG"],function(t,n,i,r){n[r]=e.parseTwoDigitYear(t)}),T("Q",0,0,"quarter"),E("quarter","Q"),R("Q",Hn),q("Q",function(e,t){t[oi]=3*(m(e)-1)}),T("D",["DD",2],"Do","date"),E("date","D"),R("D",Wn),R("DD",Wn,zn),R("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),q(["D","DD"],ai),q("Do",function(e,t){t[ai]=m(e.match(Wn)[0],10)});var Pi=M("Date",!0);T("d",0,"do","day"),T("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),T("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),T("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),T("e",0,0,"weekday"),T("E",0,0,"isoWeekday"),E("day","d"),E("weekday","e"),E("isoWeekday","E"),R("d",Wn),R("e",Wn),R("E",Wn),R("dd",ni),R("ddd",ni),R("dddd",ni),B(["dd","ddd","dddd"],function(e,t,n){var i=n._locale.weekdaysParse(e);null!=i?t.d=i:l(n).invalidWeekday=e}),B(["d","e","E"],function(e,t,n,i){t[i]=m(e)});var Di="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Vi="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ti="Su_Mo_Tu_We_Th_Fr_Sa".split("_");T("H",["HH",2],0,"hour"),T("h",["hh",2],0,function(){return this.hours()%12||12}),Ht("a",!0),Ht("A",!1),E("hour","h"),R("a",zt),R("A",zt),R("H",Wn),R("h",Wn),R("HH",Wn,zn),R("hh",Wn,zn),q(["H","HH"],li),q(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),q(["h","hh"],function(e,t,n){t[li]=m(e),l(n).bigHour=!0});var Ai=/[ap]\.?m?\.?/i,Fi=M("Hours",!0);T("m",["mm",2],0,"minute"),E("minute","m"),R("m",Wn),R("mm",Wn,zn),q(["m","mm"],ci);var Ni=M("Minutes",!1);T("s",["ss",2],0,"second"),E("second","s"),R("s",Wn),R("ss",Wn,zn),q(["s","ss"],ui);var Ii=M("Seconds",!1);T("S",0,0,function(){return~~(this.millisecond()/100)}),T(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),T(0,["SSS",3],0,"millisecond"),T(0,["SSSS",4],0,function(){return 10*this.millisecond()}),T(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),T(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),T(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),T(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),T(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),E("millisecond","ms"),R("S",Qn,Hn),R("SS",Qn,zn),R("SSS",Qn,jn);var Ui;for(Ui="SSSS";Ui.length<=9;Ui+="S")R(Ui,Kn);for(Ui="S";Ui.length<=9;Ui+="S")q(Ui,Gt);var Ri=M("Milliseconds",!1);T("z",0,0,"zoneAbbr"),T("zz",0,0,"zoneName");var Li=h.prototype;Li.add=Ci,Li.calendar=tt,Li.clone=nt,Li.diff=at,Li.endOf=bt,Li.format=dt,Li.from=ht,Li.fromNow=pt,Li.to=ft,Li.toNow=mt,Li.get=D,Li.invalidAt=Mt,Li.isAfter=it,Li.isBefore=rt,Li.isBetween=st,Li.isSame=ot,Li.isValid=St,Li.lang=Oi,Li.locale=gt,Li.localeData=vt,Li.max=xi,Li.min=wi,Li.parsingFlags=Ct,Li.set=D,Li.startOf=yt,Li.subtract=Mi,Li.toArray=kt,Li.toObject=Et,Li.toDate=xt,Li.toISOString=ut,Li.toJSON=ut,Li.toString=ct,Li.unix=wt,Li.valueOf=_t,Li.year=bi,Li.isLeapYear=ae,Li.weekYear=Dt,Li.isoWeekYear=Vt,Li.quarter=Li.quarters=Ft,Li.month=Q,Li.daysInMonth=J,Li.week=Li.weeks=he,Li.isoWeek=Li.isoWeeks=pe,Li.weeksInYear=At,Li.isoWeeksInYear=Tt,Li.date=Pi,Li.day=Li.days=$t,Li.weekday=qt,Li.isoWeekday=Bt,Li.dayOfYear=me,Li.hour=Li.hours=Fi,Li.minute=Li.minutes=Ni,Li.second=Li.seconds=Ii,Li.millisecond=Li.milliseconds=Ri,Li.utcOffset=Re,Li.utc=$e,Li.local=qe,Li.parseZone=Be,Li.hasAlignedHourOffset=He,Li.isDST=ze,Li.isDSTShifted=je,Li.isLocal=Ye,Li.isUtcOffset=Ge,Li.isUtc=We,Li.isUTC=We,Li.zoneAbbr=Wt,Li.zoneName=Qt,Li.dates=X("dates accessor is deprecated. Use date instead.",Pi),Li.months=X("months accessor is deprecated. Use month instead",Q),Li.years=X("years accessor is deprecated. Use year instead",bi),Li.zone=X("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",Le);var $i=Li,qi={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Bi={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Hi=/\d{1,2}/,zi={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ji=v.prototype;ji._calendar=qi,ji.calendar=Kt,ji._longDateFormat=Bi,ji.longDateFormat=Xt,ji._invalidDate="Invalid date",ji.invalidDate=en,ji._ordinal="%d",ji.ordinal=tn,ji._ordinalParse=Hi,ji.preparse=nn,ji.postformat=nn,ji._relativeTime=zi,ji.relativeTime=rn,ji.pastFuture=sn,ji.set=on,ji.months=j,ji._months=hi,ji.monthsShort=Y,ji._monthsShort=pi,ji.monthsParse=G,ji.week=ce,ji._week=_i,ji.firstDayOfYear=de,ji.firstDayOfWeek=ue,ji.weekdays=It,ji._weekdays=Di,ji.weekdaysMin=Rt,ji._weekdaysMin=Ti,ji.weekdaysShort=Ut,ji._weekdaysShort=Vi,ji.weekdaysParse=Lt,ji.isPM=jt,ji._meridiemParse=Ai,ji.meridiem=Yt,w("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===m(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),e.lang=X("moment.lang is deprecated. Use moment.locale instead.",w),e.langData=X("moment.langData is deprecated. Use moment.localeData instead.",k);var Yi=Math.abs,Gi=En("ms"),Wi=En("s"),Qi=En("m"),Ji=En("h"),Zi=En("d"),Ki=En("w"),Xi=En("M"),er=En("y"),tr=Cn("milliseconds"),nr=Cn("seconds"),ir=Cn("minutes"),rr=Cn("hours"),sr=Cn("days"),or=Cn("months"),ar=Cn("years"),lr=Math.round,cr={s:45,m:45,h:22,d:26,M:11},ur=Math.abs,dr=Te.prototype;return dr.abs=fn,dr.add=gn,dr.subtract=vn,dr.as=xn,dr.asMilliseconds=Gi,dr.asSeconds=Wi,dr.asMinutes=Qi,dr.asHours=Ji,dr.asDays=Zi,dr.asWeeks=Ki,dr.asMonths=Xi,dr.asYears=er,dr.valueOf=kn,dr._bubble=bn,dr.get=Sn,dr.milliseconds=tr,dr.seconds=nr,dr.minutes=ir,dr.hours=rr,dr.days=sr,dr.weeks=Mn,dr.months=or,dr.years=ar,dr.humanize=Vn,dr.toISOString=Tn,dr.toString=Tn,dr.toJSON=Tn,dr.locale=gt,dr.localeData=vt,dr.toIsoString=X("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Tn),dr.lang=Oi,T("X",0,0,"unix"),T("x",0,0,"valueOf"),R("x",Xn),R("X",ti),q("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),q("x",function(e,t,n){n._d=new Date(m(e))}),e.version="2.10.6",function(e){An=e}(Oe),e.fn=$i,e.min=De,e.max=Ve,e.utc=o,e.unix=Jt,e.months=cn,e.isDate=n,e.locale=w,e.invalid=u,e.duration=Qe,e.isMoment=p,e.weekdays=dn,e.parseZone=Zt,e.localeData=k,e.isDuration=Ae,e.monthsShort=un,e.weekdaysMin=pn,e.defineLocale=x,e.weekdaysShort=hn,e.normalizeUnits=S,e.relativeTimeThreshold=Dn,e}),define("core/analytics",["require","exports","module","underscore","app-config"],function(e,t,n){"use strict";var i=e("underscore"),r=e("app-config"),s={pageView:function(e){var t={pagePath:e};this._emit("PageView",t)},event:function(e,t,n,r,s){var o,a,l,c,u;o=Array.prototype.slice.call(arguments,0),a={},o[2]&&i.isObject(o[2])?u=o[2]:l=o[2],o[3]&&i.isObject(o[3])?u=o[3]:c=o[3],o[4]&&i.isObject(o[4])&&(u=o[4]),a.category=e,a.action=t,l&&(a.label=l),c&&(a.value=c),u&&(a.obj=u),this._emit("Event",a)},dimension:function(e,t){var n={name:e,value:t};this._emit("Dimension",n)},ecommerce:function(e,t,n){var i={orderId:e,amount:t,provider:n};this._emit("EcommerceTransaction",i)},ecommerceItem:function(e,t,n,i){var r={orderId:e,variantId:t,price:n,quantity:i};this._emit("EcommerceItem",r)},ecommerceSend:function(){this._emit("EcommerceSend")},_emit:function(e,t){var n=r.analytics,s=[e,t];i.isFunction(n)&&n.apply(null,s)}};n.exports=s}),function(e){define("thorax",["handlebars","backbone"],function(){return function(){return function(){function e(e){var n=e._constructorArg;e._referenceCount=0,e._objectOptionsByCid={},e._boundDataObjectsByCid={},_.each(xe,function(t){e[t.name]=[]}),e.children={},e._renderCount=0,n&&_.extend(e,n),t(e),_.each(xe,function(t){t.configure&&t.configure(e)}),e.trigger("configure")}function t(e){e.helpers&&_.each(e.helpers,function(t,n){e.helpers[n]=function(){var n=_.toArray(arguments);return _.last(n).context=this,t.apply(e,n)}})}function n(e){return'Error "'+e+'". For more information visit http://thoraxjs.org/error-codes.html#'+e}function i(e,t){var i=new Error(n(e));return i.name=e,i.info=t,i}function r(e,t){var n=e.extend;e.extend=function(){var e=n.apply(this,arguments);return e.prototype.name&&(t[e.prototype.name]=e),e}}function s(e,t,n,i){var r,s=e[t];if(_.indexOf(n,".")>=0){var o=n.split(/\./);n=o.pop(),_.each(o,function(e){s=s[e]})}if(s&&(r=s[n]),r||i)return r;throw new Error(t+": "+n+" does not exist.")}function o(e,t,n){var i;if(_.isString(e[t])?i=_e.Util.getViewClass(e[t],!0):e.name&&!_.isFunction(e[t])&&(i=_e.Util.getViewClass(e.name+(n.extension||""),!0)),i&&!_.isFunction(e[t])&&(e[t]=i),n.required&&!_.isFunction(e[t]))throw new Error("View "+(e.name||e.cid)+" requires: "+t)}function a(e,t,n){var i;if(_.isString(e[t])?i=_e.Util.getTemplate(e[t],!0):e.name&&!_.isFunction(e[t])&&(i=_e.Util.getTemplate(e.name+(n.extension||""),!0)),!i&&"template"===t&&e._defaultTemplate&&(i=e._defaultTemplate),i&&!_.isFunction(e[t])&&(e[t]=i),n.required&&!_.isFunction(e[t])){var r=new Error("view-requires: "+t);throw r.info={name:e.name||e.cid,parent:e.parent&&(e.parent.name||e.parent.cid),helperName:e._helperName},r}}function l(e,t,n){return t=e&&e[t],t&&t.call?t.call(n||e):t}function c(e){_.each(xe,function(t){e[t.name]||(e[t.name]=[])})}function u(e){_.each(xe,function(t){e[t.name]=[]})}function d(e,t,n,i){var r=[];_.has(e,t)&&r.push(e);var s=e;if(n)for(;s=s.__parent__;)_.has(s,t)&&r.push(s);else for(s=s.constructor;s&&s.__super__;)s.prototype&&_.has(s.prototype,t)&&r.push(s.prototype),s=s.__super__&&s.__super__.constructor;for(var o=r.length;o--;)_.each(l(r[o],t,e),i)}function h(e,t,n,i){if(_.isObject(n)){var r=xe[t];if(r&&r.event)return e&&e.listenTo&&e[t]&&e[t].cid?f(e,n,i,t):f(e["_"+t+"Events"],n,i),!0}}function p(e,t,n,i,r){function s(){if(e.el)o.apply(r,arguments);else{if(a)throw new Error("destroyed-event:"+e.name+":"+n);a++}}var o=R(i,e),a=0;s._callback=o._callback||o,s._thoraxBind=!0,e.listenTo(t,n,s)}function f(e,t,n,i){function r(t,r){i?p(e,e[i],r,t,n||e):e.push([r,t,n])}_.each(t,function(e,t){_.isArray(e)?_.each(e,function(e){r(e,t)}):r(e,t)})}function m(e){e.tag&&(e.tagName=e.tag,delete e.tag),e.class&&(e.className=e.class,delete e.class)}function g(e){if(!we){we={},_.each("area,base,br,col,embed,hr,img,input,keygen,link,menuitem,meta,param,source,track,wbr".split(","),function(e){we[e]=!0})}return we[e]}function v(e,t){return function(){if($(this).parent().view({el:!0,helper:!0})[0]===e.el)return t.call(this)}}function y(e){function t(){if(e)ve(function(){var t=n.shift();t?t():e()});else for(var t;t=n.shift();)t()}var n=[];return{exec:function(i){n.push(function(){i(),e&&t()})},chain:function(i){n.push(function(){e?i(t):i()})},run:function(){e&&!n.length?ve(e):t()}}}function b(e,t,n){function i(e){for(var t=0;e&&t<r.length;t++)""!==r[t]&&"."!==r[t]&&"this"!==r[t]&&(e=e[r[t]]);return e}var r=n.split(".");return i(t)||i(e)}function w(e,t,n){if(_.isString(e)||_.isNumber(e)||_.isNull(e)||_.isBoolean(e))return e;if(null!=t&&!0!==t&&!/^\.\.\//.test(t)){var r=Handlebars.Utils.appendContextPath(n.contextPath,t);if(b(n.view,n.root,r)===e)return{$lut:r}}throw i("server-marshall-object")}function x(e,t){return function(n){if($(n.target).view({el:!0,helper:!1})[0]===t.el)return n.originalContext=this,e(n)}}function k(e,t,n){t+=n.event.originalName;var i=n.handler,r="string"==typeof i?e[i]:i;if(!r)throw new Error('Event "'+i+'" does not exist '+(e.name||e.cid)+":"+t);var s=n.context||e,o=_e.bindSection("thorax-event",{view:s.name||s.cid,eventName:t},function(){return r.apply(s,arguments)});return o._callback=r,o._thoraxBind=!0,o}function E(e){if(e.type)return e;var t=Oe[e];if(t)return t;t=E[e]={type:"view",name:e,originalName:e,nested:!1,selector:void 0};var n=e.match(Ce);return n&&Me[n[2]]&&(t.type="DOM",t.name=n[2],t.nested=!!n[1],t.selector=n[3]),t}function S(e,t,n,i){return{event:E(e),context:i,handler:"string"==typeof n?t[n]:n}}function C(e){for(;e._helperName&&"view"!==e._helperName;)e=e.parent;return e}function M(e,t){if(t["expand-tokens"])return delete t["expand-tokens"],_.each(t,function(n,i){t[i]=_e.Util.expandToken(n,e)}),!0}function O(e,t,n,i){return{inverse:n.inverse,options:n.hash,declaringView:i,parent:C(i),_helperName:e,_helperOptions:{options:A(n),args:_.clone(t)}}}function P(e,t,n){t.fn?e.template=t.fn:n&&n.prototype&&!n.prototype.template&&(e.template=Handlebars.VM.noop)}function D(e,t,n){var r;if(n.factory){if(!(r=n.factory(e,t)))return;r._helperName=t._helperName,r._helperOptions=t._helperOptions}else r=new n(t);if(!r.el)throw i("insert-destroyed-factory");return r}function V(e,t,n,i){var r=i.declaringView,s=i._helperName;e.push(t),r._addChild(t),r.trigger.apply(r,["helper",s].concat(e)),n&&n.apply(this,e)}function T(e,t,n){this._pendingAppend=void 0;var i=this;(e||this.$el).find("["+Pe+"]").forEach(function(e){var r=$(e),s=r.attr(Pe),o=i.children[s];o&&n.chain(function(e){De[s]?(o.render(De[s],e),delete De[s]):o.ensureRendered(e),r.replaceWith(o.el)}),o&&t&&n.exec(function(){t(o.$el)})})}function A(e){var t=_.pick(e,"fn","inverse","hash","data");return t.data=_.omit(e.data,"cid","view","yield","root","_parent"),t.fn=t.fn||void 0,t.inverse=t.inverse||void 0,t}function F(e,t){function n(e,t){return _.every(e,function(e,n){return t[n]===e})}return e._helperName===t._helperName&&(e=e._helperOptions,t=t._helperOptions,e.args.length===t.args.length&&n(e.args,t.args)&&_.isEqual(_.keys(e.options).sort(),_.keys(t.options).sort())&&_.every(e.options,function(i,r){if("data"===r||"hash"===r)return n(e.options[r],t.options[r]);if("fn"===r||"inverse"===r){if(t.options[r]===i)return!0;var s=t.options[r]||{};return i&&_.has(i,"program")&&!i.depth&&s.program===i.program}return t.options[r]===i}))}function N(e,t){function n(n,i){var r=this[e],s=l(this,t.$el);if(n===r)return this;if(r&&this.unbindDataObject(r),n){if(this[e]=n,t.loading&&t.loading(this),this.bindDataObject(e,n,_.extend({},this.options,i)),s){var o={};$serverSide&&t.idAttrName&&(o[t.idAttrName]=n.id),o[t.cidAttrName]=n.cid,s.attr(o)}n.trigger("set",n,r)}else this[e]=!1,t.change&&t.change(this,!1),s&&s.removeAttr(t.cidAttrName);return this.trigger("change:data-object",e,n,r),this}t=xe[e]=_.defaults({name:"_"+e+"Events",event:!0},t),t.ctor=function(n){if(n[e]){var i=n[e];n[e]=null,n[t.set](i)}},_e.View.prototype[t.set]=n}function I(e,t,n,i){d(i,"_"+t+"Events",!0,function(t){p(e,n,t[0],t[1],t[2]||e)})}function U(e,t){e.load?e.load(function(){t&&t.success&&t.success(e)},t):e.fetch(t)}function R(e,t){return _.isFunction(e)?e:t[e]}function L(e,t,n){if(!n||!n.serializing){var i=e.getObjectOptions(t)||{};e.conditionalRender(i.render)}}function q(e,t){var n=e.getObjectOptions(t)||void 0;e.shouldRender(n&&n.render)&&e.renderCollection&&e.renderCollection()}function B(e,t){var n=e.getObjectOptions(t)||void 0;e.shouldRender(n&&n.render)&&e.ensureRendered()}function H(e,t){var n=e._collectionElement;e.itemFilter&&n.find("["+Te+'="'+t.cid+'"]')[z(e,t)?"show":"hide"]()}function z(e,t){return e.itemFilter.call(e,t,e.collection.indexOf(t))}function j(e){var t=e._collectionElement;e.emptyClass&&t.removeClass(e.emptyClass),t.removeAttr(Ie),t.empty()}function Y(e){var t=e._collectionElement;e.emptyClass&&t.addClass(e.emptyClass),t.attr(Ie,!0),e.appendEmpty()}function G(e,t,n){n=n||{},n.target=e,e.trigger(t,n),_.each(e.children,function(e){e.trigger(t,n)})}function W(e){e.$el.attr(Ue,e.cid),e._layoutViewEl=e.el}function Q(e){var t=e.$("["+Ue+'="'+e.cid+'"]')[0];if(!t&&e.$el.attr(Ue)&&(t=e.el),!t)throw new Error("No layout element found in "+(e.name||e.cid));e._layoutViewEl=t}function J(e){return function(t,n){this.parent.trigger(e,t,n)}}function Z(e,t){var n=C(e);if(!e[t]){var i=n[t];i&&(e[t]=i)}}function K(e,t){return _.each(e,function(n,i){if(_.isObject(n))return K(n,t);!1===t(n,i,e)&&delete e[i]}),e}function X(){ne(this),this.model&&this.model.previousAttributes&&this.model.set(this.model.previousAttributes(),{silent:!0})}function ee(e,t,n){var i=0;$("select,input,textarea",t.root||e.el).each(function(){var r=$(this);if(t.children||e.el===r.view({el:!0,helper:!1})[0]){var s=r.attr("type"),o=r.attr("name");"button"!==s&&"cancel"!==s&&"submit"!==s&&o&&(n(r,i,o,s),++i)}})}function te(e,t,n,i){for(var r,s=e,o=t.split("["),a=n.mode,l=0;l<o.length-1;++l){if(r=o[l].replace("]",""),!s[r]){if("serialize"!==a)return i(void 0,r);s[r]={}}s=s[r]}r=o[o.length-1].replace("]",""),i(s,r)}function ne(e){e.$("form").removeAttr("data-submit-wait"),e.$el.removeAttr("data-submit-wait")}function ie(e){var t=e.getObjectOptions(e.model)||{};return!0===t.populate?{}:t.populate}function re(e){var t=$(this),n=t.view({helper:!1}),i=t.attr($e),r=t.attr(qe),s=!1;i&&(s=n[i](e)),r&&n.trigger(r,e),"A"===this.tagName&&!1===s&&e.preventDefault()}function se(){oe(),Be=_e._fastClickEventName||"click",$(document).on(Be,He,re)}function oe(){Be&&$(document).off(Be,He,re)}function ae(e,t){this._pendingElement=void 0;var n=this;(e||this.$el).find("["+ze+"]").forEach(function(e){var i=$(e),r=i.attr(ze),s=n._elementsByCid[r];_.isFunction(s)&&(s=s.call(n)),i.replaceWith(s),t&&t($(s))})}function le(e,t){function n(){if(r||(s=Backbone.history.getFragment(),o=r=!0),o&&s===Backbone.history.getFragment())return void(o=!1);e=void 0,a.cancel(),t&&t()}function i(){Backbone.history.off("route",n),e&&e.apply(this,arguments)}var r=Backbone.History.started,s=r&&Backbone.history.getFragment(),o=Ge!==s;Backbone.history.on("route",n);var a=_.bind(i,this);return a.cancel=function(){Backbone.history.off("route",n)},a}function ce(e,t,n,i){if(e.isPopulated())return _.defer(t,e);2===arguments.length&&!_.isFunction(n)&&_.isObject(n)&&(i=n,n=!1);var r,s=e,o=!1,a=le(_.bind(t,s),function(){o=!0,r&&r.aborted(),!s._request||s.fetchQueue&&s.fetchQueue.length||(s._aborted=!0,s._request.abort()),n&&n.call(s,!1)});e.fetch(_.defaults({success:a,error:function(){a.cancel(),!o&&n&&n.apply(s,[!0].concat(_.toArray(arguments)))}},i)),r=_.last(e.fetchQueue)}function ue(e,t,i){if(t.resetQueue)e.fetchQueue=void 0;else if(e.fetchQueue){var r=(e.fetchQueue[0].options||{}).reset;if(r!==t.reset)throw new Error(n("mixed-fetch"))}if(!e.fetchQueue){e.fetchQueue=[];var s=_.defaults({success:de(e,e.fetchQueue,"success"),error:de(e,e.fetchQueue,"error"),complete:de(e,e.fetchQueue,"complete")},t);if(!i)return s;var o=i.call(e,s);if(!e.fetchQueue)return;e.fetchQueue._promise=o}var a;$.Deferred&&e.fetchQueue._promise&&e.fetchQueue._promise.then&&(a=$.Deferred(),e.fetchQueue._promise.then(_.bind(a.resolve,a),_.bind(a.reject,a)));var l=e.fetchQueue;return e.fetchQueue.push({aborted:function(){var n=_.indexOf(l,this);n>=0&&(l.splice(n,1),l.length||l!==e.fetchQueue||(e.fetchQueue=void 0));var i=[l._promise,"abort"];a&&a.rejectWith(t.context,i),t.error&&t.error.apply(t.context,i),t.complete&&t.complete.apply(t.context,i)},options:t}),a?a.promise():e.fetchQueue._promise}function de(e,t,n){return function(){var i=arguments;_.each(t,function(e){var t=e.options;t[n]&&t[n].apply(this,i)},this),e.fetchQueue===t&&(e.fetchQueue=void 0)}}function he(){this.render()}var pe=window._idCounter||0,fe="";window._resetIdCounter=function(e){pe=0,fe=e||""},_.uniqueId=function(e){var t=fe+ ++pe;return e?e+t:t},window.$serverSide&&FruitLoops.onEmit(function(){$("body").append("<script>window._idCounter = "+pe+";<\/script>")}),"undefined"==typeof $serverSide&&(window.$serverSide=!1);var me=!!navigator.userAgent.match(/Trident\/7\./),ge=me||/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());$.fn.forEach||($.fn.forEach=function(e,t){$.fn.each.call(this,function(n){e.call(t||this,this,n)})});var ve=window.setImmediate||function(e){setTimeout(e,0)},ye="data-view-cid",be={};Handlebars.templates||(Handlebars.templates={});var _e=this.Thorax={templatePathPrefix:"",Views:{},bindSection:function(e,t,n){return n||(n=t,t=void 0),function(){try{return n.apply(this,arguments)}catch(n){_e.onException(e,n,t)}}},runSection:function(e,t,n){return _e.bindSection(e,t,n)()},onException:function(e,t){throw t},templates:Handlebars.templates};_e.View=Backbone.View.extend({constructor:function(e){this._constructorArg=e;var t=Backbone.View.call(this,e);return this._constructorArg=void 0,_.each(xe,function(e){e.ctor&&e.ctor(this,t)},this),t},toString:function(){return"[object View."+this.name+"]"},_configure:function(){},_ensureElement:function(){if(e(this),!$serverSide&&this.el){var t=$(_.result(this,"el"));if(t.length&&"true"===t.attr("data-view-restore"))return this.restore(t)}return Backbone.View.prototype._ensureElement.call(this)},setElement:function(e,t){var n=$(e),i=n.attr("data-view-cid");i&&this._assignCid(i);var r=Backbone.View.prototype.setElement.call(this,n,t),s={"data-view-cid":this.cid};return this.name&&(s["data-view-name"]=this.name),this.$el.attr(s),e.parentNode&&this.retain(),r},_assignCid:function(e){this.cid&&be[this.cid]&&(delete be[this.cid],be[e]=this),this.parent&&(delete this.parent.children[this.cid],this.parent.children[e]=this),this.cid=e},_addChild:function(e){return this.children[e.cid]?e:(e.retain(),this.children[e.cid]=e,e.parent&&e.parent!==this&&!e._helperOptions&&e.parent._removeChild(e),e.parent=this,this.trigger("child",e),e)},_removeChild:function(e){return delete this.children[e.cid],e.parent=null,e.release(),e},_destroy:function(){this.trigger("destroyed"),delete be[this.cid],this.stopListening(),this.off(),_.each(this.children,function(e){e.parent=null,e.release()}),this.el&&(this.undelegateEvents(),this.$el.remove(),Ee.destroy(this.$el)),this.el=this.$el=this.parent=this.children=this.model=this.collection=this._collection=this._boundDataObjectsByCid=this._objectOptionsByCid=this._helperOptions=void 0},restore:function(e,t){if(e=e[0]||e,this._renderCount){var n=this.$el.attr("data-view-cid");return this.cid!==n&&this._assignCid(n),$(e).replaceWith(this.$el),void this.trigger("restore:fail",{type:"previously-rendered",view:this,element:e})}this.setElement(e);var i="true"===this.$el.attr("data-view-restore");if(this.$el.removeAttr("data-view-restore"),!$serverSide&&i){if(a(this,"template",{required:!1}),this._renderCount=1,this.trigger("restore",t),t)this.render();else{var r=this.$("[data-view-restore]"),s=_.filter(r,function(t){var n=$(t).parent();return!n.attr("data-layout-cid")&&n.view({el:!0,helper:!0})[0]===e});s.length&&(this.trigger("restore:fail",{type:"remaining",view:this,element:e,rerendered:s}),this.render())}return this.trigger("after-restore",t),!0}this.trigger("restore:fail",{type:"not-restorable",view:this,element:e}),this.render()},render:function(e,t){var n=this;return n.el?(_e.runSection("thorax-render",{name:n.name},function(){if(n._rendering)throw i("nested-render");n._rendering=!0;var r=new y(t),s={},o=[];_.each(n.children,function(e,t){e._helperOptions?(e._cull=!0,o.push(e)):s[t]=e}),n.children=s,n._previousHelpers=o,n.trigger("before:rendered",r),r.exec(function(){!_.isUndefined(e)&&(_.isElement(e)||_e.Util.is$(e)||e&&e.el||_.isString(e)||_.isFunction(e))?_.isFunction(e)&&(e=n.renderTemplate(e)):(a(n,"template",{required:!0}),e=n.renderTemplate(n.template))}),r.exec(function(){_.each(o,function(e){e._cull&&n._removeChild(e)}),n._previousHelpers=void 0,$serverSide?"false"!==n.$el.attr("data-view-restore")&&n.$el.attr("data-view-restore",$serverSide):n.$el.removeAttr("data-view-restore")}),r.chain(function(t){n.html(e&&e.el||e&&e.string||e,t)}),r.exec(function(){++n._renderCount,n.trigger("rendered"),n._rendering=!1}),r.run()}),n):n},context:function(){return this.model&&this.model.attributes},_getContext:function(){var e=Object.create?Object.create(this):_.clone(this);return _.extend(e,this.context.call?this.context():this.context)},_getData:function(e){return{view:this,root:e,cid:_.uniqueId("t"),yield:function(){return e.fn&&e.fn(e)}}},renderTemplate:function(e,t,n){var i;return i=_.isFunction(e)?e:_e.Util.getTemplate(e,n),i&&i!==Handlebars.VM.noop?(t=t||this._getContext(),i(t,{helpers:this.helpers,data:this._getData(t)})):""},ensureRendered:function(e){this._renderCount?e&&ve(e):this.render(void 0,e)},shouldRender:function(e){return e||null==e&&this._renderCount},conditionalRender:function(e){this.shouldRender(e)&&this.render()},appendTo:function(e){this.ensureRendered(),$(e).append(this.el),this.trigger("ready",{target:this})},html:function(e,t){if(_.isUndefined(e))return this.$el.html();this.trigger("before:append");var n=this._replaceHTML(e);return this.triggerDeferrable("append",void 0,void 0,t),n},release:function(){--this._referenceCount<=0&&this._destroy()},retain:function(e){be[this.cid]||(be[this.cid]=this),++this._referenceCount,e&&this.listenTo(e,"destroyed",e.release)},_replaceHTML:function(e){if(this._renderCount&&(ge||$.fn.jquery))for(;this.el.hasChildNodes();)this.el.removeChild(this.el.childNodes[0]);return this.$el.empty(),this.$el.append(e)},_anchorClick:function(e){var t=$(e.currentTarget),n=t.attr("href");return!(!e.metaKey&&!e.shiftKey)||(!n||"#"!==n[0]&&("/"!==n[0]||"/"===n[1])||(Backbone.history.navigate(n,{trigger:!0}),!1))}}),_e.View.extend=function(){c(this);var e=Backbone.View.extend.apply(this,arguments);return e.__parent__=this,u(e),e},r(_e.View,_e.Views),$.fn.view=function(e){e=_.defaults(e||{},{helper:!0});var t="["+ye+"]";e.helper||(t+=":not([data-view-helper])");var n=$(this).closest(t);if(n){if(e.el)return n;var r=n.attr(ye),s=be[r];if(!s)throw i("fn-view-unregistered");return s}return!1};var we,xe={};_e.Util={getViewInstance:function(e,t){var n=_e.Util.getViewClass(e,!0);return n?new n(t||{}):e},getViewClass:function(e,t){
return _.isString(e)?s(_e,"Views",e,t):!!_.isFunction(e)&&e},getTemplate:function(e,t){if(_.isFunction(e))return e;var n,i=_e.templatePathPrefix;if(i&&e.substr(0,i.length)!==i&&(e=i+e),e=e.replace(/\.handlebars$/,""),n=Handlebars.templates[e],n||(e+=".handlebars",n=Handlebars.templates[e]),!n&&!t)throw new Error("templates: "+e+" does not exist.");return n},is$:function(e){return _.isObject(e)&&"length"in e},expandToken:function(e,t,n){function i(e,t){if(e.match(/^("|')/)&&e.match(/("|')$/))return e.replace(/(^("|')|('|")$)/g,"");for(var i=e.split("."),r=i.length,s=0;t&&s<r;s++)"this"!==i[s]&&(t=t[i[s]]);return n&&_.isString(t)?encodeURIComponent(t):t}if(e&&e.indexOf&&e.indexOf("{{")>=0){for(var r,s=/(?:\{?[^{]+)|(?:\{\{([^}]+)\}\})/g,o=[];r=s.exec(e);)if(r[1]){var a=r[1].split(/\s+/);if(a.length>1){var l=a.shift();a=_.map(a,function(e){return i(e,t)}),Handlebars.helpers[l]?o.push(Handlebars.helpers[l].apply(t,a)):o.push(r[0])}else o.push(i(a[0],t))}else o.push(r[0]);e=o.join("")}return e},tag:function(e,t,i){var r=e.tagName||"div",s=g(r);if(s&&t)throw new Error(n("void-tag-content"));var o="<"+r+" "+_.map(e,function(e,t){if(null==e||"expand-tokens"===t||"tagName"===t)return"";var n=e;return i&&(n=_e.Util.expandToken(e,i)),("className"===t?"class":t)+'="'+Handlebars.Utils.escapeExpression(n)+'"'}).join(" ")+">";return s?o:o+(null==t?"":t)+"</"+r+">"}},_e.Util.Deferrable=y,_e.View.prototype.triggerDeferrable=function(){for(var e=[],t=arguments.length-1,n=arguments[t],i=0;i<t;i++)e.push(arguments[i]);var r=new y(n);e.push(r),this.trigger.apply(this,e),r.run()};var ke=window._thoraxServerData||[],Ee=_e.ServerMarshal={store:function(e,t,n,i,r){if($serverSide){i=i||{},r=r&&r.data||r||{};var s=e._serverData||parseInt(e.attr("data-server-data"),10);isNaN(s)&&(s=ke.length,ke[s]={},e._serverData=s,e.attr("data-server-data",s));var o=ke[s];if(o[t]=void 0,!_.isArray(n)||_.isString(i)||n.toJSON)if(!_.isObject(n)||_.isString(i)||n.toJSON)o[t]=w(n,i,r);else{var a,l={};_.each(n,function(e,t){l[t]=w(e,i[t],r),a=!0}),a&&(o[t]=l)}else n.length&&(o[t]=_.map(n,function(e,t){return w(e,i[t],r)}))}},load:function(e,t,n,i){function r(e){return e&&null!=e.$lut?b(n,i,e.$lut):e}var s=parseInt(e.getAttribute("data-server-data"),0),o=ke[s];if(o){if(o=o[t],_.isArray(o))return _.map(o,r);if(!_.isFunction(o)&&_.isObject(o)&&null==o.$lut){var a={};return _.each(o,function(e,t){a[t]=r(e)}),a}return r(o)}},serialize:function(){if($serverSide)return JSON.stringify(ke)},destroy:function(e){var t=parseInt(e.attr("data-server-data"),10);if(!isNaN(t)){ke[t]=void 0;for(var n=ke.length;n--&&!ke[n];);n<ke.length-1&&(ke.length=n+1)}},_reset:function(){ke=[]}};$serverSide&&FruitLoops.onEmit(function(){$("body").append("<script>var _thoraxServerData = "+Ee.serialize()+";<\/script>")}),_e.Mixins={},_.extend(_e.View,{mixin:function(e){_e.Mixins[e](this)},registerMixin:function(e,t,n){_e.Mixins[e]=function(e){var i=!!e.cid;n&&_.extend(i?e:e.prototype,n),i?t.call(e):e.on("configure",t)}}}),_e.View.prototype.mixin=function(e){_e.Mixins[e](this)};var Se=_e.View.prototype.on,Ce=/^(nested\s+)?(\S+)(?:\s+(.+))?/,Me={},Oe={};!function(e){_.each(e,function(e){Me[e]=!0})}(["touchstart","touchmove","touchend","touchcancel","mouseenter","mouseleave","mousemove","mousedown","mouseup","mouseover","mouseout","keydown","keyup","keypress","contextmenu","click","dblclick","focusin","focusout","focus","blur","submit","input","change","dragstart","drag","dragenter","dragleave","dragover","drop","dragend","singleTap","doubleTap","longTap","swipe","swipeUp","swipeDown","swipeLeft","swipeRight"]),xe.event={name:"_events",configure:function(e){d(e.constructor,"_events",!0,function(t){e.on.call(e,t[0],t[1])}),d(e,"events",!1,function(t,n){e.on(n,t,e)})}},_.extend(_e.View,{on:function(e,t){return c(this),h(this,e,t)?this:(_.isObject(e)?_.each(e,function(e,t){this.on(t,e)},this):(e=E(e),_.isArray(t)?_.each(t,function(t){this._events.push([e,t])},this):this._events.push([e,t])),this)}}),_.extend(_e.View.prototype,{on:function(e,t,n){function i(t){var i=S(e,r,t,n||r);if("DOM"===i.event.type){if($serverSide)return;r._eventsToDelegate||(r._eventsToDelegate=[]),r._eventsToDelegate.push(i)}("DOM"!==i.event.type||r._eventsDelegated)&&r._addEvent(i)}var r=this;return h(r,e,t,n)?r:(_.isObject(e)&&!e.type&&arguments.length<3?_.each(e,function(e,n){r.on(n,e,t||r)}):_.isArray(t)?_.each(t,i):i(t),r)},delegateEvents:function(e){this.undelegateEvents(),e&&(_.isFunction(e)&&(e=e.call(this)),this._eventsToDelegate=[],this.on(e)),_.each(this._eventsToDelegate,this._addEvent,this),this._eventsDelegated=!0},_addEvent:function(e){if(e.handler._thoraxBind)return Se.call(this,e.event.name,e.handler,e.context||this);if(!$serverSide||"view"===e.event.type){var t=k(this,e.event.type+"-event:",e);if("view"===e.event.type)e.context&&e.context!==this&&e.context instanceof _e.View?p(e.context,this,e.event.name,t,e.context):Se.call(this,e.event.name,t,e.context||this);else{e.event.nested||(t=x(t,this));var n=e.event.name+".delegateEvents"+this.cid;e.event.selector?this.$el.on(n,e.event.selector,t):this.$el.on(n,t)}}}}),_e.View.prototype.bind=_e.View.prototype.on,_e.View.on("ready",function(e){function t(t){t._isReady||t.trigger("ready",e)}this._isReady||(this._isReady=!0,_.each(this.children,t),this.on("child",t))});var Pe="data-view-tmp",De={},Ve={_ensureElement:function(){_e.View.prototype._ensureElement.call(this),this.$el.attr("data-view-helper",this._helperName)},_getContext:function(){return this.parent._getContext()}};_e.HelperView=_e.View.extend(Ve),Handlebars.registerViewHelper=function(e,t,n){function i(e,t,n){try{if(Ee.store(e.$el,"args",t,n.ids,n),Ee.store(e.$el,"attrs",n.hash,n.hashIds,n),n.fn&&n.fn!==Handlebars.VM.noop){if(n.fn.depth)throw new Error;Ee.store(e.$el,"fn",n.fn.program)}if(n.inverse&&n.inverse!==Handlebars.VM.noop){if(n.inverse.depth)throw new Error;Ee.store(e.$el,"inverse",n.inverse.program)}}catch(t){e.$el.attr("data-view-restore","false"),e.trigger("restore:fail",{type:"serialize",view:e,err:t})}}2===arguments.length&&(t.factory?n=t.callback:(n=t,t=_e.HelperView));var r=t.attributeWhiteList;Handlebars.registerHelper(e,function(){for(var s=[],o=arguments[arguments.length-1],a=o.data.view,l=0,c=arguments.length-1;l<c;l++)s.push(arguments[l]);var u=M(this,o.hash),d=O(e,s,o,a);P(d,o,t),m(o.hash);var h=_.clone(o.hash);_.each(r,function(e,t){delete h[t],_.isUndefined(o.hash[t])||(d[e]=o.hash[t])}),h.tagName&&(d.tagName=h.tagName),d.attributes=function(){var e=t.prototype&&t.prototype.attributes||{};return _.isFunction(e)&&(e=e.call(this)),_.extend(e,_.omit(h,["tagName"])),e.className&&(e.class=e.className,delete e.className),e};var p=_.find(a._previousHelpers,function(e){return e._cull&&F(d,e)});if(p){if(!p.el)throw new Error("insert-destroyed");a.children[p.cid]=p}else{if(!(p=D(s,d,t)))return"";p.$el.attr("data-view-helper-restore",e),$serverSide&&"false"!==p.$el.attr("data-view-restore")&&i(p,s,o),V(s,p,n,d)}return p._cull=!1,a._pendingAppend||(a._pendingAppend=!0,a.once("append",T)),h[Pe]=p.cid,t.modifyHTMLAttributes&&t.modifyHTMLAttributes(h,p),new Handlebars.SafeString(_e.Util.tag(h,"",u?this:null))});var s=Handlebars.helpers[e];return s.restore=function(i,s,o){var a=i.context(),l=Ee.load(s,"args",i,a)||[],c=Ee.load(s,"attrs",i,a)||{},u={hash:c,fn:Ee.load(s,"fn"),inverse:Ee.load(s,"inverse")};i.template._setup({helpers:this.helpers}),u.fn&&(u.fn=i.template._child(u.fn)),u.inverse&&(u.inverse=i.template._child(u.inverse));var d=O(e,l,u,i);P(d,u,t),r&&_.each(r,function(e,t){_.isUndefined(c[t])||(d[e]=c[t])});var h=D(l,d,t);if(h)return h._assignCid(s.getAttribute("data-view-cid")),V(l,h,n,d),h.restore(s,o),h},s},_e.View.on("restore",function(e){var t=this;t.$("[data-view-helper-restore][data-view-restore=true]").each(v(t,function(){var n=Handlebars.helpers[this.getAttribute("data-view-helper-restore")],i=n.restore(t,this,e);i&&t._addChild(i)}))}),_.extend(_e.View.prototype,{getObjectOptions:function(e){return e&&this._objectOptionsByCid[e.cid]},bindDataObject:function(e,t,n){if(!this._boundDataObjectsByCid[t.cid]){this._boundDataObjectsByCid[t.cid]=t;var n=this._modifyDataObjectOptions(t,_.extend({},xe[e].defaultOptions,n));this._objectOptionsByCid[t.cid]=n,I(this,e,t,this.constructor),I(this,e,t,this);var i=xe[e];i.bindCallback&&i.bindCallback(this,t,n),t.shouldFetch&&t.shouldFetch(n)?U(t,n):xe[e].change&&xe[e].change(this,t,n)}},unbindDataObject:function(e){this.stopListening(e),delete this._boundDataObjectsByCid[e.cid],delete this._objectOptionsByCid[e.cid]},_modifyDataObjectOptions:function(e,t){return t}});var Te="data-model-cid";_e.Model=Backbone.Model.extend({isEmpty:function(){return!this.isPopulated()},isPopulated:function(){var e=_.clone(this.attributes),t=l(this,"defaults")||{};for(var n in t){if(e[n]!=t[n])return!0;delete e[n]}var i=_.keys(e);return i.length>1||1===i.length&&i[0]!==this.idAttribute},shouldFetch:function(e){var t;try{t=l(this,"url")}catch(e){t=!1}return e.fetch&&!!t&&!this.isPopulated()}}),_e.Models={},r(_e.Model,_e.Models),N("model",{set:"setModel",defaultOptions:{render:void 0,fetch:!0,success:!1,invalid:!0},change:L,$el:"$el",idAttrName:"data-model-id",cidAttrName:Te}),_e.View.on({model:{invalid:function(e,t){this.getObjectOptions(e).invalid&&this.trigger("invalid",t,e)},error:function(e,t){this.trigger("error",t,e)},change:function(e,t){xe.model.change(this,e,t)}}}),$.fn.model=function(e){var t=$(this),n=t.closest("["+Te+"]"),i=n&&n.attr(Te);if(i){var e=e||t.view();if(e&&e.model&&e.model.cid===i)return e.model||!1;var r=t.collection(e);if(r)return r.get(i)}return!1};var Ae=Backbone.Collection.prototype.fetch,Fe=Backbone.Collection.prototype.set,Ne=_e.View.prototype._replaceHTML,Ie="data-collection-empty";_e.Collection=Backbone.Collection.extend({model:_e.Model||Backbone.Model,initialize:function(e,t){return this.cid=_.uniqueId("collection"),Backbone.Collection.prototype.initialize.call(this,e,t)},isEmpty:function(){return!(this.length>0)&&(0===this.length&&this.isPopulated())},isPopulated:function(){return this._fetched||this.length>0||!this.length&&!l(this,"url")},shouldFetch:function(e){return e.fetch&&!!l(this,"url")&&!this.isPopulated()},fetch:function(e){e=e||{};var t=e.success;return e.success=function(e,n,i){e._fetched=!0,t&&t(e,n,i)},Ae.call(this,e)},set:function(e,t){return this._fetched=!!e,Fe.call(this,e,t)}}),_.extend(_e.View.prototype,{getCollectionViews:function(e){return _.filter(this.children,function(t){return t instanceof _e.CollectionView&&(!e||t.collection===e)})},updateFilter:function(e){_.invoke(this.getCollectionViews(e),"updateFilter")}}),_e.Collections={},r(_e.Collection,_e.Collections),N("collection",{set:"setCollection",bindCallback:B,defaultOptions:{render:void 0,fetch:!0,success:!1,invalid:!0,change:!0},change:q,$el:"getCollectionElement",cidAttrName:"data-collection-cid"}),_e.CollectionView=_e.View.extend({_defaultTemplate:Handlebars.VM.noop,_collectionSelector:"[data-collection-element]",_replaceHTML:function(e){if(!(this.collection&&this.getObjectOptions(this.collection)&&this._renderCount)){var t=Ne.call(this,e);return this._lookupCollectionElement(),t}var n=this._collectionElement;Ne.call(this,e),this._lookupCollectionElement(),n.attr("data-view-cid")||this._collectionElement.replaceWith(n)},render:function(e,t){if(!this.shouldRender()){var n=this;this.once("append",function(e,t,i){i.chain(function(e){n.renderCollection(e)})})}return _e.View.prototype.render.call(this,e,t)},restore:function(e,t){this._forceRerender=t,_e.View.prototype.restore.call(this,e)},restoreCollection:function(){var e=this,t=this.$el.children(),n=[],i=0;this._lookupCollectionElement(),this.$("[data-model-id]").each(v(e,function(){var r=this.getAttribute("data-model-id"),s=e.collection.get(r);s?(e.restoreItem(s,t.index(this),this,e._forceRerender),i++):n.push(this)}));var r;this.$("[data-view-empty]").each(v(e,function(){e.collection.length?r=!0:e.restoreEmpty(this,e._forceRerender)}));var s=i!==this.collection.length||n.length||r;if(s&&this.collection.isPopulated())if(_.each(n,function(t){t.parentNode.removeChild(t),e.trigger("restore:fail",{type:"collection-remove",element:t})}),r||!this.collection.length)this.renderCollection(),e.trigger("restore:fail",{type:r?"collection-empty-found":"collection-empty-missing"});else{var o=this._collectionElement;this.collection.each(function(t){o.find("["+Te+'="'+t.cid+'"]').length||(e.appendItem(t),e.trigger("restore:fail",{type:"collection-missing",model:t}))})}else if(s)return void(this._pendingRestore=!0);this.trigger("restore:collection",this,this.el)},appendItem:function(e,t,n,i,r){if(e){var s,o=this._collectionElement,a=this.collection,l=!n||null==n.filter||n.filter;if(t&&t.el&&(t=o.children().indexOf(t.el)+1),e.el||_.isString(e)?(s=e,e=!1):(t=null!=t?t:a.indexOf(e)||0,s=this.renderItem.call(this,e,t)),s){s.cid&&(this._addChild(s),s.ensureRendered()),_.isString(s)&&!/^\s*</m.test(s)&&(s="<div>"+s+"</div>");var c=s.$el||$($.trim(s)).filter(function(){return 1===this.nodeType||"tag"===this.type});if(e&&c.attr({"data-model-id":e.id,"data-model-cid":e.cid}),i)o.append(c);else{var u=t>0&&a.at(t-1);if(u){o.children("["+Te+'="'+u.cid+'"]').last().after(c)}else o.prepend(c)}this.triggerDeferrable("append",null,function(t){t.attr({"data-model-cid":e.cid,"data-model-id":e.id})},r),n&&n.silent||this.trigger("rendered:item",this,a,e,c,t),l&&H(this,e)}return s}},updateItem:function(e){var t=this._collectionElement,n=t.find("["+Te+'="'+e.cid+'"]');n.attr(ye)||(this.removeItem(n),this.appendItem(e))},removeItem:function(e){function t(e){var t=e.attr(ye),i=n.children[t];i&&n._removeChild(i)}var n=this,i=e;if(e.cid){i=this._collectionElement.find("["+Te+'="'+e.cid+'"]')}return!!i.length&&(i.find("["+ye+"]").each(function(e,n){t($(n))}),t(i),i.detach(),!0)},renderCollection:function(e){var t=new y(e),n=this;n.collection?(n.collection.isEmpty()?t.exec(function(){Y(n)}):n._pendingRestore?(n._pendingRestore=!1,n.restoreCollection(n._forceRerender)):(t.exec(function(){j(n)}),_.each(n.collection.models,function(e,i){t.chain(function(t){n.appendItem(e,i,void 0,!0,t)})})),t.exec(function(){n.trigger("rendered:collection",n,n.collection)})):t.exec(function(){Y(n)}),t.run()},emptyClass:"empty",renderEmpty:function(){if(this.emptyView||o(this,"emptyView",{extension:"-empty"}),this.emptyTemplate||this.emptyView||a(this,"emptyTemplate",{extension:"-empty",required:!1}),this.emptyView){var e={};return this.emptyTemplate&&(e.template=this.emptyTemplate),_e.Util.getViewInstance(this.emptyView,e)}return this.emptyTemplate&&this.renderTemplate(this.emptyTemplate)},restoreEmpty:function(e,t){var n=this.renderEmpty();return n.restore(e,t),this._addChild(n),this.trigger("restore:empty",this,e),n},renderItem:function(e,t){if(this.itemView||o(this,"itemView",{extension:"-item",required:!1}),this.itemTemplate||this.itemView||a(this,"itemTemplate",{extension:"-item",required:!this.itemView}),this.itemView){var n={model:e};return this.itemTemplate&&(n.template=this.itemTemplate),_e.Util.getViewInstance(this.itemView,n)}return this.renderTemplate(this.itemTemplate,this.itemContext.call(this,e,t))},restoreItem:function(e,t,n,i){if(n.setAttribute(Te,e.cid),this.itemView||this.renderItem!==_e.CollectionView.prototype.renderItem){var r=this.renderItem(e,t);_.isString(r)||(r.restore(n,i),this._addChild(r))}this.trigger("restore:item",this,n)},itemContext:function(e){return e.attributes},appendEmpty:function(){this._collectionElement.empty();var e=this.renderEmpty.call(this);e&&e.$el&&e.$el.attr("data-view-empty","true"),e&&this.appendItem(e,0,{silent:!0,filter:!1}),this.trigger("rendered:empty",this,this.collection)},getCollectionElement:function(){return this._collectionElement},_lookupCollectionElement:function(){var e=this.$(this._collectionSelector).filter(v(this,function(){return!0}));this._collectionElement=e.length?e:this.$el},updateFilter:function(){var e=this;e.itemFilter&&_.each(e.collection.models,function(t){H(e,t)})}}),_e.CollectionView.on({restore:"restoreCollection",collection:{reset:function(e){q(this,e)},sort:function(e){q(this,e)},change:function(e){var t=this.getObjectOptions(this.collection);t&&t.change&&this.updateItem(e),H(this,e)},add:function(e){if(this._collectionElement.length){1===this.collection.length&&j(this);var t=this.collection.indexOf(e);this.appendItem(e,t)}},remove:function(e){var t=this._collectionElement;this.removeItem(e),0===this.collection.length&&t.length&&Y(this)}}}),_e.View.on({collection:{invalid:function(e,t){this.getObjectOptions(e).invalid&&this.trigger("invalid",t,e)},error:function(e,t){this.trigger("error",t,e)}}}),$.fn.collection=function(e){if(e&&e.collection)return e.collection;var t=$(this),n=t.closest("[data-collection-cid]");return!(!n||!n.attr("data-collection-cid")||!(e=t.view()))&&e.collection};var Ue="data-layout-cid";_e.LayoutView=_e.View.extend({_defaultTemplate:Handlebars.VM.noop,render:function(e){var t=_e.View.prototype.render.call(this,e);return this.template===Handlebars.VM.noop?W(this):Q(this),t},restore:function(e,t){this._forceRerender=t,_e.View.prototype.restore.call(this,e)},setView:function(e,t){function n(){o&&(o.$el&&o.$el.detach(),G(o,"deactivated",t),a._removeChild(o))}function i(){if(e)if($serverSide&&!l)a._view=e,a._addChild(e),FruitLoops.emit();else{e.ensureRendered(),t.activating=e,G(a,"activated",t),e.trigger("activated",t),a._view=e;var n=a._layoutViewEl;a._view.appendTo(n),a._addChild(e)}else a._view=void 0}function r(){a.hasBeenSet=!0,a.trigger("change:view:end",e,o,t)}if(t=_.extend({scroll:!0},t),_.isString(e)&&(e=new(_e.Util.registryGet(_e,"Views",e,!1))),!$serverSide&&!this.hasBeenSet){var s=this.$('[data-view-name="'+e.name+'"]')[0];s?e.restore(s,this._forceRerender):$(this._layoutViewEl).empty()}this.ensureRendered();var o=this._view,a=this,l=e&&$serverSide&&(t.serverRender||e.serverRender),c=!1!==t.async&&(t.async||l);return e!==o&&(c&&e&&!e._renderCount?void ve(function(){e.ensureRendered(function(){a.setView(e,t)})}):(this.trigger("change:view:start",e,o,t),t.transition?t.transition(e,o,i,n,r):(n(),i(),r()),e))},getView:function(){return this._view}}),_e.LayoutView.on("after-restore",function(){Q(this)}),Handlebars.registerHelper("layout-element",function(e){var t=e.data.view;if(!t.getView)throw new Error(n("layout-element-helper"));return e.hash[Ue]=t.cid,m(e.hash),new Handlebars.SafeString(_e.Util.tag.call(this,e.hash,"",this))}),_e.CollectionHelperView=_e.CollectionView.extend({events:{"rendered:collection":J("rendered:collection"),"rendered:item":function(e,t,n,i,r){this.parent.trigger("rendered:item",e,t,n,i,r)},"rendered:empty":J("rendered:empty"),"restore:collection":J("restore:collection"),"restore:item":J("restore:item"),"restore:empty":J("restore:empty")},getCollectionElement:function(){return this.$el},constructor:function(e){var t=!0;e.options["item-template"]&&(e.itemTemplate=_e.Util.getTemplate(e.options["item-template"])),e.options["empty-template"]&&(e.emptyTemplate=_e.Util.getTemplate(e.options["empty-template"])),!e.itemTemplate&&e.template&&e.template!==Handlebars.VM.noop&&(e.itemTemplate=e.template,e.template=Handlebars.VM.noop,e.itemTemplate.depth&&(t=!1)),!e.emptyTemplate&&e.inverse&&e.inverse!==Handlebars.VM.noop&&(e.emptyTemplate=e.inverse,e.inverse=Handlebars.VM.noop,e.emptyTemplate.depth&&(t=!1));var n=_.isFunction(e.itemContext),i=_.isFunction(e.itemFilter),r=_e.HelperView.call(this,e);return n?this.itemContext=_.bind(this.itemContext,this.parent):_.isString(this.itemContext)&&(this.itemContext=_.bind(this.parent[this.itemContext],this.parent)),i?this.itemFilter=_.bind(this.itemFilter,this.parent):_.isString(this.itemFilter)&&(this.itemFilter=_.bind(this.parent[this.itemFilter],this.parent)),this.parent.name&&(this.emptyView||this.parent.renderEmpty||(this.emptyView=_e.Util.getViewClass(this.parent.name+"-empty",!0)),this.emptyTemplate||this.parent.renderEmpty||(this.emptyTemplate=_e.Util.getTemplate(this.parent.name+"-empty",!0)),this.itemView||this.parent.renderItem||(this.itemView=_e.Util.getViewClass(this.parent.name+"-item",!0)),this.itemTemplate||this.parent.renderItem||(this.itemTemplate=_e.Util.getTemplate(this.parent.name+"-item",!!this.itemView))),$serverSide&&!t&&(this.$el.attr("data-view-restore","false"),this.trigger("restore:fail",{type:"serialize",view:this,err:"collection-depthed-query"})),r},setAsPrimaryCollectionHelper:function(){var e=this,t=e.parent;_.each(Re,function(t){Z(e,t)}),_.each(["itemFilter","itemContext","renderItem","renderEmpty"],function(n){t[n]&&(e[n]=function(e,i){return t[n](e,i)})})}}),_.extend(_e.CollectionHelperView.prototype,Ve),_e.CollectionHelperView.attributeWhiteList={"item-context":"itemContext","item-filter":"itemFilter","item-template":"itemTemplate","empty-template":"emptyTemplate","item-view":"itemView","empty-view":"emptyView","empty-class":"emptyClass"};var Re=["itemTemplate","itemView","emptyTemplate","emptyView"];Handlebars.registerViewHelper("collection",_e.CollectionHelperView,function(e,t){1===arguments.length&&(t=e,e=t.parent.collection,e&&t.setAsPrimaryCollectionHelper(),t.$el.attr("data-collection-element","true"),t.listenTo(t.parent,"change:data-object",function(e,n){"collection"===e&&(t.setAsPrimaryCollectionHelper(),t.setCollection(n))})),e&&t.setCollection(e)}),Handlebars.registerHelper("collection-element",function(e){if(!e.data.view.renderCollection)throw new Error(n("collection-element-helper"));var t=e.hash;return m(t),t.tagName=t.tagName||"div",t["data-collection-element"]=!0,new Handlebars.SafeString(_e.Util.tag.call(this,t,"",this))}),Handlebars.registerHelper("empty",function(e,t){1===arguments.length&&(t=e);var n=t.data.view;return 1===arguments.length&&(e=n.model),n._emptyListeners||(n._emptyListeners={}),e&&!n._emptyListeners[e.cid]&&e.models&&"length"in e&&(n._emptyListeners[e.cid]=!0,n.listenTo(e,"remove",function(){0===e.length&&n.render()}),n.listenTo(e,"add",function(){1===e.length&&n.render()}),n.listenTo(e,"reset",function(){n.render()})),!e||e.isEmpty()?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("template",function(e,t){var n=!1;for(var i in t.hash){n=!0;break}var r=this;(t.fn||n)&&(r=Object.create?Object.create(this):_.clone(this),_.extend(r,{fn:t.fn},t.hash));var s=t.data.view.renderTemplate(e,r);return new Handlebars.SafeString(s)}),Handlebars.registerHelper("yield",function(e){return e.data.yield()}),Handlebars.registerHelper("url",function(e,t){var n=e||"",i="";if(arguments.length>2)for(var r=0,s=arguments.length-1;r<s;r++)i+=(r?"/":"")+encodeURIComponent(arguments[r]);else{var o=t&&t.hash||t;i=o&&o["expand-tokens"]?_e.Util.expandToken(n,this,!0):n}if(Backbone.history._hasPushState){var a=Backbone.history.options.root;return"/"===a&&"/"===i.substr(0,1)?i:a+i}return"#"+i}),Handlebars.registerViewHelper("view",{factory:function(e,t){var n=e.length>=1?e[0]:_e.View;return _e.Util.getViewInstance(n,t.options)},modifyHTMLAttributes:function(e,t){e.tagName=(t.el.tagName||t.el.name||"").toLowerCase()},callback:function(e){var t=arguments[arguments.length-1],i=t._helperOptions.options,r=t.cid;if(!_.isString(e)&&i.hash&&_.keys(i.hash).length>0)throw new Error(n("view-helper-hash-args"));i.fn&&(De[r]=i.fn)}}),xe.model.defaultOptions.populate=!0;var Le=xe.model.change;xe.model.change=function(e,t,n){if(e._isChanging=!0,Le.apply(e,arguments),e._isChanging=!1,!n||!n.serializing){var i=ie(e);e._renderCount&&i&&e.populate(!i.context&&e.model.attributes,i)}},_.extend(_e.View.prototype,{serialize:function(){for(var e,t,n,i=0;i<arguments.length;++i)_.isFunction(arguments[i])?e=arguments[i]:_.isObject(arguments[i])&&("stopPropagation"in arguments[i]&&"preventDefault"in arguments[i]?n=arguments[i]:t=arguments[i]);if(!n||this._preventDuplicateSubmission(n)){t=_.extend({set:!0,validate:!0,children:!0},t||{});var r=t.attributes||{},s=this,o=[];if(ee(this,t,function(e,t,n,i){var o=s._getInputValue(e,i);_.isUndefined(o)||te(r,n,{mode:"serialize"},function(e,t){e[t]?_.isArray(e[t])?e[t].push(o):e[t]=[e[t],o]:e[t]=o})}),t._silent||this.trigger("serialize",r,t),t.validate){var a=this.validateInput(r);if(a&&a.length&&(o=o.concat(a)),this.trigger("validate",r,o,t),o.length)return void this.trigger("invalid",o)}if(t.set&&this.model&&!this.model.set(r,{silent:t.silent,serializing:!0}))return!1;var l=this;return e&&e.call(this,r,function(){ne(l)}),r}},_preventDuplicateSubmission:function(e,t){e.preventDefault();var n=$(e.target);return"form"!==(e.target.tagName||"").toLowerCase()&&(n=$(e.target).closest("form")),!n.attr("data-submit-wait")&&(n.attr("data-submit-wait","true"),t&&t.call(this,e),!0)},populate:function(e,t){t=_.extend({children:!0},t||{});var n,e=e||this._getContext();ee(this,t,function(t,i,r,s){te(e,r,{mode:"populate"},function(e,i){if(n=e&&e[i],!_.isUndefined(n)){"checkbox"===s||"radio"===s?(n=_.isBoolean(n)?n:n===t.val(),t[n?"attr":"removeAttr"]("checked","checked")):t.val(n)}})}),++this._populateCount,t._silent||this.trigger("populate",e)},validateInput:function(){},_getInputValue:function(e,t){if("checkbox"!==t&&"radio"!==t)return e.val()||"";var n=e[e.prop?"prop":"attr"]("checked");if(n||""===n){var i=e.attr("value");return"on"===i||i||!0}},_populateCount:0}),_e.View.on({"before:rendered":function(){if(this._renderCount&&(this.model&&this.model.cid)===this._formModelCid){var e=this.getObjectOptions(this.model);this.previousFormData=K(this.serialize(_.extend({set:!1,validate:!1,_silent:!0},e)),function(e){return""!==e&&null!=e})}},rendered:function(){var e=ie(this);!e||this._isChanging||this._populateCount||this.populate(!e.context&&this.model.attributes,e),this.previousFormData&&this.populate(this.previousFormData,_.extend({_silent:!0},e)),this._formModelCid=this.model&&this.model.cid,this.previousFormData=null}}),$serverSide||_e.View.on({invalid:X,error:X,deactivated:function(){this.$el&&ne(this)}});var $e="data-call-method",qe="data-trigger-event";Handlebars.registerHelper("button",function(e,t){1===arguments.length&&(t=e,e=t.hash.method);var i=t.hash,r=i["expand-tokens"];if(delete i["expand-tokens"],!e&&!t.hash.trigger)throw new Error(n("button-trigger"));return m(i),i.tagName=i.tagName||"button",i.trigger&&(i[qe]=i.trigger),delete i.trigger,e&&(i[$e]=e),new Handlebars.SafeString(_e.Util.tag(i,t.fn?t.fn(this):"",r?this:null))}),Handlebars.registerHelper("link",function(){var e=_.toArray(arguments),t=e.pop(),i=t.hash,r=0===e.length?[i.href]:e,s=i["expand-tokens"];if(delete i["expand-tokens"],!r[0]&&""!==r[0])throw new Error(n("link-href"));return m(i),r.push(t),i.href=Handlebars.helpers.url.apply(this,r),i.tagName=i.tagName||"a",i.trigger&&(i[qe]=t.hash.trigger),delete i.trigger,i[$e]="_anchorClick",new Handlebars.SafeString(_e.Util.tag(i,t.fn?t.fn(this):"",s?this:null))});var Be,He="["+$e+"], ["+qe+"]";$(document).ready(function(){_e._fastClickEventName||se()});var ze="data-element-tmp";Handlebars.registerHelper("element",function(e,t){m(t.hash);var n=_.uniqueId("element"),i=t.data.view;return t.hash[ze]=n,i._elementsByCid||(i._elementsByCid={}),i._elementsByCid[n]=e,i._pendingElement||(i._pendingElement=!0,i.once("append",ae)),new Handlebars.SafeString(_e.Util.tag(t.hash))}),Handlebars.registerHelper("super",function(e){var t=e.data.view,i=t.constructor&&t.constructor.__super__;if(i){var r=i.template;if(!r){if(!i.name)throw new Error(n("super-parent"));r=i.name}return _.isString(r)&&(r=_e.Util.getTemplate(r,!1)),new Handlebars.SafeString(r(this,e))}return""});var je,Ye="load:start";_e.setRootObject=function(e){je=e},_e.loadHandler=function(e,t,n){var i=_.uniqueId("load");return function(r,s,o){function a(){if(!c.timeout||c.run){var t=void 0!==l._loadingTimeoutDuration?l._loadingTimeoutDuration:_e.View.prototype._loadingTimeoutDuration;c.timeout=setTimeout(_e.bindSection("load-start",function(){c.events.length&&(c.run=!0,e.call(l,c.message,c.background,c))}),1e3*t)}}if(!$serverSide){var l=n||this;l._loadInfo=l._loadInfo||{};var c=l._loadInfo[i];if(c?(clearTimeout(c.endTimeout),c.message=r,!s&&c.background&&(c.background=!1,a())):(c=l._loadInfo[i]=_.extend({isLoading:function(){return c.events.length},cid:i,events:[],timeout:0,message:r,background:!!s},Backbone.Events),a()),!(_.indexOf(c.events,o)>=0)){c.events.push(o);var u=function(){var e=l._loadingTimeoutEndDuration;void 0===e&&(e=_e.View.prototype._loadingTimeoutEndDuration);var n=c.events,r=_.indexOf(n,o);r>=0&&!o.isLoading()&&(n.splice(r,1),_.indexOf(n,o)<0&&o.off("load:end",u)),n.length||(clearTimeout(c.endTimeout),c.endTimeout=setTimeout(_e.bindSection("load-end",function(){n.length||(c.run&&(t&&t.call(l,c.background,c),c.trigger("load:end",c)),clearTimeout(c.timeout),c=l._loadInfo[i]=void 0)}),1e3*e))};o.on("load:end",u)}}}},_e.forwardLoadEvents=function(e,t,n){function i(r,s,o){n&&e.off(Ye,i),t.trigger(Ye,r,s,o)}return e.on(Ye,i),{off:function(){e.off(Ye,i)}}},_e.mixinLoadable=function(e,t){_.extend(e,{_loadingClassName:"loading",_loadingTimeoutDuration:.33,_loadingTimeoutEndDuration:.1,onLoadStart:function(e,n,i){var r=t?this.parent:this;r&&r.el&&(r.nonBlockingLoad||n||!je||je===this||je.trigger(Ye,e,n,i),r._isLoading=!0,r.$el.addClass(r._loadingClassName),r.trigger("change:load-state","start",n))},onLoadEnd:function(){var e=t?this.parent:this;e&&e.el&&(e._isLoading=!1,e.$el.removeClass(e._loadingClassName),e.trigger("change:load-state","end"))}})},_e.mixinLoadableEvents=function(e,t){_.extend(e,{_loadCount:0,isLoading:function(){return this._loadCount>0},loadStart:function(e,n){this._loadCount++;var i=t?this.parent:this;i.trigger(Ye,e,n,i)},loadEnd:function(){this._loadCount--;var e=t?this.parent:this;e.trigger("load:end",e)}})},_e.mixinLoadable(_e.View.prototype),_e.mixinLoadableEvents(_e.View.prototype),_e.HelperView&&(_e.mixinLoadable(_e.HelperView.prototype,!0),_e.mixinLoadableEvents(_e.HelperView.prototype,!0)),_e.CollectionHelperView&&(_e.mixinLoadable(_e.CollectionHelperView.prototype,!0),_e.mixinLoadableEvents(_e.CollectionHelperView.prototype,!0)),_e.sync=function(e,t,n){var i=this,r=n.complete;return n.complete=function(){i._request=void 0,i._aborted=!1,r&&r.apply(this,arguments)},this._request=Backbone.sync.apply(this,arguments),this._request};var Ge,We=Backbone.History.prototype.loadUrl;Backbone.History.prototype.loadUrl=function(){return Backbone.history.once("route",function(){Ge=Backbone.history.getFragment()}),Ge=!1,We.apply(this,arguments)};var Qe=[];_e.Model&&Qe.push(_e.Model),_e.Collection&&Qe.push(_e.Collection),_.each(Qe,function(e){var t=e.prototype.fetch;_e.mixinLoadableEvents(e.prototype,!1),_.extend(e.prototype,{sync:_e.sync,fetch:function(n){function i(e){var t=n[e];n[e]=function(){r.loadEnd(),t&&t.apply(this,arguments)}}if(n=n||{},e===_e.Collection&&(_.find(["reset","remove","add","update"],function(e){return!_.isUndefined(n[e])})||(n.reset=!0)),!n.loadTriggered){var r=this;i("success"),i("error"),r.loadStart(void 0,n.background)}return ue(this,n||{},t)},load:function(e,t,n){2!==arguments.length||_.isFunction(t)||(n=t,t=!1),n=n||{},n.background||this.isPopulated()||!je||(this.isLoading()?je.trigger(Ye,n.message,n.background,this):_e.forwardLoadEvents(this,je,!0)),ce(this,e,t,n)}})}),_e.Util.bindToRoute=le,_e.View.prototype._modifyDataObjectOptions=function(e,t){return t.ignoreErrors=this.ignoreFetchError,t.background=this.nonBlockingLoad,t},_e.HelperView.prototype._modifyDataObjectOptions=_e.CollectionHelperView.prototype._modifyDataObjectOptions=function(e,t){return t.ignoreErrors=this.parent.ignoreFetchError,t.background=this.parent.nonBlockingLoad,t},xe.collection.loading=function(e){var t=e.loadingView,n=e.loadingTemplate,i=e.loadingPlacement;if(t||n){var r=_e.loadHandler(function(){var r;if(0===e.collection.length&&e.$el.empty(),t){var s=_e.Util.getViewInstance(t);e._addChild(s),n?s.render(n):s.render(),r=s}else r=e.renderTemplate(n);var o=i?i.call(e):e.collection.length;e.appendItem(r,o),e.$el.children().eq(o).attr("data-loading-element",e.collection.cid)},function(){
e.$el.find('[data-loading-element="'+e.collection.cid+'"]').remove()},e.collection);e.listenTo(e.collection,"load:start",r)}},_e.CollectionHelperView&&_.extend(_e.CollectionHelperView.attributeWhiteList,{"loading-template":"loadingTemplate","loading-view":"loadingView","loading-placement":"loadingPlacement"}),_e.View.on({"load:start":_e.loadHandler(function(e,t,n){this.onLoadStart(e,t,n)},function(e,t){this.onLoadEnd(t)}),collection:{"load:start":function(e,t,n){this.trigger(Ye,e,t,n)}},model:{"load:start":function(e,t,n){this.trigger(Ye,e,t,n)}}}),Handlebars.registerHelper("loading",function(e){var t=e.data.view;return t.off("change:load-state",he,t),t.on("change:load-state",he,t),t._isLoading?e.fn(this):e.inverse(this)})}(),e.Thorax=Thorax}.apply(e,arguments)})}(this),define("core/xhr-errors",["require","exports","module","i18n"],function(e,t,n){"use strict";var i=e("i18n"),r={_hasStatus:function(e,t){return e&&t===e.status},_isBadRequest:function(e){return this._hasStatus(e,400)},_isUnauthorized:function(e){return this._hasStatus(e,401)},_isForbidden:function(e){return this._hasStatus(e,403)},_isNotFound:function(e){return this._hasStatus(e,404)},_isMethodNotAllowed:function(e){return this._hasStatus(e,405)},_isTooManyRequests:function(e){return this._hasStatus(e,429)},_isInternalServerError:function(e){return this._hasStatus(e,500)},_getErrorTitle:function(e){return this._isBadRequest(e)||this._isMethodNotAllowed(e)?i.gettext("Invalid request"):this._isUnauthorized(e)?i.gettext("Unauthorized"):this._isForbidden(e)?i.gettext("Not allowed"):this._isNotFound(e)?i.gettext("Not found"):this._isTooManyRequests(e)?i.gettext("Too many requests"):i.gettext("Oops!")},_getErrorMessage:function(e){return this._isBadRequest(e)||this._isMethodNotAllowed(e)?i.gettext("Your request is invalid and can't be processed."):this._isUnauthorized(e)?i.gettext("You need to log in to send this request."):this._isForbidden(e)?i.gettext("You are not allowed to send this request."):this._isNotFound(e)?i.gettext("The resource you requested could not be found."):this._isTooManyRequests(e)?i.gettext("Please try again later."):i.gettext("An error prevented your request from being processed. Please try again.")}};n.exports=r}),define("core/model",["require","exports","module","underscore","jquery","thorax","core/xhr-errors"],function(e,t,n){"use strict";var i=e("underscore"),r=e("jquery"),s=e("thorax"),o=e("core/xhr-errors"),a={_setAuthentication:function(e){var t,n,i;(t=r.cookie("access_token"))&&(n=JSON.parse(t),i=n.accessToken,e.setRequestHeader("Authorization","Bearer ".concat(i)))}};i.extend(a,o),n.exports=s.Model.extend(a)}),define("core/dialogs/base-dialog",["require","exports","module","thorax"],function(e,t,n){"use strict";var i=e("thorax");n.exports=i.View.extend({})}),define("hbs",["handlebars"],function(e){var t={};return{load:function(n,i,r,s){var o=s.hbs&&s.hbs.templateExtension?s.hbs.templateExtension:".hbs";if(s.isBuild){var a=nodeRequire("fs"),l=s.dirBaseUrl+"/"+n+o;t[n]=a.readFileSync(l).toString(),r()}else i(["text!"+n+o],function(t){r(e.compile(t))})},write:function(n,i,r){r("define('hbs!"+i+"', ['handlebars'], function(Handlebars){ \nreturn Handlebars.template("+e.precompile(t[i]).toString()+");\n});\n")}}}),define("hbs!core/dialogs/templates/error-dialog",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r,s="";return r=t.if.call(e,null!=e?e.errorDetails:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.program(4,i),data:i}),null!=r&&(s+=r),s},2:function(e,t,n,i){var r,s=t.helperMissing;return'        <div class="error-details">\n            <p>'+(0,this.escapeExpression)((r=null!=(r=t.detailedErrorMessage||(null!=e?e.detailedErrorMessage:e))?r:s,"function"==typeof r?r.call(e,{name:"detailedErrorMessage",hash:{},data:i}):r))+"</p>\n        </div>\n"},4:function(e,t,n,i){var r=t.helperMissing;return'        <p><a href="#" class="show-error-details">'+(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Show error details",{name:"gettext",hash:{},data:i}))+"</a></p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l='<div class="modal-header">\n    <h4 class="modal-title">'+a((s=null!=(s=t.errorTitle||(null!=e?e.errorTitle:e))?s:o,"function"==typeof s?s.call(e,{name:"errorTitle",hash:{},data:i}):s))+'</h4>\n    <button type="button" class="close" data-dismiss="modal" aria-label="'+a((t.gettext||e&&e.gettext||o).call(e,"Close",{name:"gettext",hash:{},data:i}))+'"><span aria-hidden="true">&times;</span></button>\n</div>\n<div class="modal-body">\n    <p>'+a((s=null!=(s=t.errorMessage||(null!=e?e.errorMessage:e))?s:o,"function"==typeof s?s.call(e,{name:"errorMessage",hash:{},data:i}):s))+"</p>\n";return r=t.if.call(e,null!=e?e.detailedErrorMessage:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+'</div>\n<div class="modal-footer">\n    <button type="button" class="btn btn-primary btn-lg btn-lg--wide" data-dismiss="modal">'+a((t.gettext||e&&e.gettext||o).call(e,"OK",{name:"gettext",hash:{},data:i}))+"</button>\n</div>\n"},useData:!0})}),define("core/dialogs/error-dialog",["require","exports","module","core/model","core/dialogs/base-dialog","hbs!core/dialogs/templates/error-dialog"],function(e,t,n){"use strict";var i=e("core/model"),r=e("core/dialogs/base-dialog"),s=e("hbs!core/dialogs/templates/error-dialog"),o=r.extend({className:"error-dialog",template:s,animate:!0,events:{"click .show-error-details":"_showErrorDetails"},_showErrorDetails:function(e){return e.preventDefault(),this.model.set("errorDetails",!0),!1},_getDetailedErrorMessage:function(e){return e.responseJSON?e.responseJSON.error+": "+e.responseJSON.errorMessage:null},setContent:function(e){this.setModel(new i(e)),e.response&&this.model.set("detailedErrorMessage",this._getDetailedErrorMessage(e.response))}});n.exports=o}),function(e){"function"==typeof define&&define.amd?define("jquery.cookie",["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){function t(e){return a.raw?e:encodeURIComponent(e)}function n(e){return a.raw?e:decodeURIComponent(e)}function i(e){return t(a.json?JSON.stringify(e):String(e))}function r(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(o," ")),a.json?JSON.parse(e):e}catch(e){}}function s(t,n){var i=a.raw?t:r(t);return e.isFunction(n)?n(i):i}var o=/\+/g,a=e.cookie=function(r,o,l){if(void 0!==o&&!e.isFunction(o)){if(l=e.extend({},a.defaults,l),"number"==typeof l.expires){var c=l.expires,u=l.expires=new Date;u.setTime(+u+864e5*c)}return document.cookie=[t(r),"=",i(o),l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join("")}for(var d=r?void 0:{},h=document.cookie?document.cookie.split("; "):[],p=0,f=h.length;p<f;p++){var m=h[p].split("="),g=n(m.shift()),v=m.join("=");if(r&&r===g){d=s(v,o);break}r||void 0===(v=s(v))||(d[g]=v)}return d};a.defaults={},e.removeCookie=function(t,n){return void 0!==e.cookie(t)&&(e.cookie(t,"",e.extend({},n,{expires:-1})),!e.cookie(t))}}),define("core/user/models/sessionModel",["require","exports","module","underscore","jquery","appPubSubTopics","pubsub","env","core/model","app-config","jquery.cookie"],function(e,t,n){"use strict";var i=e("underscore"),r=e("jquery"),s=e("appPubSubTopics"),o=e("pubsub"),a=e("env"),l=e("core/model"),c=e("app-config");e("jquery.cookie");var u=l.extend({pubSub:o,_loginSuccess:function(e,t,n,i){var o=t.accessToken;this.setAccessToken(JSON.stringify(t)),this.set("accessToken",o,{silent:!0}),r.cookie(u.USERNAME_COOKIE_NAME,e.toLowerCase(),this._getCookieOptions()),this.pubSub.publish(s.AUTH_SUCCESS,{accessToken:o})},_loginError:function(e,t,n){this.pubSub.publish(s.AUTH_ERROR,{response:e})},isAuthenticated:function(){return!!this.getAccessToken()},setAccessToken:function(e){return r.cookie(u.ACCESS_TOKEN_COOKIE_NAME,e,this._getCookieOptions())},getAccessToken:function(){return r.cookie(u.ACCESS_TOKEN_COOKIE_NAME)},login:function(e){return r.ajax({type:"POST",url:a.getEndpoint("auth"),data:JSON.stringify(e),processData:!1,contentType:"application/json; charset=utf-8"}).done(i.bind(this._loginSuccess,this,e.username)).fail(i.bind(this._loginError,this))},logout:function(){this.unset("accessToken",{silent:!0}),r.removeCookie(u.ACCESS_TOKEN_COOKIE_NAME,{path:"/"}),r.removeCookie(u.USERNAME_COOKIE_NAME,{path:"/"})},getUsername:function(){var e=r.cookie(u.USERNAME_COOKIE_NAME);return e&&decodeURI(e)},_getCookieOptions:function(){var e={path:"/"};return c.secureCookies&&(e.secure=!0),e}}),d=null;u.getInstance=function(){return d||(d=new u({})),d},u.ACCESS_TOKEN_COOKIE_NAME="access_token",u.USERNAME_COOKIE_NAME="session_username",n.exports=u}),define("core/collection",["require","exports","module","underscore","jquery","thorax","core/xhr-errors"],function(e,t,n){"use strict";var i=e("underscore"),r=e("jquery"),s=e("thorax"),o=e("core/xhr-errors"),a={_setAuthentication:function(e){var t,n,i;(t=r.cookie("access_token"))&&(n=JSON.parse(t),i=n.accessToken,e.setRequestHeader("Authorization","Bearer ".concat(i)))}};i.extend(a,o),n.exports=s.Collection.extend(a)}),define("core/user/profile/collections/profilesCollection",["require","exports","module","env","core/collection"],function(e,t,n){"use strict";var i=e("env"),r=e("core/collection"),s=r.extend({url:void 0,initialize:function(e,t){this.url=i.getEndpoint("userProfiles",{agent:t.agent})}});n.exports=s}),define("packages/parental-consent/models/consentModel",["require","exports","module","underscore","env","core/model"],function(e,t,n){"use strict";var i=e("underscore"),r=e("env"),s=e("core/model"),o=s.extend({defaults:{},initialize:function(){this.url=r.getEndpoint("consent")},fetchConsent:function(){return this.fetch({beforeSend:i.bind(this._setAuthentication,this)})},parse:function(e){if(i.isObject(e))return e;this.set("legislation",!0===e?"COPPA":null)},requiresConsent:function(){return this.get("legislation")}}),a=null;o.getInstance=function(){return a||(a=new o({})),a},n.exports=o}),define("core/user/models/userModel",["require","exports","module","underscore","jquery","i18n","app-config","env","pubsub","appPubSubTopics","moment","core/analytics","core/model","core/dialogs/error-dialog","core/user/models/sessionModel","core/user/profile/collections/profilesCollection","packages/parental-consent/models/consentModel"],function(e,t,n){"use strict";var i=e("underscore"),r=e("jquery"),s=e("i18n"),o=e("app-config"),a=e("env"),l=e("pubsub"),c=e("appPubSubTopics"),u=e("moment"),d=e("core/analytics"),h=e("core/model"),p=e("core/dialogs/error-dialog"),f=e("core/user/models/sessionModel"),m=e("core/user/profile/collections/profilesCollection"),g=e("packages/parental-consent/models/consentModel"),v=h.extend({_fetch:h.prototype.fetch,fetch:function(){},pubSub:l,url:null,defaults:{},initialize:function(){o.user&&o.user.countryCode&&(this.set("countryCode",o.user.countryCode),this.countryCode=o.user.countryCode),this._setEndpointUrl(),this._bindEvents()},_setDisplayName:function(e){!e.get("displayName")&&r.cookie("session_username")&&e.set("displayName",r.cookie("session_username"))},_setEndpointUrl:function(){this.url=a.getEndpoint("user")},_bindEvents:function(){f.getInstance().on("change:accessToken",i.bind(this._onAccessTokenChange,this)),this.on("sync",function(e){this._setDisplayName(e),this.pubSub.publish(c.USER_ATTRIBUTES_CHANGED,this),this._sendDimensionAnalytics(e)})},_sendDimensionAnalytics:function(e){d.dimension("Age",e.getAge().toString())},_fetchUser:function(){return this._fetch({beforeSend:i.bind(this._setAuthentication,this),error:i.bind(this._onFetchError,this)})},_fetchParentalConsent:function(){var e=g.getInstance();return e.on("error",this._onFetchConsentError,this),e.fetchConsent()},_onAccessTokenChange:function(e){this.loadUserInfo()},_publishFetchError:function(e,t,n){var i=new p;i.setContent({errorTitle:e,errorMessage:t,response:n}),this.pubSub.publish(c.SHOW_MODAL,{view:i,label:t})},_onFetchError:function(e,t){this._isUnauthorized(t)?this.pubSub.publish(c.USER_UNAUTHORIZED,t):this._publishFetchError(this._getFetchUserErrorTitle(t),this._getFetchUserErrorMessage(t),t)},_onFetchConsentError:function(e,t){!this._isUnauthorized(t)&&this.isAuthenticated()&&this._publishFetchError(this._getFetchConsentErrorTitle(t),this._getFetchConsentErrorMessage(t),t)},_getFetchUserErrorTitle:function(e){return s.gettext("Authentication failed")},_getFetchUserErrorMessage:function(e){return s.gettext("We could not authenticate you against our servers. Please try to log out and then log back in again.")},_getFetchConsentErrorTitle:function(e){return s.gettext("An error occurred")},_getFetchConsentErrorMessage:function(e){return s.gettext("An error occurred while validating your account. Please try to log out and then log back in again.")},loadUserInfo:function(){var e=this;return this._fetchUser().then(function(){return e.loadParentalConsent()})},loadParentalConsent:function(){return this._fetchParentalConsent()},isAuthenticated:function(){return f.getInstance().isAuthenticated()},isRegistered:function(){return!i.isEmpty(this.id)},isHashed:function(){return this.get("hashed")},isEmailVerified:function(){return this.get("emailVerified")},isLegacyUser:function(){return this.get("legacyUser")},isSecured:function(){return this.get("secured")},getEmail:function(){return this.get("email")},getUserId:function(){return this.get("id")},getLocale:function(){return this.get("locale")||o.user.locale||"en"},getLanguageTag:function(){var e=this.getLocale(),t=e.split("-");return t&&t.length>1?t[0]+"-"+t[1].toUpperCase():e},getAge:function(){var e=this.get("dateOfBirth");return u().diff(e,"years")},doesNeedParentalConsent:function(){return g.getInstance().requiresConsent()},loadProfiles:function(){var e=this,t=new m(null,{agent:o.productAgent});return t.fetch({beforeSend:i.bind(this._setAuthentication,this),success:function(n,i,r){e.set("profiles",t)}})}}),y=null;v.getInstance=function(){return y||(y=new v),y},n.exports=v}),define("core/user/controllers/userController",["require","exports","module","jquery","underscore","app-config","appPubSubTopics","core/controller","core/user/models/userModel","core/user/models/sessionModel"],function(e,t,n){"use strict";var i=e("jquery"),r=e("underscore"),s=e("app-config"),o=e("appPubSubTopics"),a=e("core/controller"),l=e("core/user/models/userModel"),c=e("core/user/models/sessionModel"),u=a.extend({_userModel:null,_sessionModel:null,initialize:function(e){this._userModel=l.getInstance(),this._sessionModel=c.getInstance(),this.initSubscribers()},initSubscribers:function(){this.pubSub.subscribe(o.USER_LOGIN,r.bind(this._onLoginUser,this)),this.pubSub.subscribe(o.USER_UNAUTHORIZED,r.bind(this._onLogoutUser,this)),this.pubSub.subscribe(o.USER_UPDATE_REQUESTED,r.bind(this._updateUserRequested,this))},getUser:function(){return this._userModel},_performLogin:function(e,t,n){var i={username:e,password:t,requestUser:!0};return s.reCaptcha&&n&&(i.captcha=n,i.captchaSupported="InvisibleReCAPTCHA"),this._sessionModel.login(i)},_onLoginUser:function(e,t){var n=this.pubSub,i=this._userModel;r.isEmpty(t)||this._performLogin(t.email,t.password,t.captcha).then(r.bind(i.loadUserInfo,i)).then(function(){i.get("countryCode")||i.set("countryCode",i.countryCode),r.isFunction(t.successfulLoginCallback)&&t.successfulLoginCallback.call(null,t.email),r.isFunction(s.events)&&s.events.call(null,{name:"login"}),n.publish(o.LOGIN_SUCCESS,{})})},_onLogoutUser:function(){this._userModel.clear(),this._userModel=l.getInstance(),this._sessionModel.logout()},_updateUserRequested:function(e,t){i.when(this._userModel.loadUserInfo(),this._userModel.loadParentalConsent()).always(function(){r.isFunction(t.successfulUpdateCallback)&&t.successfulUpdateCallback.call()})}});n.exports=u}),define("core/helpers",["require","exports","module","underscore","handlebars","i18n","thorax","app-config"],function(e,t,n){"use strict";function i(e){return"string"==typeof e||e instanceof String||e instanceof s.SafeString?s.Utils.escapeExpression(e):e}var r=e("underscore"),s=e("handlebars"),o=e("i18n"),a=(e("thorax"),e("app-config"));s.registerHelper("gettext",function(e){return o.gettext(e)}),s.registerHelper("gettext_block",function(){var e,t=Array.prototype.slice.call(arguments),n=t.splice(-1)[0];return!!r.isObject(n)&&(e=o.gettext(n.fn(this)),o.sprintf(e,r.map(t,i)))}),s.registerHelper("href",function(e,t){return'<a href="'+a[t]+'">'+s.compile(e)+"</a>"}),s.registerHelper("ngettext",function(e,t,n){return o.ngettext(e,t,n)}),s.registerHelper("gettext_noop",function(e){return o.gettext_noop(e)}),s.registerHelper("pgettext",function(e,t){return o.pgettext(e,t)}),s.registerHelper("npgettext",function(e,t,n,i){return o.npgettext(e,t,n,i)}),s.registerHelper("encodeuri",function(e){return encodeURIComponent(e)}),s.registerHelper("decodeuri",function(e){return decodeURIComponent(e)}),s.registerHelper("ellipsis",function(e,t,n){r.isUndefined(n)&&(n="");var i=e.replace(/(<([^>]+)>)/g,"");return i.length>t?i.substr(0,t-n.length)+n:i}),s.registerHelper("safe",function(e){return new s.SafeString(e)}),s.registerHelper("greeting",function(){return new s.SafeString("Hello World")}),s.registerViewHelper("on",function(e,t){t.parent.on(e,function(){t.render()})})}),function(e){"function"==typeof define&&define.amd?define("backbone.stickit",["underscore","backbone","exports"],e):"object"==typeof exports?e(require("underscore"),require("backbone"),exports):e(_,Backbone,{})}(function(e,t,n){n._handlers=[],n.addHandler=function(t){t=e.map(e.flatten([t]),function(t){return e.extend({updateModel:!0,updateView:!0,updateMethod:"text"},t)}),this._handlers=this._handlers.concat(t)},n.ViewMixin={_modelBindings:null,unstickit:function(t,n){if(e.isObject(n))return void e.each(e.keys(n),function(e){this.unstickit(t,e)},this);var i=[],r=[];e.each(this._modelBindings,function(e,s){t&&e.model!==t||n&&e.config.selector!=n||(r.push(e.config._destroy),e.model.off(e.event,e.fn),i.push(e.model),delete this._modelBindings[s])},this),e.invoke(e.uniq(i),"trigger","stickit:unstuck",this.cid),e.each(e.uniq(r),function(e){e.call(this)},this),this._modelBindings=e.compact(this._modelBindings),this.$el.off(".stickit"+(t?"."+t.cid:""),n)},stickit:function(t,n){var i=t||this.model,r=n||e.result(this,"bindings")||{};this._modelBindings||(this._modelBindings=[]),this.addBinding(i,r);var s=this.remove;s.stickitWrapped||(this.remove=function(){var e=this;return this.unstickit(),s&&(e=s.apply(this,arguments)),e}),this.remove.stickitWrapped=!0},addBinding:function(t,n,i){var s,f,m,g,v,y=t||this.model,b=".stickit."+y.cid,_=i||{},w=e.uniqueId();if(!e.isString(n)){var x=n;return void e.each(x,function(e,t){this.addBinding(y,t,x[t])},this)}v=n,s=":el"===v?this.$el:this.$(v),this.unstickit(y,v),s.length&&(e.isString(_)&&(_={observe:_}),e.isFunction(_.observe)&&(_.observe=_.observe.call(this)),g=u(s,_),g.selector=v,m=g.observe,g.bindId=w,g.view=this,f=e.extend({stickitChange:g},g.setOptions),g._destroy=function(){r(this,g.destroy,s,y,g)},d(this,s,g,y,m),h(this,s,g,y,m),m&&(e.each(g.events,function(t){var n=t+b,i=function(t){var n=g.getVal.call(this,s,t,g,e.rest(arguments));o(this,g.updateModel,n,t,g)&&l(y,m,n,f,this,g)};i=e.bind(i,this),":el"===v?this.$el.on(n,i):this.$el.on(n,v,i)},this),e.each(e.flatten([m]),function(e){a(y,this,"change:"+e,g,function(e,t,n){(n&&n.stickitChange&&n.stickitChange.bindId||null)!==w&&p(this,s,g,c(e,m,g,this),e)})},this),p(this,s,g,c(y,m,g,this),y,!0)),r(this,g.initialize,s,y,g))}},e.extend(t.View.prototype,n.ViewMixin);var i=function(t,n){var i=(n||"").split("."),r=e.reduce(i,function(e,t){return e[t]},t);return null==r?t:r},r=function(t,n){if(n)return(e.isString(n)?i(t,n):n).apply(t,e.rest(arguments,2))},s=function(e){return e.find("option").not(function(){return!this.selected})},o=function(t,n){return e.isBoolean(n)?n:!(!e.isFunction(n)&&!e.isString(n))&&r.apply(this,arguments)},a=function(e,t,n,i,r){e.on(n,r,t),t._modelBindings.push({model:e,event:n,fn:r,config:i})},l=function(t,n,i,s,o,a){var l={};a.onSet&&(i=r(o,a.onSet,i,a)),a.set?r(o,a.set,n,i,s,a):(l[n]=i,e.isArray(n)&&e.isArray(i)&&(l=e.reduce(n,function(t,n,r){return t[n]=e.has(i,r)?i[r]:null,t},{})),t.set(l,s))},c=function(t,n,i,s){var o,a=function(e){return t[i.escape?"escape":"get"](e)},l=function(e){return null==e?"":e};return o=e.isArray(n)?e.map(n,a):a(n),i.onGet&&(o=r(s,i.onGet,o,i)),e.isArray(o)?e.map(o,l):l(o)},u=n.getConfiguration=function(t,i){var r=[{updateModel:!1,updateMethod:"text",update:function(e,t,n,i){e[i.updateMethod]&&e[i.updateMethod](t)},getVal:function(e,t,n){return e[n.updateMethod]()}}];r=r.concat(e.filter(n._handlers,function(e){return t.is(e.selector)})),r.push(i);var s=e.extend.apply(e,r);return s.visible&&!e.has(s,"updateView")?s.updateView=!1:e.has(s,"updateView")||(s.updateView=!0),s},d=function(t,n,i,r,s){var o=["autofocus","autoplay","async","checked","controls","defer","disabled","hidden","indeterminate","loop","multiple","open","readonly","required","scoped","selected"];e.each(i.attributes||[],function(l){var u,d,h="";l=e.clone(l),u=l.observe||(l.observe=s),d=function(){var i=e.indexOf(o,l.name,!0)>-1?"prop":"attr",s=c(r,u,l,t);"class"===l.name?(n.removeClass(h).addClass(s),h=s):n[i](l.name,s)},e.each(e.flatten([u]),function(e){a(r,t,"change:"+e,i,d)}),d()})},h=function(t,n,i,s,o){if(null!=i.visible){var l=function(){var a=i.visible,l=i.visibleFn,u=c(s,o,i,t),d=!!u;(e.isFunction(a)||e.isString(a))&&(d=!!r(t,a,u,i)),l?r(t,l,n,d,i):n.toggle(d)};e.each(e.flatten([o]),function(e){a(s,t,"change:"+e,i,l)}),l()}},p=function(e,t,n,i,s,a){o(e,n.updateView,i,n)&&(r(e,n.update,t,i,s,n),a||r(e,n.afterUpdate,t,i,n))};return n.addHandler([{selector:'[contenteditable="true"]',updateMethod:"html",events:["input","change"]},{selector:"input",events:["propertychange","input","change"],update:function(e,t){e.val(t)},getVal:function(e){return e.val()}},{selector:"textarea",events:["propertychange","input","change"],update:function(e,t){e.val(t)},getVal:function(e){return e.val()}},{selector:'input[type="radio"]',events:["change"],update:function(e,t){e.filter('[value="'+t+'"]').prop("checked",!0)},getVal:function(e){return e.filter(":checked").val()}},{selector:'input[type="checkbox"]',events:["change"],update:function(n,i,r,s){if(n.length>1)i||(i=[]),n.each(function(n,r){var s=t.$(r),o=e.indexOf(i,s.val())>-1;s.prop("checked",o)});else{var o=e.isBoolean(i)?i:i===n.val();n.prop("checked",o)}},getVal:function(n){var i;if(n.length>1)i=e.reduce(n,function(e,n){var i=t.$(n);return i.prop("checked")&&e.push(i.val()),e},[]);else{i=n.prop("checked");var r=n.val();"on"!==r&&null!=r&&(i=i?n.val():null)}return i}},{selector:"select",events:["change"],update:function(n,s,o,a){var l,c=a.selectOptions,u=c&&c.collection||void 0,d=n.prop("multiple");if(!c){c={};var h=function(e){return e.map(function(){return{value:this.value,label:this.text}}).get()};n.find("optgroup").length?(u={opt_labels:[]},n.find("> option").length&&(u.opt_labels.push(void 0),e.each(n.find("> option"),function(e){u[void 0]=h(t.$(e))})),e.each(n.find("optgroup"),function(e){var n=t.$(e).attr("label");u.opt_labels.push(n),u[n]=h(t.$(e).find("option"))})):u=h(n.find("option"))}c.valuePath=c.valuePath||"value",c.labelPath=c.labelPath||"label";var p=function(n,r,s){e.each(n,function(n){var o=t.$("<option/>"),a=n,l=function(t,n){o.text(t),a=n,o.data("stickit_bind_val",a),e.isArray(a)||e.isObject(a)||o.val(a)};"__default__"===n?l(c.defaultOption.label,c.defaultOption.value):l(i(n,c.labelPath),i(n,c.valuePath)),!d&&null!=a&&null!=s&&a===s||e.isObject(s)&&e.isEqual(a,s)?o.prop("selected",!0):d&&e.isArray(s)&&e.each(s,function(t){e.isObject(t)&&(t=i(t,c.valuePath)),(t===a||e.isObject(t)&&e.isEqual(a,t))&&o.prop("selected",!0)}),r.append(o)})};n.find("*").remove();if(l=e.isString(u)?function(e,t){var n=window;return 0===t.indexOf("this.")&&(n=e),t=t.replace(/^[a-z]*\.(.+)$/,"$1"),i(n,t)}(this,u):e.isFunction(u)?r(this,u,n,a):u,l instanceof t.Collection&&(l=l.toJSON()),c.defaultOption&&p(["__default__"],n),e.isArray(l))p(l,n,s);else if(l.opt_labels)e.each(l.opt_labels,function(e){var i=t.$("<optgroup/>").attr("label",e);p(l[e],i,s),n.append(i)});else{var f,m=[];for(var g in l)f={},f[c.valuePath]=g,f[c.labelPath]=l[g],m.push(f);p(e.sortBy(m,c.comparator||c.labelPath),n,s)}},getVal:function(e){return e.prop("multiple")?t.$(s(e).map(function(){return t.$(this).data("stickit_bind_val")})).get():s(e).data("stickit_bind_val")}}]),t.Stickit=n,t.Stickit}),function(e){"object"==typeof exports?module.exports=e(require("backbone"),require("underscore")):"function"==typeof define&&define.amd&&define("backbone-validation",["backbone","underscore"],e)}(function(e,t){return e.Validation=function(e){"use strict";var t={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},n={formatLabel:function(e,n){return l[t.labelFormatter](e,n)},format:function(){var e=Array.prototype.slice.call(arguments);return e.shift().replace(/\{(\d+)\}/g,function(t,n){return void 0!==e[n]?e[n]:t})}},i=function(t,n,r){return n=n||{},r=r||"",e.each(t,function(e,s){t.hasOwnProperty(s)&&(e&&"object"==typeof e&&e.constructor===Object?i(e,n,r+s+"."):n[r+s]=e)}),n},r=function(){var r=function(t){return e.reduce(e.keys(e.result(t,"validation")||{}),function(e,t){return e[t]=void 0,e},{})},o=function(t,n){var i=t.validation?e.result(t,"validation")[n]||{}:{};return(e.isFunction(i)||e.isString(i))&&(i={fn:i}),e.isArray(i)||(i=[i]),e.reduce(i,function(t,n){return e.each(e.without(e.keys(n),"msg"),function(e){t.push({fn:c[e],val:n[e],msg:n.msg})}),t},[])},a=function(t,i,r,s){return e.reduce(o(t,i),function(o,a){var l=e.extend({},n,c),u=a.fn.call(l,r,i,a.val,t,s);return!1!==u&&!1!==o&&(u&&!o?e.result(a,"msg")||u:o)},"")},l=function(t,n){var r,s={},o=!0,l=e.clone(n),c=i(n);return e.each(c,function(e,n){(r=a(t,n,e,l))&&(s[n]=r,o=!1)}),{invalidAttrs:s,isValid:o}},u=function(t,n){return{preValidate:function(t,n){var i,r=this,s={};return e.isObject(t)?(e.each(t,function(e,t){(i=r.preValidate(t,e))&&(s[t]=i)}),e.isEmpty(s)?void 0:s):a(this,t,n,e.extend({},this.attributes))},isValid:function(t){var n=i(this.attributes);return e.isString(t)?!a(this,t,n[t],e.extend({},this.attributes)):e.isArray(t)?e.reduce(t,function(t,i){return t&&!a(this,i,n[i],e.extend({},this.attributes))},!0,this):(!0===t&&this.validate(),!this.validation||this._isValid)},validate:function(s,o){var a=this,c=!s,u=e.extend({},n,o),d=r(a),h=e.extend({},d,a.attributes,s),p=i(s||h),f=l(a,h);if(a._isValid=f.isValid,e.each(d,function(e,n){f.invalidAttrs.hasOwnProperty(n)||u.valid(t,n,u.selector)}),e.each(d,function(e,n){var i=f.invalidAttrs.hasOwnProperty(n),r=p.hasOwnProperty(n);i&&(r||c)&&u.invalid(t,n,f.invalidAttrs[n],u.selector)}),e.defer(function(){a.trigger("validated",a._isValid,a,f.invalidAttrs),a.trigger("validated:"+(a._isValid?"valid":"invalid"),a,f.invalidAttrs)}),!u.forceUpdate&&e.intersection(e.keys(f.invalidAttrs),e.keys(p)).length>0)return f.invalidAttrs}}},d=function(t,n,i){e.extend(n,u(t,i))},h=function(e){delete e.validate,delete e.preValidate,delete e.isValid},p=function(e){d(this.view,e,this.options)},f=function(e){h(e)};return{version:"0.9.1",configure:function(n){e.extend(t,n)},bind:function(n,i){i=e.extend({},t,s,i);var r=i.model||n.model,o=i.collection||n.collection;if(void 0===r&&void 0===o)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";r?d(n,r,i):o&&(o.each(function(e){d(n,e,i)}),o.bind("add",p,{view:n,options:i}),o.bind("remove",f))},unbind:function(t,n){n=e.extend({},n);var i=n.model||t.model,r=n.collection||t.collection;i?h(i):r&&(r.each(function(e){h(e)}),r.unbind("add",p),r.unbind("remove",f))},mixin:u(null,t)}}(),s=r.callbacks={valid:function(e,t,n){e.$("["+n+'~="'+t+'"]').removeClass("invalid").removeAttr("data-error")},invalid:function(e,t,n,i){e.$("["+i+'~="'+t+'"]').addClass("invalid").attr("data-error",n)}},o=r.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},a=r.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",digits:"{0} must only contain digits",number:"{0} must be a number",email:"{0} must be a valid email",url:"{0} must be a valid url",inlinePattern:"{0} is invalid"},l=r.labelFormatters={none:function(e){return e},sentenceCase:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toUpperCase():" "+e.toLowerCase()}).replace(/_/g," ")},label:function(e,t){return t.labels&&t.labels[e]||l.sentenceCase(e,t)}},c=r.validators=function(){var t=String.prototype.trim?function(e){return null===e?"":String.prototype.trim.call(e)}:function(e){var t=/^\s+/,n=/\s+$/;return null===e?"":e.toString().replace(t,"").replace(n,"")},n=function(t){return e.isNumber(t)||e.isString(t)&&t.match(o.number)},i=function(n){return!(e.isNull(n)||e.isUndefined(n)||e.isString(n)&&""===t(n)||e.isArray(n)&&e.isEmpty(n))};return{fn:function(t,n,i,r,s){return e.isString(i)&&(i=r[i]),i.call(r,t,n,s)},required:function(t,n,r,s,o){var l=e.isFunction(r)?r.call(s,t,n,o):r;return!(!l&&!i(t))&&(l&&!i(t)?this.format(a.required,this.formatLabel(n,s)):void 0)},acceptance:function(t,n,i,r){
if("true"!==t&&(!e.isBoolean(t)||!1===t))return this.format(a.acceptance,this.formatLabel(n,r))},min:function(e,t,i,r){if(!n(e)||e<i)return this.format(a.min,this.formatLabel(t,r),i)},max:function(e,t,i,r){if(!n(e)||e>i)return this.format(a.max,this.formatLabel(t,r),i)},range:function(e,t,i,r){if(!n(e)||e<i[0]||e>i[1])return this.format(a.range,this.formatLabel(t,r),i[0],i[1])},length:function(t,n,i,r){if(!e.isString(t)||t.length!==i)return this.format(a.length,this.formatLabel(n,r),i)},minLength:function(t,n,i,r){if(!e.isString(t)||t.length<i)return this.format(a.minLength,this.formatLabel(n,r),i)},maxLength:function(t,n,i,r){if(!e.isString(t)||t.length>i)return this.format(a.maxLength,this.formatLabel(n,r),i)},rangeLength:function(t,n,i,r){if(!e.isString(t)||t.length<i[0]||t.length>i[1])return this.format(a.rangeLength,this.formatLabel(n,r),i[0],i[1])},oneOf:function(t,n,i,r){if(!e.include(i,t))return this.format(a.oneOf,this.formatLabel(n,r),i.join(", "))},equalTo:function(e,t,n,i,r){if(e!==r[n])return this.format(a.equalTo,this.formatLabel(t,i),this.formatLabel(n,i))},pattern:function(e,t,n,r){if(!i(e)||!e.toString().match(o[n]||n))return this.format(a[n]||a.inlinePattern,this.formatLabel(t,r),n)}}}();return e.each(c,function(t,i){c[i]=e.bind(c[i],e.extend({},n,c))}),r}(t),e.Validation}),define("core/layout-view",["require","exports","module","thorax","core/analytics","pubsub"],function(e,t,n){"use strict";var i=e("thorax"),r=e("core/analytics"),s=e("pubsub");n.exports=i.LayoutView.extend({analytics:r,pubSub:s})}),define("hbs!packages/modal-dialog/templates/modalDialog",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r=t.helperMissing;return'<div class="modal-dialog">\n  '+(0,this.escapeExpression)((t["layout-element"]||e&&e["layout-element"]||r).call(e,{name:"layout-element",hash:{class:"modal-content",tag:"div"},data:i}))+"\n</div>\n"},useData:!0})}),define("packages/modal-dialog/views/modalDialogView",["require","exports","module","core/layout-view","hbs!packages/modal-dialog/templates/modalDialog"],function(e,t,n){"use strict";var i,r=e("core/layout-view"),s=e("hbs!packages/modal-dialog/templates/modalDialog"),o=r.extend({id:"modal-dialog",className:"modal",template:s,initialize:function(e){}});o.getInstance=function(e,t){return i||(i=new o(t),i.appendTo(e||document.body)),i},n.exports=o}),define("packages/modal-dialog/controllers/modalDialogController",["require","exports","module","underscore","appPubSubTopics","core/analytics","core/controller"],function(e,t,n){"use strict";var i=e("underscore"),r=e("appPubSubTopics"),s=e("core/analytics"),o=e("core/controller"),a=o.extend({initialize:function(e){this._view=e.view,this._target="#"+this._view.id,this.initSubscribers()},show:function(e,t){var n,r,o,a,l={backdrop:"static",keyboard:!0};n=this,o=t.view,a=i.extend({},l,t.options),(r=this._view.getView())&&!o.force||(o.animate?this._view.$el.addClass("fade"):this._view.$el.removeClass("fade"),this._view.setView(o),$(this._target).modal(a),$(this._target).on("hidden.bs.modal",function(e){n.removeView()}),t.label&&s.event("Modal","Show",t.label))},removeView:function(){this._view.setView()},hide:function(){$(this._target).modal("hide")},initSubscribers:function(){this.pubSub.subscribe(r.SHOW_MODAL,i.bind(this.show,this)),this.pubSub.subscribe(r.HIDE_MODAL,i.bind(this.hide,this))}});n.exports=a}),define("packages/modal-dialog/main",["require","exports","module","packages/modal-dialog/views/modalDialogView","packages/modal-dialog/controllers/modalDialogController"],function(e,t,n){"use strict";var i=e("packages/modal-dialog/views/modalDialogView"),r=e("packages/modal-dialog/controllers/modalDialogController"),s={};s.start=function(e){var t=i.getInstance(e);new r({view:t})},n.exports=s}),define("hbs!core/templates/layouts/root",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing;return(0,this.escapeExpression)((r=null!=(r=t["layout-element"]||(null!=e?e["layout-element"]:e))?r:s,"function"==typeof r?r.call(e,{name:"layout-element",hash:{},data:i}):r))+"\n"},useData:!0})}),define("core/root-layout-view",["require","exports","module","jquery","core/layout-view","hbs!core/templates/layouts/root","core/helpers"],function(e,t,n){"use strict";var i=e("jquery"),r=e("core/layout-view"),s=e("hbs!core/templates/layouts/root");e("core/helpers");var o=r.extend({template:s,onLoad:function(e){i(e).find(".preloader").remove()}});n.exports=o}),define("packages/login/views/layouts/rootLayoutView",["require","exports","module","core/root-layout-view","app-config"],function(e,t,n){"use strict";var i,r=e("core/root-layout-view"),s=(e("app-config"),r.extend({onLoad:function(e){$(e).find(".preloader").remove()}}));s.getInstance=function(e){return i||(i=new s,i.onLoad(e),i.appendTo(e||document.body)),i},n.exports=s}),define("core/router",["require","exports","module","underscore","backbone","pubsub","core/user/models/userModel"],function(e,t,n){"use strict";var i=e("underscore"),r=e("backbone"),s=e("pubsub"),o=e("core/user/models/userModel");n.exports=r.Router.extend({pubSub:s,rootView:null,enableDefaultRoute:!1,initialize:function(e){i.extend(this,e),this.enableDefaultRoute&&this.route("","default",this.defaultAction)},setView:function(e){this.rootView.setView(e)},getView:function(){return this.rootView.getView()},_isUserAuthenticated:function(){return o.getInstance().isAuthenticated()},_navigateToNext:function(e,t){var n=e||"/";t?this.navigate(t,{trigger:!0}):window.location.href=n}})}),define("core/view",["require","exports","module","underscore","thorax","core/analytics","pubsub","appPubSubTopics","core/xhr-errors","core/dialogs/error-dialog"],function(e,t,n){"use strict";var i=e("underscore"),r=e("thorax"),s=e("core/analytics"),o=e("pubsub"),a=e("appPubSubTopics"),l=e("core/xhr-errors"),c=e("core/dialogs/error-dialog"),u={analytics:s,pubSub:o,show:function(){this.$el.show()},hide:function(){this.$el.hide()},publishError:function(e,t,n){var i=new c;i.setContent({errorTitle:e,errorMessage:t,response:n}),this.pubSub.publish(a.SHOW_MODAL,{view:i,label:t})},_sendValidationAnalytics:function(e,t){t.validate&&(t.once("validated",function(t,n,r){t||s.event("ValidationError",e,i.keys(r).join(", "))}),t.validate())}};i.extend(u,l),n.exports=r.View.extend(u)}),define("packages/login/models/loginModel",["require","exports","module","i18n","core/model"],function(e,t,n){"use strict";var i=e("i18n"),r=e("core/model"),s=r.extend({validation:{email:{required:!0,pattern:"email",msg:i.gettext("A valid email is required")},password:{required:!0}}});n.exports=s}),define("components/submit-button/views/submitButtonView",["require","exports","module","core/view"],function(e,t,n){"use strict";var i=e("core/view"),r=i.extend({tagName:"button",className:"btn btn-block",events:{rendered:function(){this.$el.attr("type","submit"),this.loadingText&&this.$el.attr("data-loading-text",this.loadingText)}},setLoading:function(){this.$el.button("loading")},setDisabled:function(){this.$el.is(":disabled")||this.$el.attr("disabled","disabled")},setEnabled:function(){this.$el.is(":disabled")&&this.$el.removeAttr("disabled")},reset:function(){this.$el.button("reset")}});n.exports=r}),define("components/recaptcha/views/reCaptchaView",["require","exports","module","jquery","core/view"],function(e,t,n){"use strict";var i=e("jquery"),r=e("core/view"),s=r.extend({tagName:"div",initialize:function(){var e=this,t=document.createElement("script");t.src="//www.google.com/recaptcha/api.js?onload=onGReCaptchaLoad&render=explicit",t.async=!0,t.defer=!0,document.body.appendChild(t),window.onGReCaptchaLoad=function(){e.grecaptcha=window.grecaptcha,e._renderCaptcha()}},_renderCaptcha:function(){this.config.callback=this._submit.bind(this),this.grecaptchaId=this.grecaptcha.render(this.$el[0],this.config)},_submit:function(){i("form",this.parent.$el).submit()},validate:function(){var e=""!==this.grecaptcha.getResponse(this.grecaptchaId);return e||this.grecaptcha.execute(this.grecaptchaId),e},reset:function(){this.grecaptcha.reset(this.grecaptchaId)}});n.exports=s}),define("hbs!components/error-message/templates/errorMessage",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r,s='  <div class="alert alert-danger" role="alert">\n';return r=t.if.call(e,null!=e?e.actionHref:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.program(7,i),data:i}),null!=r&&(s+=r),s+"  </div>\n"},2:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l="          <p>"+a((s=null!=(s=t.error||(null!=e?e.error:e))?s:o,"function"==typeof s?s.call(e,{name:"error",hash:{},data:i}):s))+' <a href="'+a((s=null!=(s=t.actionHref||(null!=e?e.actionHref:e))?s:o,"function"==typeof s?s.call(e,{name:"actionHref",hash:{},data:i}):s))+'">';return r=t.if.call(e,null!=e?e.actionText:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.program(5,i),data:i}),null!=r&&(l+=r),l+"</a></p>\n"},3:function(e,t,n,i){var r,s=t.helperMissing;return(0,this.escapeExpression)((r=null!=(r=t.actionText||(null!=e?e.actionText:e))?r:s,"function"==typeof r?r.call(e,{name:"actionText",hash:{},data:i}):r))},5:function(e,t,n,i){var r=t.helperMissing;return(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Learn more",{name:"gettext",hash:{},data:i}))},7:function(e,t,n,i){var r,s=t.helperMissing;return"        <p>"+(0,this.escapeExpression)((r=null!=(r=t.error||(null!=e?e.error:e))?r:s,"function"==typeof r?r.call(e,{name:"error",hash:{},data:i}):r))+"</p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s="";return r=t.if.call(e,null!=e?e.error:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(s+=r),s},useData:!0})}),define("components/error-message/views/errorMessageView",["require","exports","module","core/view","core/model","hbs!components/error-message/templates/errorMessage"],function(e,t,n){"use strict";var i=e("core/view"),r=e("core/model"),s=e("hbs!components/error-message/templates/errorMessage"),o=i.extend({model:null,template:s,initialize:function(e){this.model=new r},setMessage:function(e){this.model.set("error",e)},removeMessage:function(){this.model.set("error",null),this.removeActionLink()},setActionLink:function(e,t){this.model.set("actionHref",e),this.model.set("actionText",t)},removeActionLink:function(){this.model.set("actionHref",null),this.model.set("actionText",null)}});n.exports=o}),define("hbs!packages/login/templates/loginForm",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r=t.helperMissing;return(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Log in",{name:"gettext",hash:{},data:i}))},3:function(e,t,n,i){return""},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a='<form method="post" role="form">\n    '+o((t.view||e&&e.view||s).call(e,null!=e?e.formError:e,{name:"view",hash:{},data:i}))+'\n    <div class="form-group">\n        <label class="control-label" for="email">'+o((t.gettext||e&&e.gettext||s).call(e,"Email",{name:"gettext",hash:{},data:i}))+'</label>\n        <div>\n            <input class="form-control" id="email" maxlength="50" name="email" type="text">\n            <span class="help-block help-block--feedback hidden"></span>\n        </div>\n    </div>\n    <div class="form-group">\n        <label class="control-label" for="password">'+o((t.gettext||e&&e.gettext||s).call(e,"Password",{name:"gettext",hash:{},data:i}))+'</label>\n        <div>\n            <input class="form-control" id="password" name="password" type="password">\n            <span class="help-block help-block--feedback hidden"></span>\n        </div>\n    </div>\n    <div class="form-group">\n      ';return r=(t.view||e&&e.view||s).call(e,null!=e?e.submitButton:e,{name:"view",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+="\n      ",r=(t.view||e&&e.view||s).call(e,null!=e?e.reCaptcha:e,{name:"view",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+"\n    </div>\n</form>\n"},useData:!0})}),define("packages/login/views/components/loginFormView",["require","exports","module","underscore","backbone","i18n","appPubSubTopics","app-config","core/view","core/xhr-errors","packages/login/models/loginModel","components/submit-button/views/submitButtonView","components/recaptcha/views/reCaptchaView","components/error-message/views/errorMessageView","hbs!packages/login/templates/loginForm"],function(e,t,n){"use strict";var i=e("underscore"),r=e("backbone"),s=e("i18n"),o=e("appPubSubTopics"),a=e("app-config"),l=e("core/view"),c=e("core/xhr-errors"),u=e("packages/login/models/loginModel"),d=e("components/submit-button/views/submitButtonView"),h=e("components/recaptcha/views/reCaptchaView"),p=e("components/error-message/views/errorMessageView"),f=e("hbs!packages/login/templates/loginForm");r.Validation.configure({forceUpdate:!0});var m=l.extend(i.extend({},c,{template:f,model:null,submitButton:null,reCaptcha:null,formError:null,_pubsubListeners:null,bindings:{"[name=email]":{observe:"email",setOptions:{validate:!0,silent:!0}},"[name=password]":{observe:"password",setOptions:{validate:!0,silent:!0}}},initialize:function(e){this.model=new u,this.submitButton=new d({className:"btn btn-block btn-primary btn-lg",loadingText:s.gettext("Verifying credentials...")}),this.formError=new p,this._pubsubListeners=[this.pubSub.subscribe(o.LOGIN_SUCCESS,i.bind(this._onSuccessfulLogin,this)),this.pubSub.subscribe(o.AUTH_ERROR,i.bind(this._onError,this))],a.reCaptcha&&(this.reCaptcha=new h({config:{sitekey:a.reCaptcha.sitekey,size:"invisible"}})),r.Validation.bind(this,{model:this.model})},_onDestroyed:function(){i.forEach(this._pubsubListeners,i.bind(this.pubSub.unsubscribe,this.pubSub))},events:{"change [name=email]":"_hideError","change [name=password]":"_hideError","submit form":"_onLoginFormSubmit",rendered:function(){this.stickit(this.model)},destroyed:"_onDestroyed"},_onLoginFormSubmit:function(e){e.preventDefault(),this.serialize(e,function(e,t){if(this._validate()){this.submitButton.setLoading();var n={email:e.email,password:e.password,preventSubsequentUserFetch:!0},i=this.model.get("g-recaptcha-response");i&&(n.captcha=i),this.pubSub.publish(o.USER_LOGIN,n)}else this.submitButton.reset();t()})},_validate:function(){return this.model.validate(),!!this.model.isValid()&&(!this.reCaptcha||this.reCaptcha.validate())},_onSuccessfulLogin:function(e){this.parent&&this.parent.trigger("success")},_hideError:function(e){this.formError.removeMessage()},_onError:function(e,t){this._isForbidden(t.response)?(this.formError.setMessage(s.gettext("Invalid email address or password.")),a.forgotPasswordUrl&&this.formError.setActionLink(a.forgotPasswordUrl,s.gettext("Forgot your password?"))):this.publishError(this._getLoginErrorTitle(t.response),this._getLoginErrorMessage(t.response),t.response),this.submitButton.reset(),this.reCaptcha&&this.reCaptcha.reset()},_getLoginErrorTitle:function(e){return this._isNotFound(e)?s.gettext("Service unavailable"):this._getErrorTitle(e)},_getLoginErrorMessage:function(e){return this._isNotFound(e)?s.gettext("The authentication service is currently unavailable. Please come back later."):this._isTooManyRequests(e)?s.gettext("You've attempted to log in too many times. Please come back later."):this._isInternalServerError(e)?s.gettext("An error prevented us from verifying your credentials. Please try again."):this._getErrorMessage(e)}}));n.exports=m}),define("hbs!packages/login/templates/index",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return"<p>"+o((t.gettext||e&&e.gettext||s).call(e,"Don't have an account?",{name:"gettext",hash:{},data:i}))+' <a href="'+o((r=null!=(r=t.registerUrl||(null!=e?e.registerUrl:e))?r:s,"function"==typeof r?r.call(e,{name:"registerUrl",hash:{},data:i}):r))+'">'+o((t.gettext||e&&e.gettext||s).call(e,"Register one here!",{name:"gettext",hash:{},data:i}))+"</a></p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l='<h1 class="view-title">'+a((t.gettext||e&&e.gettext||o).call(e,"Log in",{name:"gettext",hash:{},data:i}))+"</h1>\n"+a((t.view||e&&e.view||o).call(e,null!=e?e.loginForm:e,{name:"view",hash:{},data:i}))+"\n<p>"+a((t.gettext||e&&e.gettext||o).call(e,"Still using an old Minecraft premium account?",{name:"gettext",hash:{},data:i}))+' <a href="'+a((s=null!=(s=t.migrationUrl||(null!=e?e.migrationUrl:e))?s:o,"function"==typeof s?s.call(e,{name:"migrationUrl",hash:{},data:i}):s))+'">'+a((t.gettext||e&&e.gettext||o).call(e,"Migrate to a Mojang account",{name:"gettext",hash:{},data:i}))+"</a></p>\n";return r=t.if.call(e,null!=e?e.registerUrl:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l},useData:!0})}),define("packages/login/views/loginView",["require","exports","module","underscore","backbone","app-config","core/view","packages/login/views/components/loginFormView","hbs!packages/login/templates/index"],function(e,t,n){"use strict";var i=e("underscore"),r=e("backbone"),s=e("app-config"),o=e("core/view"),a=e("packages/login/views/components/loginFormView"),l=e("hbs!packages/login/templates/index"),c=o.extend({template:l,next:void 0,initialize:function(e){this.next=e.next,this.loginForm=new a,this.migrationUrl=s.migrationUrl,this.registerUrl=s.registerUrl,this.returnUrl=e.returnUrl,this.analytics.pageView("/login")},events:{success:"_onSuccessfulLogin"},_onSuccessfulLogin:function(e){var t,n;t=s.defaultPostLoginUrl?s.defaultPostLoginUrl:"/",n=this.returnUrl||t,this.next&&!i.isEmpty(this.next)?r.history.navigate(this.next,{trigger:!0}):window.location.href=n},loginForm:null});n.exports=c}),define("packages/login/routers/router",["require","exports","module","core/router","app-config","packages/login/views/loginView"],function(e,t,n){"use strict";var i=e("core/router"),r=e("app-config"),s=e("packages/login/views/loginView");n.exports=i.extend({routes:{"login(/)(:next)(/)(:nextParams)":"showLoginLayout"},initialize:function(e){i.prototype.initialize.apply(this,arguments)},defaultAction:function(){this.showLoginLayout()},showLoginLayout:function(e){if(this._isUserAuthenticated())return void this._navigateToNext(r.defaultPostLoginUrl,e);var t=new s({next:e,returnUrl:this.returnUrl});this.setView(t)}})}),define("packages/login/main",["require","exports","module","backbone","packages/login/views/layouts/rootLayoutView","packages/login/routers/router"],function(e,t,n){"use strict";var i=e("backbone"),r=e("packages/login/views/layouts/rootLayoutView"),s=e("packages/login/routers/router"),o={};o.start=function(e,t){var n=r.getInstance(e);t.user;new s({rootView:n,enableDefaultRoute:!0,returnUrl:t.returnUrl}),i.history.loadUrl()},n.exports=o}),define("hbs!packages/security/templates/securityDialog",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return'<div class="modal-header">\n    <h4 class="modal-title">'+o((r=null!=(r=t.dialogTitle||(null!=e?e.dialogTitle:e))?r:s,"function"==typeof r?r.call(e,{name:"dialogTitle",hash:{},data:i}):r))+'</h4>\n</div>\n<div class="modal-body">\n  '+o((t.view||e&&e.view||s).call(e,null!=e?e.securityView:e,{name:"view",hash:{},data:i}))+"\n</div>\n"},useData:!0})}),define("packages/security/views/securityDialog",["require","exports","module","core/dialogs/base-dialog","hbs!packages/security/templates/securityDialog"],function(e,t,n){"use strict";var i=e("core/dialogs/base-dialog"),r=e("hbs!packages/security/templates/securityDialog"),s=i.extend({className:"security-dialog",template:r,animate:!0,setView:function(e,t){this.securityView=e,this.dialogTitle=t,this.render()}});n.exports=s}),define("packages/security/models/secureLocationModel",["require","exports","module","underscore","i18n","env","app-config","pubsub","appPubSubTopics","core/model"],function(e,t,n){"use strict";var i=e("underscore"),r=e("i18n"),s=e("env"),o=(e("app-config"),e("pubsub")),a=e("appPubSubTopics"),l=e("core/model"),c=l.extend({pubSub:o,initialize:function(e){this.url=s.getEndpoint("secureLocation")},checkCurrentLocation:function(){return this._checkCurrentLocation()},secureCurrentLocation:function(e,t){return this._secureCurrentLocation(e,t)},_checkCurrentLocation:function(){var e=this;return this.fetch({beforeSend:i.bind(this._setAuthentication,this),error:function(t,n,i){e._isForbidden(n)?e.pubSub.publish(a.LOCATION_UNAUTHORIZED):e.pubSub.publish(a.LOCATION_ERROR,{errorMessage:r.gettext("Can't verify your location as secure"),response:n})}})},_secureCurrentLocation:function(e){var t=JSON.stringify(this._createAnswers(e));return $.ajax({type:"POST",url:this.url,data:t,processData:!1,contentType:"application/json; charset=utf-8",beforeSend:i.bind(this._setAuthentication,this),success:i.bind(this._authorizationSuccess,this),error:i.bind(this._handleError,this)})},_authorizationSuccess:function(e,t,n){this.pubSub.publish(a.LOCATION_AUTHORIZED)},_handleError:function(e,t,n){this.pubSub.publish(a.LOCATION_AUTHORIZATION_FAILED,{response:e,error:n})},_createAnswers:function(e){var t=[];return t.push(this._createAnswer(e.get("firstAnswerId"),e.get("firstAnswer"))),t.push(this._createAnswer(e.get("secondAnswerId"),e.get("secondAnswer"))),t.push(this._createAnswer(e.get("thirdAnswerId"),e.get("thirdAnswer"))),t},_createAnswer:function(e,t){return{id:e,answer:t}}});n.exports=c}),define("packages/security/models/securityChallengeModel",["require","exports","module","i18n","core/model"],function(e,t,n){"use strict";var i=e("i18n"),r=e("core/model");n.exports=r.extend({initialize:function(){var e=this.get("question").question;this.set("translatedQuestion",i.gettext(e))}})}),define("packages/security/collections/securityChallengeCollection",["require","exports","module","underscore","i18n","env","core/collection","pubsub","appPubSubTopics","packages/security/models/securityChallengeModel"],function(e,t,n){"use strict";var i=e("underscore"),r=e("i18n"),s=e("env"),o=e("core/collection"),a=e("pubsub"),l=e("appPubSubTopics"),c=e("packages/security/models/securityChallengeModel");n.exports=o.extend({url:s.getEndpoint("securityChallenges"),pubSub:a,model:c,initialize:function(e){this.fetch({beforeSend:i.bind(this._setAuthentication,this),error:i.bind(this._handleError,this)})},parse:function(e,t){var n=function(e,t){var n={index:t};i.extend(e,n),this.add(e)};i.each(e,n,this)},_handleError:function(e,t,n){this.pubSub.publish(l.LOCATION_ERROR,{errorMessage:r.gettext("Couldn't load security challenge"),response:t})}})}),define("core/validators",["require","exports","module","underscore","i18n"],function(e,t,n){"use strict";var i=e("underscore"),r=e("i18n"),s={passwordCharacteristics:function(e,t,n){var s=[],o=/[A-Z]/,a=/[a-z]/,l=/[\d]/,c=/[^\w\s]/,u=0;if(!i.isUndefined(e)){var d=function(t){return!e.match(t)},h=function(e,t,n){d(e)?n.push(r.sprintf(r.gettext("Password must contain at least 1 %1$s characters."),t)):u++},p=function(e,t){s.push(t)};return function(){var e=[];h(o,"uppercase",e),h(a,"lowercase",e),h(l,"digit",e),h(c,"non-alphanumeric",e),u<n&&(p(r.sprintf(r.gettext("Password matches %1$s of 4 character rules, but %2$s are required."),u,n)),i.each(e,function(e){s.push(e)}))}(),s.length>0?s.join(" "):void 0}},isAuthenticated:function(e,t,n,i){if(i.user.isAuthenticated()!==n)return r.gettext("User needs to be logged in")},redeemCodeFormat:function(e,t,n,s){var o,a,l;if(!i.isUndefined(e))return e=e.replace(/ /g,""),o=/^[\d|\s]+$/,a=/^([A-z0-9]{4}-){2}[A-z0-9]{4}$/,l=/^([A-z0-9]{5}-){4}[A-z0-9]{5}$/,e.match(a)||e.match(l)||e.match(o)?void 0:r.gettext("Invalid code. Codes look like this: A1A1A-B2B2B-C3C3C-D4D4D-E5E5E, A1A1-B2B2-C3C3, or 123 123 1234.")}};n.exports=s}),define("hbs!packages/security/templates/securityQuestions",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r=t.helperMissing;return(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Verify identity",{name:"gettext",hash:{},data:i}))},3:function(e,t,n,i){return'If you don\'t remember the answers to these questions and have access to the email address tied to this account you can <a href="%1$s">request to reset your security questions</a>, otherwise you need to get in touch with customer support through our <a href="%2$s">Support Center</a>.'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l=this.lambda,c="<p>"+a((t.gettext||e&&e.gettext||o).call(e,"Since you are accessing this page from this device (or location) for the first time we need you to confirm your identity before you can continue. This is to make sure that your account isn't used without your authorization.",{name:"gettext",hash:{},data:i}))+'</p>\n\n<p class="lead">'+a((t.gettext||e&&e.gettext||o).call(e,"Please answer your security questions below.",{name:"gettext",hash:{},data:i}))+'</p>\n\n<form method="post" role="form" novalidate autocomplete="off">\n  '+a((t.view||e&&e.view||o).call(e,null!=e?e.formError:e,{name:"view",hash:{},data:i}))+'\n    <div class="form-group">\n      <label for="'+a(l(i&&i.cid,e))+'-firstAnswer">'+a((s=null!=(s=t.firstTranslatedQuestion||(null!=e?e.firstTranslatedQuestion:e))?s:o,"function"==typeof s?s.call(e,{name:"firstTranslatedQuestion",hash:{},data:i}):s))+'</label>\n      <input id="'+a(l(i&&i.cid,e))+'-firstAnswer" type="text" class="form-control" name="firstAnswer">\n      <span class="help-block help-block--feedback hidden"></span>\n    </div>\n    <div class="form-group">\n        <label for="'+a(l(i&&i.cid,e))+'-secondAnswer">'+a((s=null!=(s=t.secondTranslatedQuestion||(null!=e?e.secondTranslatedQuestion:e))?s:o,"function"==typeof s?s.call(e,{name:"secondTranslatedQuestion",hash:{},data:i}):s))+'</label>\n        <input id="'+a(l(i&&i.cid,e))+'-secondAnswer" type="text" class="form-control" name="secondAnswer">\n        <span class="help-block help-block--feedback hidden"></span>\n    </div>\n    <div class="form-group">\n        <label for="'+a(l(i&&i.cid,e))+'-thirdAnswer">'+a((s=null!=(s=t.thirdTranslatedQuestion||(null!=e?e.thirdTranslatedQuestion:e))?s:o,"function"==typeof s?s.call(e,{name:"thirdTranslatedQuestion",hash:{},data:i}):s))+'</label>\n        <input id="'+a(l(i&&i.cid,e))+'-thirdAnswer" type="text" class="form-control" name="thirdAnswer">\n        <span class="help-block help-block--feedback hidden"></span>\n    </div>\n    <div class="form-group">\n      ';return r=(t.view||e&&e.view||o).call(e,null!=e?e.submitButton:e,{name:"view",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(c+=r),c+="\n    </div>\n</form>\n\n<h4>Clueless?</h4>\n<p>\n  ",r=(t.gettext_block||e&&e.gettext_block||o).call(e,null!=e?e.resetQuestionsLink:e,null!=e?e.helpLink:e,{name:"gettext_block",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=r&&(c+=r),c+"\n</p>\n\n\n"},useData:!0})}),function(e){"use strict";var t=function(n,i){this.$element=e(n),this.options=e.extend({},t.defaults,i)};t.defaults={transition_delay:300,refresh_speed:50,display_text:"none",use_percentage:!0,percent_format:function(e){return e+"%"},amount_format:function(e,t,n){return e+" / "+t},update:e.noop,done:e.noop,fail:e.noop},t.prototype.transition=function(){var n=this.$element,i=n.parent(),r=this.$back_text,s=this.$front_text,o=this.options,a=parseInt(n.attr("data-transitiongoal")),l=parseInt(n.attr("aria-valuemin"))||0,c=parseInt(n.attr("aria-valuemax"))||100,u=i.hasClass("vertical"),d=o.update&&"function"==typeof o.update?o.update:t.defaults.update,h=o.done&&"function"==typeof o.done?o.done:t.defaults.done,p=o.fail&&"function"==typeof o.fail?o.fail:t.defaults.fail;if(isNaN(a))return void p("data-transitiongoal not set");var f=Math.round(100*(a-l)/(c-l));if("center"===o.display_text&&!r&&!s){this.$back_text=r=e("<span>").addClass("progressbar-back-text").prependTo(i),this.$front_text=s=e("<span>").addClass("progressbar-front-text").prependTo(n);var m;u?(m=i.css("height"),r.css({height:m,"line-height":m}),s.css({height:m,"line-height":m}),e(window).resize(function(){m=i.css("height"),r.css({height:m,"line-height":m}),s.css({height:m,"line-height":m})})):(m=i.css("width"),s.css({width:m}),e(window).resize(function(){m=i.css("width"),s.css({width:m})}))}setTimeout(function(){var e,t,p,m,g;u?n.css("height",f+"%"):n.css("width",f+"%");var v=setInterval(function(){u?(p=n.height(),m=i.height()):(p=n.width(),m=i.width()),e=Math.round(100*p/m),t=Math.round(l+p/m*(c-l)),e>=f&&(e=f,t=a,h(n),clearInterval(v)),"none"!==o.display_text&&(g=o.use_percentage?o.percent_format(e):o.amount_format(t,c,l),"fill"===o.display_text?n.text(g):"center"===o.display_text&&(r.text(g),s.text(g))),n.attr("aria-valuenow",t),d(e,n)},o.refresh_speed)},o.transition_delay)};var n=e.fn.progressbar;e.fn.progressbar=function(n){return this.each(function(){var i=e(this),r=i.data("bs.progressbar"),s="object"==typeof n&&n;r&&s&&e.extend(r.options,s),r||i.data("bs.progressbar",r=new t(this,s)),r.transition()})},e.fn.progressbar.Constructor=t,e.fn.progressbar.noConflict=function(){return e.fn.progressbar=n,this}}(window.jQuery),define("bootstrap-progressbar",function(){}),define("packages/security/views/securityQuestionsView",["require","exports","module","underscore","backbone","i18n","appPubSubTopics","pubsub","app-config","core/view","core/model","packages/security/collections/securityChallengeCollection","components/submit-button/views/submitButtonView","components/error-message/views/errorMessageView","core/validators","hbs!packages/security/templates/securityQuestions","bootstrap-progressbar"],function(e,t,n){"use strict";var i=e("underscore"),r=e("backbone"),s=e("i18n"),o=e("appPubSubTopics"),a=(e("pubsub"),e("app-config")),l=e("core/view"),c=e("core/model"),u=e("packages/security/collections/securityChallengeCollection"),d=e("components/submit-button/views/submitButtonView"),h=e("components/error-message/views/errorMessageView"),p=(e("core/validators"),e("hbs!packages/security/templates/securityQuestions"));e("bootstrap-progressbar"),r.Validation.configure({forceUpdate:!0});var f=l.extend({className:"security-questions",template:p,collection:null,model:null,controller:null,submitButton:null,formError:null,bindings:{"[name=firstAnswer]":{observe:"firstAnswer",setOptions:{validate:!0,silent:!0}},"[name=secondAnswer]":{observe:"secondAnswer",setOptions:{validate:!0,silent:!0}},"[name=thirdAnswer]":{observe:"thirdAnswer",setOptions:{validate:!0,silent:!0}}},initialize:function(e){var t={validation:{firstAnswer:{required:!0,msg:s.gettext("You need to provide an answer to this question")},secondAnswer:{required:!0,msg:s.gettext("You need to provide an answer to this question")},thirdAnswer:{required:!0,msg:s.gettext("You need to provide an answer to this question")}}};this.model=i.extend(new c,t),this.model.on("error",this._handleError,this),this.collection=new u,this.collection.on("reset",this._onChallengesLoaded,this),this.submitButton=new d({className:"btn btn-block btn-primary btn-lg",loadingText:s.gettext("Verifying identity...")}),this.formError=new h,this.helpLink=a.supportUrl,this.resetQuestionsLink=a.security.resetQuestionsLink,this.initSubscribers(),r.Validation.bind(this,{model:this.model}),window.view=this},initSubscribers:function(){this.pubSub.subscribe(o.LOCATION_AUTHORIZATION_FAILED,i.bind(this._handleError,this))},events:{"submit form":"_onFormSubmit",rendered:function(){this.stickit(this.model),r.Validation.bind(this,{valid:function(e,t,n){var i=e.$("[name="+t+"]"),r=i.closest(".form-group");r.removeClass("has-error"),r.find(".help-block--feedback").html("").addClass("hidden")},invalid:function(e,t,n,i){var r=e.$("[name="+t+"]"),s=r.closest(".form-group");s.addClass("has-error"),s.find(".help-block--feedback").html(n).removeClass("hidden")}})}},
_onChallengesLoaded:function(e){var t=function(e,t,n){var i=e.get("answer").id,r=e.get("translatedQuestion");0===t?(this.firstTranslatedQuestion=r,this.model.set("firstAnswerId",i)):1===t?(this.secondTranslatedQuestion=r,this.model.set("secondAnswerId",i)):2===t&&(this.thirdTranslatedQuestion=r,this.model.set("thirdAnswerId",i))};e.each(t,this)},_onFormSubmit:function(e){e.preventDefault(),this.serialize(e,function(e,t){this.model.validate(),this.model.isValid()?(this.submitButton.setLoading(),this.controller.secureCurrentLocation(this.model,this._handleError)):this.submitButton.reset(),t()})},_handleError:function(e,t){var n=t.response;this._isForbidden(n)?this.formError.setMessage(s.gettext("At least one answer was incorrect.")):this.formError.setMessage(s.gettext("An error occurred! Your identity could not be verified. Please try again.")),this.submitButton.reset()}});n.exports=f}),define("hbs!packages/security/templates/securityError",["handlebars"],function(e){return e.template({1:function(e,t,n,i){return'To make sure that no unauthorized changes are made to your account we need to verify that your IP address is secure. However, an error occurred, preventing us from completing verification. Please log back in and try again. If you keep seeing this error <a href="%1$s">contact customer support</a>.'},3:function(e,t,n,i){var r,s="";return r=t.if.call(e,null!=e?e.errorDetails:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.program(6,i),data:i}),null!=r&&(s+=r),s},4:function(e,t,n,i){var r,s=t.helperMissing;return'      <div class="error-details">\n          <p>'+(0,this.escapeExpression)((r=null!=(r=t.detailedErrorMessage||(null!=e?e.detailedErrorMessage:e))?r:s,"function"==typeof r?r.call(e,{name:"detailedErrorMessage",hash:{},data:i}):r))+"</p>\n      </div>\n"},6:function(e,t,n,i){var r=t.helperMissing;return'      <p><a href="#" class="show-error-details">'+(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Show error details",{name:"gettext",hash:{},data:i}))+"</a></p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l="<p>\n  ";return r=(t.gettext_block||e&&e.gettext_block||o).call(e,null!=e?e.helpLink:e,{name:"gettext_block",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+='\n</p>\n<p class="lead alert alert-danger">\n  '+a((s=null!=(s=t.errorMessage||(null!=e?e.errorMessage:e))?s:o,"function"==typeof s?s.call(e,{name:"errorMessage",hash:{},data:i}):s))+"\n</p>\n",r=t.if.call(e,null!=e?e.detailedErrorMessage:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+"\n"},useData:!0})}),define("packages/security/views/securityErrorView",["require","exports","module","core/view","core/model","hbs!packages/security/templates/securityError","bootstrap-progressbar"],function(e,t,n){"use strict";var i=e("core/view"),r=e("core/model"),s=e("hbs!packages/security/templates/securityError");e("bootstrap-progressbar"),n.exports=i.extend({className:"security-error",template:s,events:{"click .show-error-details":"_showErrorDetails"},initialize:function(e){this.setModel(new r(e)),e.response&&this.model.set("detailedErrorMessage",this._getDetailedErrorMessage(e.response))},_showErrorDetails:function(e){return e.preventDefault(),this.model.set("errorDetails",!0),!1},_getDetailedErrorMessage:function(e){return e.responseJSON?e.responseJSON.error+": "+e.responseJSON.errorMessage:null}})}),define("packages/security/controllers/securityController",["require","exports","module","underscore","i18n","core/controller","appPubSubTopics","pubsub","packages/security/views/securityDialog","packages/security/models/secureLocationModel","packages/security/views/securityQuestionsView","packages/security/views/securityErrorView"],function(e,t,n){"use strict";var i=e("underscore"),r=e("i18n"),s=e("core/controller"),o=e("appPubSubTopics"),a=e("pubsub"),l=e("packages/security/views/securityDialog"),c=e("packages/security/models/secureLocationModel"),u=e("packages/security/views/securityQuestionsView"),d=e("packages/security/views/securityErrorView"),h=s.extend({pubSub:a,initialize:function(e){this.securityDialog=new l,this.target=e.target,this.initSubscribers()},initSubscribers:function(){this.pubSub.subscribe(o.LOCATION_UNAUTHORIZED,i.bind(this.showSecurityQuestions,this)),this.pubSub.subscribe(o.LOCATION_ERROR,i.bind(this.showSecurityError,this)),this.pubSub.subscribe(o.LOCATION_AUTHORIZED,i.bind(this.hideSecurityDialog,this))},checkCurrentLocation:function(){(new c).checkCurrentLocation()},showSecurityQuestions:function(){this.securityDialog.setView(new u({controller:this}),r.gettext("Confirm your identity")),this.pubSub.publish(o.SHOW_MODAL,{view:this.securityDialog,options:{keyboard:!1}})},showSecurityError:function(e,t){this.securityDialog.setView(new d(t),r.gettext("An error occurred"))},secureCurrentLocation:function(e){(new c).secureCurrentLocation(e)},hideSecurityDialog:function(){this.pubSub.publish(o.HIDE_MODAL)}});n.exports=h}),define("packages/security/main",["require","exports","module","core/user/controllers/userController","packages/security/controllers/securityController"],function(e,t,n){"use strict";var i=e("core/user/controllers/userController"),r=e("packages/security/controllers/securityController"),s={};s.start=function(e,t){(new i).getUser().isSecured()&&new r({target:e}).checkCurrentLocation()},n.exports=s}),define("packages/register/controllers/registerController",["require","exports","module","underscore","appPubSubTopics","core/controller"],function(e,t,n){"use strict";var i=e("underscore"),r=e("appPubSubTopics"),s=e("core/controller"),o=s.extend({initialize:function(e){this._user=e.user,this.initSubscribers()},initSubscribers:function(){this.pubSub.subscribe(r.USER_REGISTER,i.bind(this._onRegisterUser,this))},registerUser:function(e){var t={},n=e.get("g-recaptcha-response");n&&(t.captcha=n),t.email=e.get("email"),t.password=e.get("password"),t.dateOfBirth=e.getDateOfBirth(),t.languageCode=this._user.getLocale(),e.setUrl(),e.save(t,{success:i.bind(this.saveSuccess,this)})},_navigateAfterSuccess:function(e){var t=encodeURIComponent(e);Backbone.history.navigate("verify/"+t,{trigger:!0})},_postRegistrationLogin:function(e,t){this.pubSub.publish(r.USER_LOGIN,{email:e,password:t,successfulLoginCallback:this._navigateAfterSuccess})},_updateProgress:function(){this.pubSub.publish(r.PROGRESS_UPDATE,{id:"Register",resolved:!0})},saveSuccess:function(e,t,n){var i,r;i=e.get("email"),r=e.get("password"),this._postRegistrationLogin(i,r),this._updateProgress()},_onRegisterUser:function(e,t){this.registerUser(t.model)}});n.exports=o}),define("packages/verify-email/models/resendModel",["require","exports","module","i18n","env","core/model"],function(e,t,n){"use strict";var i=(e("i18n"),e("env")),r=e("core/model"),s=r.extend({url:i.getEndpoint("resendVerification")});n.exports=s}),define("packages/verify-email/controllers/verifyController",["require","exports","module","underscore","core/controller","appPubSubTopics","core/user/models/userModel","packages/verify-email/models/resendModel","app-config"],function(e,t,n){"use strict";var i=e("underscore"),r=e("core/controller"),s=e("appPubSubTopics"),o=e("core/user/models/userModel"),a=e("packages/verify-email/models/resendModel"),l=e("app-config"),c=r.extend({emailSent:!1,initialize:function(e){this.initSubscribers()},initSubscribers:function(){this.pubSub.subscribe(s.VERIFY_EMAIL,i.bind(this._onVerifyEmail,this)),this.pubSub.subscribe(s.REQUEST_VERIFICATION_EMAIL,i.bind(this._onRequestVerificationEmail,this)),this.pubSub.subscribe(s.USER_REGISTER,i.bind(this._onRegisterUser,this))},verifyEmail:function(e,t){var n,i;n=this,i=e.getEndpointUrl(),$.ajax(i).done(function(){n._verificationSuccess()}).fail(function(e,t,i){n._view.handleError(e)})},resendEmailVerification:function(e){var t=new a({email:e.get("email"),languageCode:o.getInstance().getLocale(),source:l.registerForm.source}),n=this;t.save(t.toJSON(),{beforeSend:t._setAuthentication,success:function(e,t,i){n._handleResendVerificationSuccess()},error:function(e,t,i){n._handleResendVerificationError(t)}})},_handleResendVerificationSuccess:function(){this._view.showDispathedNewVerificationEmail()},_handleResendVerificationError:function(e){this._view.showDispathedNewVerificationEmailError(e)},_navigateAfterSuccess:function(){var e;e=o.getInstance().isRegistered()&&o.getInstance().doesNeedParentalConsent()?"consent":o.getInstance().isRegistered()?"buy":"login/buy",Backbone.history.navigate(e,{trigger:!0})},_updateProgress:function(){this.pubSub.publish(s.PROGRESS_UPDATE,{id:"VerifyEmail",resolved:!0})},_requestUserUpdate:function(){this.pubSub.publish(s.USER_UPDATE_REQUESTED,{successfulUpdateCallback:this._navigateAfterSuccess})},_verificationSuccess:function(){this._updateProgress(),this._requestUserUpdate()},_verificationError:function(e,t){e.set(t.responseJSON)},_onRegisterUser:function(e,t){this.emailSent=!0},_onVerifyEmail:function(e,t){i.isEmpty(t.model)||this.verifyEmail(t.model,t.error)},_onRequestVerificationEmail:function(e,t){i.isEmpty(t.model)||this.resendEmailVerification(t.model,t.error)}});n.exports=c}),define("packages/parental-consent/controllers/consentController",["require","exports","module","underscore","core/controller"],function(e,t,n){"use strict";var i=e("underscore"),r=e("core/controller"),s=r.extend({initialize:function(e){this._user=e.user},sendConsentRequest:function(e){var t=e.getSaveData();t.languageCode=this._user.getLocale(),e.save(t,{beforeSend:e._setAuthentication,success:i.bind(this.requestSuccess,this)})},requestSuccess:function(e,t,n){e.set("sent",!0)}});n.exports=s}),define("packages/redeem/models/createProfileModel",["require","exports","module","i18n","core/model","env"],function(e,t,n){"use strict";var i=e("i18n"),r=e("core/model"),s=e("env"),o=r.extend({defaults:{},initialize:function(){this._setUrl()},fetch:function(){},_setUrl:function(){this.url=s.getEndpoint("createProfile")},_getCreateProfileErrorMessage:function(e){return this._isBadRequest(e)||this._isMethodNotAllowed(e)||this._isNotFound(e)?i.gettext("Your request to create a profile is invalid and can't be processed, please try again. If this problem persists contact Mojang customer support to get further assistance."):this._isUnauthorized(e)?i.gettext("You need to be logged in to create a profile. Please log back in and try again."):this._isTooManyRequests(e)?i.gettext("You've just recently attempted to create a profile. You need to wait before you can try again."):this._isInternalServerError(e)?i.gettext("An error prevented us from creating your profile, please try again. If this problem persists contact Mojang customer support to get further assistance."):this._getErrorMessage(e)}});n.exports=o}),define("packages/redeem/controllers/redeemController",["require","exports","module","backbone","underscore","app-config","i18n","appPubSubTopics","core/controller","packages/redeem/models/createProfileModel"],function(e,t,n){"use strict";var i=e("backbone"),r=e("underscore"),s=e("app-config"),o=e("i18n"),a=e("appPubSubTopics"),l=e("core/controller"),c=e("packages/redeem/models/createProfileModel"),u=l.extend({view:void 0,initialize:function(e){this._user=e.user,this._product=s.productName,this._productType="GAME"},redeemGift:function(e){var t=e.clone();t.set("languageCode",this._user.getLocale()),t.set("productType",this._productType),t.trimCode(),t.save(t.toJSON(),{beforeSend:t._setAuthentication,success:r.bind(this._onRedeemSuccess,this),error:r.bind(this._onRedeemError,this)})},_createProfile:function(e){var t=new c({tokenCode:e.tokenCode,languageCode:this._user.getLocale()});t.save(t.toJSON(),{beforeSend:t._setAuthentication,success:r.bind(this._onCreateProfileSuccess,this),error:r.bind(this._onCreateProfileError,this)})},_triggerErrorMessage:function(e){this.view&&this.view.trigger("redeem_error",e)},_onRedeemError:function(e,t){var n={errorTitle:e._getRedeemErrorTitle(t),errorMessage:e._getRedeemErrorMessage(t),response:t};this._triggerErrorMessage(n)},_onRedeemSuccess:function(e,t){var n=this,i=function(e){var t={errorTitle:o.gettext("Could not redeem code"),errorMessage:e};n._triggerErrorMessage(t)},r=function(){i(o.gettext("Received invalid response from server. This is most likely a temporary issue, please try again later. If this problem persists contact Mojang customer support to get further assistance."))};if(t.responseCode)switch(t.responseCode){case"SUCCESS":t.tokenCode&&t.productType?this._productType===t.productType?this._createProfile(t):i(o.sprintf(o.gettext("This code is not valid for %1$s. Please visit to Mojang accounts website to redeem this code."),this._product)):r();break;case"REDEEMED":i(o.gettext("The code you entered has already been redeemed. Please contact Mojang customer support in order to get further assistance."));break;case"PRODUCT_ERROR":i(o.gettext("We are unable to identify the product associated with your code. Please contact Mojang customer support in order to get further assistance."));break;case"ALREADY_OWN":i(o.sprintf(o.gettext("You are not allowed to own more than one copy of %1$s per account. Please register a new account in order to redeem this code."),this._product));break;case"FAILED":i(o.gettext("We are currently unable to redeem your code, please try again later. If this problem persists contact Mojang customer support to get further assistance."));break;case"INACTIVE":i(o.gettext("The code you entered has not been activated. Please contact the store where you bought the code in order to have it activated."));break;case"EXPIRED":i(o.gettext("The code you entered has expired and is no longer valid. Please contact Mojang customer support to get further assistance."));break;case"NO_PROFILE":case"INVALID_CODE":i(o.gettext("The code you entered is invalid. Please double check to make sure that you have entered it correctly."))}else r()},_onCreateProfileError:function(e,t){var n={errorTitle:e._getErrorTitle(t),errorMessage:e._getCreateProfileErrorMessage(t),response:t};this._triggerErrorMessage(n)},_onCreateProfileSuccess:function(e,t){this.view&&this.view.trigger("redeem_success"),this.pubSub.publish(a.PROGRESS_UPDATE,{id:"Buy",resolved:!0}),this.pubSub.publish(a.PROGRESS_UPDATE,{id:"Redeem",resolved:!0}),i.history.navigate("redeemed",{trigger:!0})}});n.exports=u}),define("packages/order-flow/controllers/orderFlowController",["require","exports","module","underscore","appPubSubTopics","core/controller","core/collection","i18n"],function(e,t,n){"use strict";var i=e("underscore"),r=e("appPubSubTopics"),s=e("core/controller"),o=e("core/collection"),a=e("i18n"),l=s.extend({_progressSteps:new o([{id:"Register",name:a.gettext("Register")},{id:"VerifyEmail",name:a.gettext("Verify email")},{id:"Buy",name:a.gettext("Buy")},{id:"Download",name:a.gettext("Download")},{id:"LogIn",name:a.gettext("Log in")}]),initialize:function(e){var t=this;this._user=e.user,this._registerOrderFlowProgressSteps(["Register","VerifyEmail","Buy","Download"]),this.pubSub.subscribe(r.USER_ATTRIBUTES_CHANGED,function(e,n){t.updateProgressBar(n)})},_addProgressStep:function(e,t,n){this.pubSub.publish(r.PROGRESS_REGISTER,{id:e,name:t,sortOrder:n})},_registerOrderFlowProgressSteps:function(e){var t,n=this;i.each(e,function(e,i){t=n._progressSteps.get(e),n._addProgressStep(t.get("id"),t.get("name"),i+1)})},updateProgressBar:function(){var e=this._user;i.isEmpty(e.get("id"))||this.pubSub.publish(r.PROGRESS_UPDATE,{id:"Register",resolved:!0}),e.isEmailVerified()&&this.pubSub.publish(r.PROGRESS_UPDATE,{id:"VerifyEmail",resolved:!0})}});n.exports=l}),define("packages/payment-methods/models/paymentMethodModel",["require","exports","module","core/model","i18n"],function(e,t,n){"use strict";var i=e("core/model"),r=e("i18n"),s=i.extend({initialize:function(){"braintree"===this.get("method")&&this.set("creditCard",!0),this.set("forGiftsOnly","GIFT"===this.get("type")),this.set("submitButtonText",r.gettext("Purchase for %1$s"))}});n.exports=s}),define("packages/payment-methods/collections/paymentMethodsCollection",["require","exports","module","i18n","env","core/collection","core/dialogs/error-dialog","packages/payment-methods/models/paymentMethodModel","pubsub","appPubSubTopics"],function(e,t,n){"use strict";var i,r=e("i18n"),s=e("env"),o=e("core/collection"),a=e("core/dialogs/error-dialog"),l=e("packages/payment-methods/models/paymentMethodModel"),c=e("pubsub"),u=e("appPubSubTopics"),d=o.extend({url:s.getEndpoint("paymentMethods"),pubSub:c,model:l,comparator:"sortOrder",initialize:function(e){this.on("error",this._handleError,this),this.fetch()},_handleError:function(e,t,n){var i=new a,r=this._getPaymentMethodsErrorMessage(t);i.setContent({errorTitle:this._getPaymentMethodsErrorTitle(t),errorMessage:r,response:t}),this.pubSub.publish(u.SHOW_MODAL,{view:i,label:r})},_getPaymentMethodsErrorTitle:function(e){return r.gettext("Could not load payment methods")},_getPaymentMethodsErrorMessage:function(e){return r.gettext("An error prevented the list of payment methods from being loaded.")}});d.getInstance=function(){return i||(i=new d),i},n.exports=d}),define("packages/order/models/currencyModel",["require","exports","module","core/model"],function(e,t,n){"use strict";var i=e("core/model"),r=i.extend({defaults:{currencyCode:"EUR"},initialize:function(e){},getCurrencyCode:function(){return this.get("currencyCode")},setCurrencyCode:function(e){this.set("currencyCode",e)}});n.exports=r}),define("packages/order/models/orderPropertyModel",["require","exports","module","core/model"],function(e,t,n){"use strict";var i=e("core/model"),r=i.extend({initialize:function(e){}});n.exports=r}),define("core/order-mixins",["require","exports","module","underscore"],function(e,t,n){"use strict";var i=e("underscore");n.exports={getPaymentProvider:function(){return this.get("provider")},getPaymentMethod:function(){var e,t,n=this.get("properties");return t=function(e){return i.findWhere(e,{name:"skrillPaymentMethod"})||i.findWhere(e,{name:"adyenBrandCode"})},e=t(n),e?e.value:null}}}),define("packages/order/models/processableOrderModel",["require","exports","module","underscore","env","i18n","core/model","core/order-mixins"],function(e,t,n){"use strict";var i=e("underscore"),r=e("env"),s=e("i18n"),o=e("core/model"),a=e("core/order-mixins"),l=o.extend(i.extend({initialize:function(){this.set("id",this._generateUUID())},isNew:function(){return!0},placeOrder:function(){this.url=r.getEndpoint("createOrder"),this.save(this.toJSON(),{beforeSend:i.bind(this._setAuthentication,this)})},addOrderProperty:function(e,t){this.get("properties").push({name:e,value:t})},_generateUUID:function(){var e=(new Date).getTime();return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})},_getOrderProcessingErrorTitle:function(e){return this._isTooManyRequests(e)?s.gettext("Recently sent order"):this._getErrorTitle(e)},_getOrderProcessingErrorMessage:function(e){return this._isBadRequest(e)||this._isMethodNotAllowed(e)?s.gettext("Your order request is invalid and can't be processed. Please try again or contact customer support."):this._isUnauthorized(e)?s.gettext("You need to be logged in to send an order. Please log back in and try again."):this._isTooManyRequests(e)?s.gettext("You've just recently send us an order. You need to wait before you send another one."):this._isInternalServerError(e)?s.gettext("An error prevented us from processing your order. Please try again."):this._getErrorMessage(e)}},a));n.exports=l}),define("packages/order/models/orderModel",["require","exports","module","underscore","jquery","i18n","app-config","core/model","core/collection","packages/order/models/orderPropertyModel","packages/order/models/processableOrderModel","env"],function(e,t,n){"use strict";var i=e("underscore"),r=e("jquery"),s=e("i18n"),o=e("app-config"),a=e("core/model"),l=e("core/collection"),c=e("packages/order/models/orderPropertyModel"),u=e("packages/order/models/processableOrderModel"),d=e("env"),h=a.extend({url:null,defaults:{amount:null},initialize:function(e){this.on({error:this._onError,sync:this._onSync}),this.on("change:displayItems",function(e){this.updateTotalOrderAmount()},this);var t=l.extend({model:c});this.set("properties",new t)},isNew:function(){return!0},_setOrderUrl:function(){this.url=d.getEndpoint("getOrder",{id:this.get("id")})},addOrderProperty:function(e,t){this.get("properties").add({name:e,value:t})},updateUserCountry:function(e){this.get("properties").findWhere({name:"userCountry"}).set("value",e)},fetchOrder:function(){var e=this;return this._setOrderUrl(),this.fetch({beforeSend:i.bind(this._setAuthentication,this),error:function(t,n,i){t.set({error:e._getSecureCheckErrorTitle(n),errorMessage:e._getSecureCheckErrorMessage(n),exception:n.responseJSON.error,exceptionMessage:n.responseJSON.errorMessage})}})},getTotalOrderAmount:function(){var e=this.prepareOrder();return r.ajax({beforeSend:i.bind(this._setAuthentication,this),url:d.getEndpoint("orderPrice"),type:"POST",data:JSON.stringify(e),processData:!1,contentType:"application/json; charset=utf-8"})},prepareOrder:function(){var e=this,t=new l;return e.get("displayItems").each(function(e){var n={variantId:e.get("variantId"),quantity:e.get("quantity")};t.add(n)}),new u({items:t.toJSON(),properties:e.get("properties").toJSON(),source:o.order.agent})},updateTotalOrderAmount:function(){var e=this;this.getTotalOrderAmount().done(function(t){e.set("amount",t.displayAmount)})},_getSecureCheckErrorTitle:function(e){return this._isBadRequest(e)||this._isNotFound(e)?s.gettext("Invalid order"):this._getErrorTitle(e)},_getSecureCheckErrorMessage:function(e){return this._isBadRequest(e)||this._isNotFound(e)?s.gettext("This order is invalid and can't be loaded."):this._isUnauthorized(e)?s.gettext("Please log in to view this order."):this._isInternalServerError(e)?s.gettext("An error prevented this order from being loaded. Please try again."):this._isTooManyRequests(e)?s.gettext("Please come back later."):void 0},_onError:function(e,t,n){e.loadEnd()},_onSync:function(e,t,n){e.loadEnd()}});n.exports=h}),define("packages/order/models/adyenOrderModel",["require","exports","module","underscore","core/model","env"],function(e,t,n){"use strict";var i=e("underscore"),r=e("core/model"),s=e("env"),o=r.extend({url:null,initialize:function(e){this.url=s.getEndpoint("verifyAdyenOrder"),this.on({error:this._onError,sync:this._onSync})},isNew:function(){return!0},fetchOrder:function(){this.save(this.toJSON(),{beforeSend:i.bind(this._setAuthentication,this)})},_onError:function(e,t,n){e.loadEnd()},_onSync:function(e,t,n){e.loadEnd()}});n.exports=o}),define("packages/order/models/creditCardModel",["require","exports","module","core/model"],function(e,t,n){"use strict";var i=e("core/model"),r=i.extend({url:void 0,initialize:function(e){}});n.exports=r}),define("packages/order/models/orderItemModel",["require","exports","module","core/model"],function(e,t,n){"use strict";var i=e("core/model"),r=i.extend({defaults:{},initialize:function(e){}});n.exports=r}),define("packages/order/collections/orderItemsCollection",["require","exports","module","core/collection","packages/order/models/orderItemModel"],function(e,t,n){"use strict";var i=e("core/collection"),r=e("packages/order/models/orderItemModel"),s=i.extend({model:r,initialize:function(){}});n.exports=s}),define("packages/order/models/orderDisplayItemModel",["require","exports","module","underscore","env","packages/order/models/orderItemModel"],function(e,t,n){"use strict";var i=e("underscore"),r=e("env"),s=e("packages/order/models/orderItemModel"),o=s.extend({initialize:function(e){this._setUrl(e.variantId),this.fetch(),this.set("amount",i.bind(this.getAmount,this))},_setUrl:function(e){this.url=r.getEndpoint("variant",{variantId:e})},getAmount:function(){var e=this.get("priceModel");return e?e.get("amount"):"Fetching price"}});n.exports=o}),define("packages/order/collections/orderDisplayItemsCollection",["require","exports","module","core/collection","packages/order/models/orderDisplayItemModel"],function(e,t,n){"use strict";var i=e("core/collection"),r=e("packages/order/models/orderDisplayItemModel"),s=i.extend({model:r,initialize:function(){}});n.exports=s}),define("packages/order/models/orderItemPriceModel",["require","exports","module","env","core/model"],function(e,t,n){"use strict";var i=e("env"),r=e("core/model"),s=r.extend({url:i.getEndpoint("prices"),isNew:function(){return!0},initialize:function(e){}});n.exports=s}),define("packages/order/collections/pricesCollection",["require","exports","module","env","core/collection","packages/order/models/orderItemPriceModel"],function(e,t,n){"use strict";var i=e("env"),r=e("core/collection"),s=e("packages/order/models/orderItemPriceModel"),o=r.extend({url:i.getEndpoint("prices"),model:s,initialize:function(){},addPriceToModels:function(e,t,n){var i=this,r={method:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(e)};i.once("sync",function(e,i,r){var s=[];n.each(function(n){var i=n.get("variantId")+t.getCurrencyCode(),r=e.findWhere({id:i});s.push(n.set("priceModel",r,{silent:!1}))}),n.reset(s)}),this.fetch(r)}});n.exports=o}),define("packages/order/controllers/orderController",["require","exports","module","app-config","underscore","appPubSubTopics","core/analytics","core/controller","packages/payment-methods/collections/paymentMethodsCollection","packages/order/models/currencyModel","packages/order/models/orderModel","packages/order/models/adyenOrderModel","packages/order/models/creditCardModel","packages/order/collections/orderItemsCollection","packages/order/collections/orderDisplayItemsCollection","packages/order/collections/pricesCollection"],function(e,t,n){"use strict";var i=e("app-config"),r=e("underscore"),s=e("appPubSubTopics"),o=e("core/analytics"),a=e("core/controller"),l=e("packages/payment-methods/collections/paymentMethodsCollection"),c=e("packages/order/models/currencyModel"),u=e("packages/order/models/orderModel"),d=e("packages/order/models/adyenOrderModel"),h=e("packages/order/models/creditCardModel"),p=e("packages/order/collections/orderItemsCollection"),f=e("packages/order/collections/orderDisplayItemsCollection"),m=e("packages/order/collections/pricesCollection"),g=a.extend({paymentProviderSkrill:{recipientDescription:void 0,returnUrl:void 0,cancelUrl:void 0,logoUrl:void 0},paymentProviderAdyen:{skinCode:void 0},_orderItemsCollection:void 0,_currencyInstance:void 0,_pricesCollection:void 0,_order:void 0,initialize:function(e){r.extend(this.paymentProviderSkrill,i.skrill),r.extend(this.paymentProviderAdyen,i.adyen),this._pricesCollection=new m,this._orderItemsCollection=new f,this._currencyInstance=new c({currencyCode:"EUR"}),this._user=e.user,this._bindEvents(),this._pubSubSubscribe()},_bindEvents:function(){this._orderItemsCollection.on("add",function(e,t,n){this._updatePricesOnOrderItems(t)},this),this._currencyInstance.on("change",function(e){this._updatePricesOnOrderItems(this._orderItemsCollection)},this)},_pubSubSubscribe:function(){var e=this;this.pubSub.subscribe(s.COUNTRY_CHANGED,function(t,n){var i;i=n.get("currency"),e._currencyInstance.set(i),e._order.updateTotalOrderAmount()})},_updatePricesOnOrderItems:function(e){var t=[],n=this;e.each(function(e){var i={},r=e.get("variantId")+n._currencyInstance.getCurrencyCode();i.currency=n._currencyInstance.toJSON(),i.variantId=e.get("variantId"),i.priceId=r,t.push(i)}),this._pricesCollection.addPriceToModels(t,n._currencyInstance,e)},_handleOrderError:function(e,t,n){var i={responseText:t.responseJSON,responseStatus:t.status,orderId:e.get("id"),paymentProvider:e.getPaymentProvider(),paymentMethod:e.getPaymentMethod()};o.event("Purchase","Order Error",JSON.stringify(i)),this.pubSub.publish(s.ORDER_ERROR,{model:e,response:t})},_handleOrderFailed:function(e){this.pubSub.publish(s.ORDER_PLACE_ERROR,e)},_handleOrderSucceeded:function(e){this.pubSub.publish(s.ORDER_PLACE_SUCCESS,e)},_handleOrderProcessing:function(e){this.pubSub.publish(s.ORDER_PLACE_PROCESSING,e)},_addOrderItemsFromConfig:function(e){var t=i&&i.order.items?i.order.items:null;t&&this._addOrderItems(e,t)},_addOrderItems:function(e,t){var n;n=this._orderItemsCollection,t&&(n.add(t),e.set("displayItems",n))},_addPaymentInfo:function(e,t,n){var i,r;if(i=l.getInstance().findWhere({method:t.method}))i.get("provider")===g.PAYMENT_PROVIDER_SKRILL&&this._addSkrillPaymentProperties(e,t,this.paymentProviderSkrill),i.get("provider")===g.PAYMENT_PROVIDER_ADYEN&&this._addAdyenPaymentProperties(e,t,this.paymentProviderAdyen);else{var s={nonce:t.method,clientFingerprint:t.device_data,storeInVault:t.storeInVault};t.billingAddress&&t.billingAddress.postalCode&&t.billingAddress.countryCode&&(s.billingAddress=t.billingAddress),r=new h(s),e.set({creditCard:r.toJSON(),provider:"braintree"})}return t.brazilFirstName&&t.brazilLastName&&t.brazilZipCode&&(e.addOrderProperty("brazilFirstName",t.brazilFirstName),e.addOrderProperty("brazilLastName",t.brazilLastName),e.addOrderProperty("brazilZipCode",t.brazilZipCode)),n&&e.set("agent",n.agent),e.set({clientFingerprint:t.device_data}),e},_addSkrillPaymentProperties:function(e,t,n){var i=t.user;e.set({provider:"skrill"}),e.addOrderProperty("skrillPaymentMethod",t.method),e.addOrderProperty("skrillCountryCode",i.get("countryCode")),e.addOrderProperty("skrillRecipientDescription",n.recipientDescription),e.addOrderProperty("skrillReturnUrl",n.returnUrl),e.addOrderProperty("skrillCancelUrl",n.cancelUrl+e.id),e.addOrderProperty("skrillLogoUrl",n.logoUrl)},_addAdyenPaymentProperties:function(e,t,n){e.set({provider:"adyen"}),e.addOrderProperty("adyenBrandCode",t.method),e.addOrderProperty("adyenSkinCode",n.skinCode)},_handleOrderStatus:function(e){var t=e.get("status");t===g.ORDER_STATUS_FAILED&&this._handleOrderFailed(e),t===g.ORDER_STATUS_SUCCEEDED&&this._handleOrderSucceeded(e),t===g.ORDER_STATUS_PROCESSING&&this._handleOrderProcessing(e)},createOrder:function(){var e=new u;return e.addOrderProperty("userCountry",i.user.countryCode),e.addOrderProperty("userLanguage",this._user.getLanguageTag()),this._user.on("change:countryCode",function(t){e.updateUserCountry(t.get("countryCode"))},this),e.set("items",new p),this._order=e,this._addOrderItemsFromConfig(e),e},createAdyenOrder:function(e){var t=new d(e);return this._order=t,t},getOrder:function(){var e=this._order;return e||(e=this.createOrder()),e},removeOrder:function(){this._order&&(this._order=null,this._orderItemsCollection.reset(),this._pricesCollection.reset())},processPaymentTransaction:function(e,t){t.set("id",e),t.on({change:r.bind(this._onOrderProcessed,this)}),t.fetchOrder()},placeOrder:function(e,t,n){var s={method:n.paymentMethod,storeInVault:"true"===n.storeInVault,device_data:n.device_data,billingAddress:{postalCode:n.postalCode,countryCode:n.countryCode},user:e,brazilFirstName:n.brazilFirstName,brazilLastName:n.brazilLastName,brazilZipCode:n.brazilZipCode},o=i&&i.order?i.order:null,a=t.prepareOrder();this._addPaymentInfo(a,s,o),a.once({change:r.bind(this._onOrderPlaced,this),error:r.bind(this._handleOrderError,this)}),a.placeOrder()},_onOrderPlaced:function(e){o.event("Purchase","Placed Order - "+(e.getPaymentProvider()||""),e.getPaymentMethod()||""),this._handleOrderStatus(e)},_onOrderProcessed:function(e){this._handleOrderStatus(e)}});g.ORDER_STATUS_SUCCEEDED="SUCCEEDED",g.ORDER_STATUS_FAILED="FAILED",g.ORDER_STATUS_PROCESSING="PROCESSING",g.PAYMENT_PROVIDER_ADYEN="adyen",g.PAYMENT_PROVIDER_SKRILL="skrill",n.exports=g}),define("hbs!packages/checkout/templates/paymentMethods/adyenPaymentForm",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression
;return'<input type="hidden" name="merchantSig" value="'+o((r=null!=(r=t.adyenMerchantSig||(null!=e?e.adyenMerchantSig:e))?r:s,"function"==typeof r?r.call(e,{name:"adyenMerchantSig",hash:{},data:i}):r))+'" />\n<input type="hidden" name="brandCode" value="'+o((r=null!=(r=t.adyenBrandCode||(null!=e?e.adyenBrandCode:e))?r:s,"function"==typeof r?r.call(e,{name:"adyenBrandCode",hash:{},data:i}):r))+'" />\n<input type="hidden" name="sessionValidity" value="'+o((r=null!=(r=t.adyenSessionValidity||(null!=e?e.adyenSessionValidity:e))?r:s,"function"==typeof r?r.call(e,{name:"adyenSessionValidity",hash:{},data:i}):r))+'" />\n<input type="hidden" name="shopperLocale" value="'+o((r=null!=(r=t.userLanguage||(null!=e?e.userLanguage:e))?r:s,"function"==typeof r?r.call(e,{name:"userLanguage",hash:{},data:i}):r))+'" />\n<input type="hidden" name="countryCode" value="'+o((r=null!=(r=t.countryCode||(null!=e?e.countryCode:e))?r:s,"function"==typeof r?r.call(e,{name:"countryCode",hash:{},data:i}):r))+'" />\n<input type="hidden" name="merchantAccount" value="'+o((r=null!=(r=t.adyenMerchantAccount||(null!=e?e.adyenMerchantAccount:e))?r:s,"function"==typeof r?r.call(e,{name:"adyenMerchantAccount",hash:{},data:i}):r))+'" />\n<input type="hidden" name="paymentAmount" value="'+o((r=null!=(r=t.adyenPaymentAmount||(null!=e?e.adyenPaymentAmount:e))?r:s,"function"==typeof r?r.call(e,{name:"adyenPaymentAmount",hash:{},data:i}):r))+'" />\n<input type="hidden" name="currencyCode" value="'+o((r=null!=(r=t.currencyCode||(null!=e?e.currencyCode:e))?r:s,"function"==typeof r?r.call(e,{name:"currencyCode",hash:{},data:i}):r))+'" />\n<input type="hidden" name="skinCode" value="'+o((r=null!=(r=t.adyenSkinCode||(null!=e?e.adyenSkinCode:e))?r:s,"function"==typeof r?r.call(e,{name:"adyenSkinCode",hash:{},data:i}):r))+'" />\n<input type="hidden" name="merchantReference" value="'+o((r=null!=(r=t.orderID||(null!=e?e.orderID:e))?r:s,"function"==typeof r?r.call(e,{name:"orderID",hash:{},data:i}):r))+'" />\n<input type="hidden" name="shopperReference" value="'+o((r=null!=(r=t.userId||(null!=e?e.userId:e))?r:s,"function"==typeof r?r.call(e,{name:"userId",hash:{},data:i}):r))+'" />\n<input type="hidden" name="shopperEmail" value="'+o((r=null!=(r=t.userEmail||(null!=e?e.userEmail:e))?r:s,"function"==typeof r?r.call(e,{name:"userEmail",hash:{},data:i}):r))+'" />'},useData:!0})}),define("packages/checkout/views/paymentMethods/adyenPaymentForm",["require","exports","module","core/view","app-config","hbs!packages/checkout/templates/paymentMethods/adyenPaymentForm"],function(e,t,n){"use strict";var i=e("core/view"),r=e("app-config"),s=e("hbs!packages/checkout/templates/paymentMethods/adyenPaymentForm"),o=i.extend({tagName:"form",attributes:function(){return{action:r.adyen.hostedPaymentPages||"https://test.adyen.com/hpp/details.shtml"}},template:s});n.exports=o}),define("packages/checkout/models/existingOrderModel",["require","exports","module","underscore","env","core/analytics","core/model","core/order-mixins"],function(e,t,n){"use strict";var i=e("underscore"),r=e("env"),s=e("core/analytics"),o=e("core/model"),a=e("core/order-mixins"),l=o.extend(i.extend({defaults:{},initialize:function(e){this._setUrl()},_setUrl:function(){this.url=r.getEndpoint("getOrder",{id:this.get("id")})},cancelOrder:function(){this.set("cancelling",!0),this.destroy({beforeSend:i.bind(this._setAuthentication,this),wait:!0,success:function(e){s.event("Existing order","Cancel order - "+e.getPaymentProvider(),e.getPaymentMethod())},error:function(e,t,n){s.event("Existing order","Unable to cancel order - "+e.getPaymentProvider(),e.getPaymentMethod()),e.set("errorMessage",t.responseJSON.errorMessage),e.set("cancelling",!1)}})}},a));n.exports=l}),define("packages/checkout/collections/existingOrdersCollection",["require","exports","module","underscore","core/collection","packages/checkout/models/existingOrderModel","env"],function(e,t,n){"use strict";var i=e("underscore"),r=e("core/collection"),s=e("packages/checkout/models/existingOrderModel"),o=e("env"),a=r.extend({model:s,url:o.getEndpoint("orders"),fetchOrders:function(){var e={status:["PROCESSING","UNKNOWN"],variantIds:["minecraft"]};this.fetch({beforeSend:i.bind(this._setAuthentication,this),type:"post",contentType:"application/json",data:JSON.stringify(e)})}});n.exports=a}),define("hbs!packages/checkout/templates/existingOrders",["handlebars"],function(e){return e.template({1:function(e,t,n,i){return"You can't place a new %1$s order before your pending order has been completed or cancelled."},3:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a='    <div class="col-md-6">\n        <p>'+o((t.gettext||e&&e.gettext||s).call(e,"Order reference:",{name:"gettext",hash:{},data:i}))+" "+o((t.ellipsis||e&&e.ellipsis||s).call(e,null!=e?e.id:e,18,"...",{name:"ellipsis",hash:{},data:i}))+'</p>\n    </div>\n    <div class="col-md-6 text-right">\n        <p>\n';return r=t.if.call(e,null!=e?e.cancelling:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.program(6,i),data:i}),null!=r&&(a+=r),a+="        </p>\n    </div>\n",r=t.if.call(e,null!=e?e.errorMessage:e,{name:"if",hash:{},fn:this.program(9,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+='    <div class="col-sm-12">\n        <p class="small">'+o((t.gettext||e&&e.gettext||s).call(e,"If you paid using a delayed payment method (bank transfer) you may need to wait until the order has been fully processed.",{name:"gettext",hash:{},data:i}))+'</p>\n        <p class="text-right">',r=(t.button||e&&e.button||s).call(e,"seeStatusOrOrderClick",{name:"button",hash:{class:"btn btn-default"},fn:this.program(12,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+"</p>\n    </div>\n"},4:function(e,t,n,i){var r=t.helperMissing;return'          <button disabled class="btn btn-warning existing-orders__cancel-order-btn">'+(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Cancelling order...",{name:"gettext",hash:{},data:i}))+"</button>\n"},6:function(e,t,n,i){var r,s=t.helperMissing,o="          ";return r=(t.button||e&&e.button||s).call(e,"cancelOrderButtonClick",{name:"button",hash:{class:"btn btn-warning existing-orders__cancel-order-btn"},fn:this.program(7,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"\n"},7:function(e,t,n,i){var r=t.helperMissing;return" "+(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Cancel pending order",{name:"gettext",hash:{},data:i}))},9:function(e,t,n,i){var r,s=t.helperMissing,o='        <div class="col-sm-12">\n            <p class="alert alert-danger">';return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.id:e,{name:"gettext_block",hash:{},fn:this.program(10,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"</p>\n        </div>\n"},10:function(e,t,n,i){return"We were unable to cancel this order. Please retry in 10 minutes. If the problem persists, please contact Mojang Support. Order reference: %1$s"},12:function(e,t,n,i){var r=t.helperMissing;return" "+(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Continue",{name:"gettext",hash:{},data:i}))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o='<p class="lead">';return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.productName:e,{name:"gettext_block",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+="</p>\n\n",r=(t.collection||e&&e.collection||s).call(e,{name:"collection",hash:{class:"row"},fn:this.program(3,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"\n\n\n\n\n\n"},useData:!0})}),define("packages/checkout/views/existingOrdersView",["require","exports","module","app-config","core/view","hbs!packages/checkout/templates/existingOrders"],function(e,t,n){"use strict";var i=e("app-config"),r=e("core/view"),s=e("hbs!packages/checkout/templates/existingOrders"),o=r.extend({template:s,className:"existing-orders",productName:i.productName,initialize:function(e){},cancelOrderButtonClick:function(e){var t=$(e.target).model();t&&this.controller.cancelOngoingOrder(t)},seeStatusOrOrderClick:function(e){var t=$(e.target).model();t&&this.controller.continueWithOngoingOrder(t)}});n.exports=o}),define("hbs!packages/checkout/templates/existingOrdersDialog",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return'<div class="modal-header">\n    <h4 class="modal-title">'+o((r=null!=(r=t.dialogTitle||(null!=e?e.dialogTitle:e))?r:s,"function"==typeof r?r.call(e,{name:"dialogTitle",hash:{},data:i}):r))+'</h4>\n</div>\n<div class="modal-body">\n  '+o((t.view||e&&e.view||s).call(e,null!=e?e.existingOrdersView:e,{name:"view",hash:{},data:i}))+"\n</div>\n\n"},useData:!0})}),define("packages/checkout/views/existingOrdersDialog",["require","exports","module","core/dialogs/base-dialog","hbs!packages/checkout/templates/existingOrdersDialog","i18n"],function(e,t,n){"use strict";var i=e("core/dialogs/base-dialog"),r=e("hbs!packages/checkout/templates/existingOrdersDialog"),s=e("i18n"),o=i.extend({className:"existing-orders-dialog",template:r,dialogTitle:s.gettext("You have a pending order"),existingOrdersView:null,animate:!0,setView:function(e){this.existingOrdersView=e,this.render()}});n.exports=o}),define("packages/checkout/controllers/checkoutController",["require","exports","module","underscore","appPubSubTopics","core/controller","packages/checkout/views/paymentMethods/adyenPaymentForm","packages/checkout/collections/existingOrdersCollection","packages/checkout/views/existingOrdersView","packages/checkout/views/existingOrdersDialog","core/collection","core/analytics"],function(e,t,n){"use strict";var i=e("underscore"),r=e("appPubSubTopics"),s=e("core/controller"),o=e("packages/checkout/views/paymentMethods/adyenPaymentForm"),a=e("packages/checkout/collections/existingOrdersCollection"),l=e("packages/checkout/views/existingOrdersView"),c=e("packages/checkout/views/existingOrdersDialog"),u=e("core/collection"),d=e("core/analytics"),h=s.extend({view:void 0,orderController:void 0,user:void 0,initialize:function(e){this.user=e.user,this._initSubscribers()},_initSubscribers:function(){this.pubSub.subscribe(r.ORDER_ERROR,i.bind(this._onOrderError,this)),this.pubSub.subscribe(r.ORDER_PLACE_ERROR,i.bind(this._onOrderFailed,this)),this.pubSub.subscribe(r.ORDER_PLACE_SUCCESS,i.bind(this._onOrderSuccess,this)),this.pubSub.subscribe(r.ORDER_PLACE_PROCESSING,i.bind(this._onOrderProcessing,this))},_navigateAfterSuccess:function(e){var t=e?"download/"+e:"download";Backbone.history.navigate(t,{trigger:!0})},_navigateAfterExistingOrderContinue:function(e){var t=e?"order/status/"+e:"buy";Backbone.history.navigate(t,{trigger:!0})},placeOrder:function(e,t){var n,i,r,s;n=this.orderController,s={},r=this.user,i=n.getOrder(),s.paymentMethod=e,s.device_data=t.device_data,s.storeInVault=t["store-in-vault"],s.postalCode=t["postal-code"],s.countryCode=t["country-code"],s.brazilFirstName=t.brazilFirstName,s.brazilLastName=t.brazilLastName,s.brazilZipCode=t.brazilZipCode,n.placeOrder(r,i,s)},checkExistingOrders:function(){var e,t,n=new a;n.on("reset",function(n){var i,s,o;n.isEmpty()||(e=new l({collection:n,controller:this}),t=new c,t.setView(e),i=n.first(),s=i.getPaymentProvider(),o=i.getPaymentMethod(),d.event("Existing order","Has existing order - "+s,o),this.pubSub.publish(r.SHOW_MODAL,{view:t}))},this),n.on("remove",function(e,t){t.isEmpty()&&this.pubSub.publish(r.HIDE_MODAL)},this),n.fetchOrders()},cancelOngoingOrder:function(e){e.cancelOrder()},continueWithOngoingOrder:function(e){d.event("Existing order","Continue order - "+e.getPaymentProvider(),e.getPaymentMethod()),this.pubSub.publish(r.HIDE_MODAL),this._navigateAfterExistingOrderContinue(e.get("id"))},_onOrderError:function(e,t){var n={errorTitle:t.model._getOrderProcessingErrorTitle(t.response),errorMessage:t.model._getOrderProcessingErrorMessage(t.response),response:t.response};this.view&&this.view.trigger("order_error",n)},_onOrderFailed:function(){this.view&&this.view.trigger("order_failed")},_onOrderSuccess:function(e,t){this.view&&this.view.trigger("order_success"),this.pubSub.publish(r.PROGRESS_UPDATE,{id:"Buy",resolved:!0}),this._navigateAfterSuccess(t.get("id"))},_onOrderProcessing:function(e,t){var n,r;n=t.get("properties"),"skrill"===t.get("provider")&&(r=i.findWhere(n,{name:"skrillPaymentUrl"}),window.location=r.value),"adyen"===t.get("provider")&&this._proccessAdyenOrder(t,this.user)},_proccessAdyenOrder:function(e,t){var n,i,r,s;n=new u(e.get("properties"));var a=n.findWhere({name:"userLanguage"}).get("value");a&&(a=a.replace("-","_")),s={currencyCode:e.get("currency").currencyCode,orderID:e.id,userId:t.getUserId(),userEmail:t.getEmail(),adyenMerchantSig:n.findWhere({name:"adyenMerchantSig"}).get("value"),adyenBrandCode:n.findWhere({name:"adyenBrandCode"}).get("value"),userLanguage:a,countryCode:n.findWhere({name:"userCountry"}).get("value"),adyenSessionValidity:n.findWhere({name:"adyenSessionValidity"}).get("value"),adyenMerchantAccount:n.findWhere({name:"adyenMerchantAccount"}).get("value"),adyenPaymentAmount:n.findWhere({name:"adyenPaymentAmount"}).get("value"),adyenSkinCode:n.findWhere({name:"adyenSkinCode"}).get("value")},i=new o(s),r=this.view.parent,i.on("ready",function(e){e.target.$el.submit()},this),r.setView(i)}});n.exports=h}),define("packages/order-flow/views/layouts/rootLayoutView",["require","exports","module","core/root-layout-view"],function(e,t,n){"use strict";var i,r=e("core/root-layout-view"),s=r.extend({});s.getInstance=function(e){return i||(i=new s,i.onLoad(e),i.appendTo(e||document.body)),i},n.exports=s}),define("hbs!components/loader/templates/loader",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r,s=t.helperMissing;return" "+(0,this.escapeExpression)((r=null!=(r=t.loadingMessage||(null!=e?e.loadingMessage:e))?r:s,"function"==typeof r?r.call(e,{name:"loadingMessage",hash:{},data:i}):r))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s="";return r=t.if.call(e,null!=e?e.loading:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(s+=r),s},useData:!0})}),define("components/loader/views/loaderView",["require","exports","module","core/view","hbs!components/loader/templates/loader"],function(e,t,n){"use strict";var i=e("core/view"),r=e("hbs!components/loader/templates/loader"),s=i.extend({template:r,className:"loader loader--loading",initialize:function(){},startLoader:function(e){e&&(this.loadingMessage=e),this.loading=!0,this.$el.addClass("loader--loading"),this.render()},stopLoader:function(){this.loading=!1,this.$el.removeClass("loader--loading"),this.render()}});n.exports=s}),define("hbs!core/dialogs/templates/loader-dialog",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing;return'<div class="modal-body">\n  <div class="loader loader--loading">\n    <p class="loader__message h3 text-center">'+(0,this.escapeExpression)((r=null!=(r=t.loaderMessage||(null!=e?e.loaderMessage:e))?r:s,"function"==typeof r?r.call(e,{name:"loaderMessage",hash:{},data:i}):r))+"</p>\n  </div>\n</div>\n"},useData:!0})}),define("core/dialogs/loader-dialog",["require","exports","module","i18n","pubsub","core/model","core/dialogs/base-dialog","hbs!core/dialogs/templates/loader-dialog","appPubSubTopics"],function(e,t,n){"use strict";var i=e("i18n"),r=e("pubsub"),s=e("core/model"),o=e("core/dialogs/base-dialog"),a=e("hbs!core/dialogs/templates/loader-dialog"),l=e("appPubSubTopics"),c=o.extend({className:"loader-dialog",template:a,model:new s,pubSub:r,initialize:function(e){var t=e&&e.message?e.message:i.gettext("Loading...");this.model.set("loaderMessage",t)},start:function(){this.pubSub.publish(l.SHOW_MODAL,{view:this,options:{keyboard:!1}})},stop:function(){this.pubSub.publish(l.HIDE_MODAL)}});n.exports=c}),define("hbs!packages/order/templates/order",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r=t.helperMissing;return'    <h3 class="text-info loader">'+(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Placing you order",{name:"gettext",hash:{},data:i}))+"</h3>\n"},3:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return'    <tr class="order-item">\n        <td class="order-item__image"><img src="'+o((r=null!=(r=t.image||(null!=e?e.image:e))?r:s,"function"==typeof r?r.call(e,{name:"image",hash:{},data:i}):r))+'" alt="'+o((t.gettext||e&&e.gettext||s).call(e,"Product image,",{name:"gettext",hash:{},data:i}))+" "+o((r=null!=(r=t.displayName||(null!=e?e.displayName:e))?r:s,"function"==typeof r?r.call(e,{name:"displayName",hash:{},data:i}):r))+'"></td>\n        <td class="order-item__name">'+o((r=null!=(r=t.displayName||(null!=e?e.displayName:e))?r:s,"function"==typeof r?r.call(e,{name:"displayName",hash:{},data:i}):r))+'</td>\n        <td class="order-item__amount">'+o((r=null!=(r=t.amount||(null!=e?e.amount:e))?r:s,"function"==typeof r?r.call(e,{name:"amount",hash:{},data:i}):r))+"</td>\n    </tr>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s,o,a=t.helperMissing,l=t.blockHelperMissing,c="\n";return s=null!=(s=t.loading||(null!=e?e.loading:e))?s:a,o={name:"loading",hash:{},fn:this.program(1,i),inverse:this.noop,data:i},r="function"==typeof s?s.call(e,o):s,t.loading||(r=l.call(e,r,o)),null!=r&&(c+=r),c+="\n\n",r=(t.collection||e&&e.collection||a).call(e,{name:"collection",hash:{class:"table order-items",tag:"table"},fn:this.program(3,i),inverse:this.noop,data:i}),null!=r&&(c+=r),c},useData:!0})}),define("packages/order/views/orderView",["require","exports","module","core/view","hbs!packages/order/templates/order"],function(e,t,n){"use strict";var i=e("core/view"),r=e("hbs!packages/order/templates/order"),s=i.extend({template:r,initialize:function(e){},events:{rendered:function(){},destroyed:function(){}}});n.exports=s}),define("hbs!packages/checkout/templates/payment",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return'<input type="hidden" id="selectedPaymentMethod" name="selected_payment_method"/>\n\n<h3>'+o((t.gettext||e&&e.gettext||s).call(e,"Payment options",{name:"gettext",hash:{},data:i}))+'</h3>\n\n\n<div class="row form-gutter">\n  <div class="form-group col-sm-6 col-md-4">\n    <h5>'+o((t.gettext||e&&e.gettext||s).call(e,"Country",{name:"gettext",hash:{},data:i}))+"</h5>\n    "+o((t.view||e&&e.view||s).call(e,null!=e?e.countrySelector:e,{name:"view",hash:{},data:i}))+"\n  </div>\n</div>\n\n"+o((t.view||e&&e.view||s).call(e,null!=e?e.brazilExtraFieldsView:e,{name:"view",hash:{},data:i}))+'\n\n<div class="form-group">\n  <h5>'+o((t.gettext||e&&e.gettext||s).call(e,"Payment method",{name:"gettext",hash:{},data:i}))+"</h5>\n  "+o((t.view||e&&e.view||s).call(e,null!=e?e.paymentMethodSelector:e,{name:"view",hash:{},data:i}))+"\n</div>\n\n<hr/>\n\n"+o((t.view||e&&e.view||s).call(e,null!=e?e.creditCardView:e,{name:"view",hash:{},data:i}))+"\n\n"+o((t.view||e&&e.view||s).call(e,null!=e?e.paypalView:e,{name:"view",hash:{},data:i}))+"\n\n"+o((r=null!=(r=t["layout-element"]||(null!=e?e["layout-element"]:e))?r:s,"function"==typeof r?r.call(e,{name:"layout-element",hash:{},data:i}):r))+"\n\n"},useData:!0})}),define("packages/checkout/views/paymentMethods/paymentBaseView",["require","exports","module","core/view"],function(e,t,n){"use strict";var i=e("core/view"),r=i.extend({events:{destroyed:function(){}},lockSubmitButton:function(){this.parent&&this.parent.trigger("purchase_button_disable")},unlockSubmitButton:function(){this.parent&&this.parent.trigger("purchase_button_enable")}});n.exports=r}),define("hbs!packages/checkout/templates/paymentMethods/paypal",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r,s=t.helperMissing;return'  <div class="alert alert-danger">\n    <p>'+(0,this.escapeExpression)((r=null!=(r=t.error||(null!=e?e.error:e))?r:s,"function"==typeof r?r.call(e,{name:"error",hash:{},data:i}):r))+"</p>\n  </div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a="<h3>"+o((t.gettext||e&&e.gettext||s).call(e,"Purchase using PayPal",{name:"gettext",hash:{},data:i}))+'</h3>\n\n<p class="paypal-intro">\n    '+o((t.gettext||e&&e.gettext||s).call(e,"To purchase using PayPal you first need to authorize this payment through your PayPal account. To do so, click the blue PayPal button below.",{name:"gettext",hash:{},data:i}))+"\n</p>\n\n"+o((t.view||e&&e.view||s).call(e,null!=e?e.loadingView:e,{name:"view",hash:{},data:i}))+"\n\n";return r=t.if.call(e,null!=e?e.error:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+'<div id="paypal-container"></div>\n\n'},useData:!0})}),define("packages/checkout/views/paymentMethods/paypalView",["require","exports","module","jquery","i18n","components/loader/views/loaderView","packages/checkout/views/paymentMethods/paymentBaseView","hbs!packages/checkout/templates/paymentMethods/paypal","braintree"],function(e,t,n){"use strict";var i=e("jquery"),r=e("i18n"),s=e("components/loader/views/loaderView"),o=e("packages/checkout/views/paymentMethods/paymentBaseView"),a=e("hbs!packages/checkout/templates/paymentMethods/paypal"),l=o.extend({className:"",id:"paypal",template:a,paymentToken:null,_paymentMethodRecieved:!1,loadingView:null,initialize:function(){this.loadingView=new s,this.loadingView.startLoader()},_handleError:function(e){this.context={error:e},this.render()},_toggleInstructions:function(){i(".paypal-intro").toggle()},_getPaypalLocale:function(){var e=this.locale;return e?(e=e.replace("-","_"),"da"===e?"da_dk":"de"===e?"de_de":"es"===e?"es_es":"fr"===e?"fr_fr":"it"===e?"it_it":"nl"===e?"nl_nl":"no"===e?"no_no":"pl"===e?"pl_pl":"sv"===e?"sv_se":"tr"===e?"tr_tr":e):"en_us"},setupBraintreePaypalButton:function(t){var n,s,o=this;return n=e("braintree"),s=i.Deferred(),n.setup(t,"paypal",{container:"paypal-container",singleUse:!0,locale:o._getPaypalLocale(),onPaymentMethodReceived:function(e){o._paymentMethodRecieved=!0,o.nonceModel.set(e),o._toggleInstructions(),o.unlockSubmitButton()},onCancelled:function(){o._toggleInstructions(),o.nonceModel.clear(),o._paymentMethodRecieved=!1,o.lockSubmitButton()},onUnsupported:function(){o._handleError(r.gettext("PayPal checkout is not supported by your web browser. Please choose a different payment option.")),o.loadingView.stopLoader()},onReady:function(e){o._payPalInitialized=!0,o.loadingView.stopLoader(),s.resolve()}}),s.promise()},activate:function(){this._paymentMethodRecieved||this.lockSubmitButton(),this.show()},deactivate:function(){this.unlockSubmitButton(),this.hide()}});n.exports=l}),define("packages/checkout/models/creditCardFormModel",["require","exports","module","i18n","core/model"],function(e,t,n){"use strict";var i=e("i18n"),r=e("core/model"),s=r.extend({defaults:{},validation:{"postal-code":{required:!0,msg:i.gettext("Postal / zip code is required.")},number:{required:!0,acceptance:!0,msg:i.gettext("Credit card number must be valid.")},expirationMonth:{required:!0,acceptance:!0,msg:i.gettext("Expiration month must be valid.")},expirationYear:{required:!0,acceptance:!0,msg:i.gettext("Expiration year must be valid.")},cvv:{required:!0,acceptance:!0,msg:i.gettext("CVV must be valid.")}},initialize:function(){}});n.exports=s}),function(e,t){"function"==typeof define&&define.amd?define("latinize",t):"object"==typeof exports?module.exports=t():e.latinize=t()}(this,function(){function e(t){return t.replace(/[^A-Za-z0-9]/g,function(t){return e.characters[t]||t})}return e.characters={"√Å":"A","ƒÇ":"A","·∫Æ":"A","·∫∂":"A","·∫∞":"A","·∫≤":"A","·∫¥":"A","«ç":"A","√Ç":"A","·∫§":"A","·∫¨":"A","·∫¶":"A","·∫®":"A","·∫™":"A","√Ñ":"A","«û":"A","»¶":"A","«†":"A","·∫†":"A","»Ä":"A","√Ä":"A","·∫¢":"A","»Ç":"A","ƒÄ":"A","ƒÑ":"A","√Ö":"A","«∫":"A","·∏Ä":"A","»∫":"A","√É":"A","Íú≤":"AA","√Ü":"AE","«º":"AE","«¢":"AE","Íú¥":"AO","Íú∂":"AU","Íú∏":"AV","Íú∫":"AV","Íúº":"AY","·∏Ç":"B","·∏Ñ":"B","∆Å":"B","·∏Ü":"B","…É":"B","∆Ç":"B","ƒÜ":"C","ƒå":"C","√á":"C","·∏à":"C","ƒà":"C","ƒä":"C","∆á":"C","»ª":"C","ƒé":"D","·∏ê":"D","·∏í":"D","·∏ä":"D","·∏å":"D","∆ä":"D","·∏é":"D","«≤":"D","«Ö":"D","ƒê":"D","∆ã":"D","«±":"DZ","«Ñ":"DZ","√â":"E","ƒî":"E","ƒö":"E","»®":"E","·∏ú":"E","√ä":"E","·∫æ":"E","·ªÜ":"E","·ªÄ":"E","·ªÇ":"E","·ªÑ":"E","·∏ò":"E","√ã":"E","ƒñ":"E","·∫∏":"E","»Ñ":"E","√à":"E","·∫∫":"E","»Ü":"E","ƒí":"E","·∏ñ":"E","·∏î":"E","ƒò":"E","…Ü":"E","·∫º":"E","·∏ö":"E","Íù™":"ET","·∏û":"F","∆ë":"F","«¥":"G","ƒû":"G","«¶":"G","ƒ¢":"G","ƒú":"G","ƒ†":"G","∆ì":"G","·∏†":"G","«§":"G","·∏™":"H","»û":"H","·∏®":"H","ƒ§":"H","‚±ß":"H","·∏¶":"H","·∏¢":"H","·∏§":"H","ƒ¶":"H","√ç":"I","ƒ¨":"I","«è":"I","√é":"I","√è":"I","·∏Æ":"I","ƒ∞":"I","·ªä":"I","»à":"I","√å":"I","·ªà":"I","»ä":"I","ƒ™":"I","ƒÆ":"I","∆ó":"I","ƒ®":"I","·∏¨":"I","Íùπ":"D","Íùª":"F","ÍùΩ":"G","ÍûÇ":"R","ÍûÑ":"S","ÍûÜ":"T","Íù¨":"IS","ƒ¥":"J","…à":"J","·∏∞":"K","«®":"K","ƒ∂":"K","‚±©":"K","ÍùÇ":"K","·∏≤":"K","∆ò":"K","·∏¥":"K","ÍùÄ":"K","ÍùÑ":"K","ƒπ":"L","»Ω":"L","ƒΩ":"L","ƒª":"L","·∏º":"L","·∏∂":"L","·∏∏":"L","‚±†":"L","Íùà":"L","·∏∫":"L","ƒø":"L","‚±¢":"L","«à":"L","≈Å":"L","«á":"LJ","·∏æ":"M","·πÄ":"M","·πÇ":"M","‚±Æ":"M","≈É":"N","≈á":"N","≈Ö":"N","·πä":"N","·πÑ":"N","·πÜ":"N","«∏":"N","∆ù":"N","·πà":"N","»†":"N","«ã":"N","√ë":"N","«ä":"NJ","√ì":"O","≈é":"O","«ë":"O","√î":"O","·ªê":"O","·ªò":"O","·ªí":"O","·ªî":"O","·ªñ":"O","√ñ":"O","»™":"O","»Æ":"O","»∞":"O","·ªå":"O","≈ê":"O","»å":"O","√í":"O","·ªé":"O","∆†":"O","·ªö":"O","·ª¢":"O","·ªú":"O","·ªû":"O","·ª†":"O","»é":"O","Íùä":"O","Íùå":"O","≈å":"O","·πí":"O","·πê":"O","∆ü":"O","«™":"O","«¨":"O","√ò":"O","«æ":"O","√ï":"O","·πå":"O","·πé":"O","»¨":"O","∆¢":"OI","Íùé":"OO","∆ê":"E","∆Ü":"O","»¢":"OU","·πî":"P","·πñ":"P","Íùí":"P","∆§":"P","Íùî":"P","‚±£":"P","Íùê":"P","Íùò":"Q","Íùñ":"Q","≈î":"R","≈ò":"R","≈ñ":"R","·πò":"R","·πö":"R","·πú":"R","»ê":"R","»í":"R","·πû":"R","…å":"R","‚±§":"R","Íúæ":"C","∆é":"E","≈ö":"S","·π§":"S","≈†":"S","·π¶":"S","≈û":"S","≈ú":"S","»ò":"S","·π†":"S","·π¢":"S","·π®":"S","√ü":"ss","≈§":"T","≈¢":"T","·π∞":"T","»ö":"T","»æ":"T","·π™":"T","·π¨":"T","∆¨":"T","·πÆ":"T","∆Æ":"T","≈¶":"T","‚±Ø":"A","ÍûÄ":"L","∆ú":"M","…Ö":"V","Íú®":"TZ","√ö":"U","≈¨":"U","«ì":"U","√õ":"U","·π∂":"U","√ú":"U","«ó":"U","«ô":"U","«õ":"U","«ï":"U","·π≤":"U","·ª§":"U","≈∞":"U","»î":"U","√ô":"U","·ª¶":"U","∆Ø":"U","·ª®":"U","·ª∞":"U","·ª™":"U","·ª¨":"U","·ªÆ":"U","»ñ":"U","≈™":"U","·π∫":"U","≈≤":"U","≈Æ":"U","≈®":"U","·π∏":"U","·π¥":"U","Íùû":"V","·πæ":"V","∆≤":"V","·πº":"V","Íù†":"VY","·∫Ç":"W","≈¥":"W","·∫Ñ":"W","·∫Ü":"W","·∫à":"W","·∫Ä":"W","‚±≤":"W","·∫å":"X","·∫ä":"X","√ù":"Y","≈∂":"Y","≈∏":"Y","·∫é":"Y","·ª¥":"Y","·ª≤":"Y","∆≥":"Y","·ª∂":"Y","·ªæ":"Y","»≤":"Y","…é":"Y","·ª∏":"Y","≈π":"Z","≈Ω":"Z","·∫ê":"Z","‚±´":"Z","≈ª":"Z","·∫í":"Z","»§":"Z","·∫î":"Z","∆µ":"Z","ƒ≤":"IJ","≈í":"OE","·¥Ä":"A","·¥Å":"AE"," ô":"B","·¥É":"B","·¥Ñ":"C","·¥Ö":"D","·¥á":"E","Íú∞":"F","…¢":"G"," õ":"G"," ú":"H","…™":"I"," Å":"R","·¥ä":"J","·¥ã":"K"," ü":"L","·¥å":"L","·¥ç":"M","…¥":"N","·¥è":"O","…∂":"OE","·¥ê":"O","·¥ï":"OU","·¥ò":"P"," Ä":"R","·¥é":"N","·¥ô":"R","Íú±":"S","·¥õ":"T","‚±ª":"E","·¥ö":"R","·¥ú":"U","·¥†":"V","·¥°":"W"," è":"Y","·¥¢":"Z","√°":"a","ƒÉ":"a","·∫Ø":"a","·∫∑":"a","·∫±":"a","·∫≥":"a","·∫µ":"a","«é":"a","√¢":"a","·∫•":"a","·∫≠":"a","·∫ß":"a","·∫©":"a","·∫´":"a","√§":"a","«ü":"a","»ß":"a","«°":"a","·∫°":"a","»Å":"a","√†":"a","·∫£":"a","»É":"a","ƒÅ":"a","ƒÖ":"a","·∂è":"a","·∫ö":"a","√•":"a","«ª":"a","·∏Å":"a","‚±•":"a","√£":"a","Íú≥":"aa","√¶":"ae","«Ω":"ae","«£":"ae","Íúµ":"ao","Íú∑":"au","Íúπ":"av","Íúª":"av","ÍúΩ":"ay","·∏É":"b","·∏Ö":"b","…ì":"b","·∏á":"b","·µ¨":"b","·∂Ä":"b","∆Ä":"b","∆É":"b","…µ":"o","ƒá":"c","ƒç":"c","√ß":"c","·∏â":"c","ƒâ":"c","…ï":"c","ƒã":"c","∆à":"c","»º":"c","ƒè":"d","·∏ë":"d","·∏ì":"d","»°":"d","·∏ã":"d","·∏ç":"d","…ó":"d","·∂ë":"d","·∏è":"d","·µ≠":"d","·∂Å":"d","ƒë":"d","…ñ":"d","∆å":"d","ƒ±":"i","»∑":"j","…ü":"j"," Ñ":"j","«≥":"dz","«Ü":"dz","√©":"e","ƒï":"e","ƒõ":"e","»©":"e","·∏ù":"e","√™":"e","·∫ø":"e","·ªá":"e","·ªÅ":"e","·ªÉ":"e","·ªÖ":"e","·∏ô":"e","√´":"e","ƒó":"e","·∫π":"e","»Ö":"e","√®":"e","·∫ª":"e","»á":"e","ƒì":"e","·∏ó":"e","·∏ï":"e","‚±∏":"e","ƒô":"e","·∂í":"e","…á":"e","·∫Ω":"e","·∏õ":"e","Íù´":"et","·∏ü":"f","∆í":"f","·µÆ":"f","·∂Ç":"f","«µ":"g","ƒü":"g","«ß":"g","ƒ£":"g","ƒù":"g","ƒ°":"g","…†":"g","·∏°":"g","·∂É":"g","«•":"g","·∏´":"h","»ü":"h","·∏©":"h","ƒ•":"h","‚±®":"h","·∏ß":"h","·∏£":"h","·∏•":"h","…¶":"h","·∫ñ":"h","ƒß":"h","∆ï":"hv","√≠":"i","ƒ≠":"i","«ê":"i","√Æ":"i","√Ø":"i","·∏Ø":"i","·ªã":"i","»â":"i","√¨":"i","·ªâ":"i","»ã":"i","ƒ´":"i","ƒØ":"i","·∂ñ":"i","…®":"i","ƒ©":"i","·∏≠":"i","Íù∫":"d","Íùº":"f","·µπ":"g","ÍûÉ":"r","ÍûÖ":"s","Íûá":"t","Íù≠":"is","«∞":"j","ƒµ":"j"," ù":"j","…â":"j","·∏±":"k","«©":"k","ƒ∑":"k","‚±™":"k","ÍùÉ":"k","·∏≥":"k","∆ô":"k","·∏µ":"k","·∂Ñ":"k","ÍùÅ":"k","ÍùÖ":"k","ƒ∫":"l","∆ö":"l","…¨":"l","ƒæ":"l","ƒº":"l","·∏Ω":"l","»¥":"l","·∏∑":"l","·∏π":"l","‚±°":"l","Íùâ":"l","·∏ª":"l","≈Ä":"l","…´":"l","·∂Ö":"l","…≠":"l","≈Ç":"l","«â":"lj","≈ø":"s","·∫ú":"s","·∫õ":"s","·∫ù":"s","·∏ø":"m","·πÅ":"m","·πÉ":"m","…±":"m","·µØ":"m","·∂Ü":"m","≈Ñ":"n","≈à":"n","≈Ü":"n","·πã":"n","»µ":"n","·πÖ":"n","·πá":"n","«π":"n","…≤":"n","·πâ":"n","∆û":"n","·µ∞":"n","·∂á":"n","…≥":"n","√±":"n","«å":"nj","√≥":"o","≈è":"o","«í":"o","√¥":"o","·ªë":"o","·ªô":"o","·ªì":"o","·ªï":"o","·ªó":"o","√∂":"o","»´":"o","»Ø":"o","»±":"o","·ªç":"o","≈ë":"o","»ç":"o","√≤":"o","·ªè":"o","∆°":"o","·ªõ":"o","·ª£":"o","·ªù":"o","·ªü":"o","·ª°":"o","»è":"o","Íùã":"o","Íùç":"o","‚±∫":"o","≈ç":"o","·πì":"o","·πë":"o","«´":"o","«≠":"o","√∏":"o","«ø":"o","√µ":"o","·πç":"o","·πè":"o","»≠":"o","∆£":"oi","Íùè":"oo","…õ":"e","·∂ì":"e","…î":"o","·∂ó":"o","»£":"ou","·πï":"p","·πó":"p","Íùì":"p","∆•":"p","·µ±":"p","·∂à":"p","Íùï":"p","·µΩ":"p","Íùë":"p","Íùô":"q"," †":"q","…ã":"q","Íùó":"q","≈ï":"r","≈ô":"r","≈ó":"r","·πô":"r","·πõ":"r","·πù":"r","»ë":"r","…æ":"r","·µ≥":"r","»ì":"r","·πü":"r","…º":"r","·µ≤":"r","·∂â":"r","…ç":"r","…Ω":"r","‚ÜÑ":"c","Íúø":"c","…ò":"e","…ø":"r","≈õ":"s","·π•":"s","≈°":"s","·πß":"s","≈ü":"s","≈ù":"s","»ô":"s","·π°":"s","·π£":"s","·π©":"s"," Ç":"s","·µ¥":"s","·∂ä":"s","»ø":"s","…°":"g","·¥ë":"o","·¥ì":"o","·¥ù":"u","≈•":"t","≈£":"t","·π±":"t","»õ":"t","»∂":"t","·∫ó":"t","‚±¶":"t","·π´":"t","·π≠":"t","∆≠":"t","·πØ":"t","·µµ":"t","∆´":"t"," à":"t","≈ß":"t","·µ∫":"th","…ê":"a","·¥Ç":"ae","«ù":"e","·µ∑":"g","…•":"h"," Æ":"h"," Ø":"h","·¥â":"i"," û":"k","ÍûÅ":"l","…Ø":"m","…∞":"m","·¥î":"oe","…π":"r","…ª":"r","…∫":"r","‚±π":"r"," á":"t"," å":"v"," ç":"w"," é":"y","Íú©":"tz","√∫":"u","≈≠":"u","«î":"u","√ª":"u","·π∑":"u","√º":"u","«ò":"u","«ö":"u","«ú":"u","«ñ":"u","·π≥":"u","·ª•":"u","≈±":"u","»ï":"u","√π":"u","·ªß":"u","∆∞":"u","·ª©":"u","·ª±":"u","·ª´":"u","·ª≠":"u","·ªØ":"u","»ó":"u","≈´":"u","·πª":"u","≈≥":"u","·∂ô":"u","≈Ø":"u","≈©":"u","·ππ":"u","·πµ":"u","·µ´":"ue","Íù∏":"um","‚±¥":"v","Íùü":"v","·πø":"v"," ã":"v","·∂å":"v","‚±±":"v","·πΩ":"v","Íù°":"vy","·∫É":"w","≈µ":"w","·∫Ö":"w","·∫á":"w","·∫â":"w","·∫Å":"w","‚±≥":"w","·∫ò":"w","·∫ç":"x","·∫ã":"x","·∂ç":"x","√Ω":"y","≈∑":"y","√ø":"y","·∫è":"y","·ªµ":"y","·ª≥":"y","∆¥":"y","·ª∑":"y","·ªø":"y","»≥":"y","·∫ô":"y","…è":"y","·ªπ":"y","≈∫":"z","≈æ":"z","·∫ë":"z"," ë":"z","‚±¨":"z","≈º":"z","·∫ì":"z","»•":"z","·∫ï":"z","·µ∂":"z","·∂é":"z"," ê":"z","∆∂":"z","…Ä":"z","Ô¨Ä":"ff","Ô¨É":"ffi","Ô¨Ñ":"ffl","Ô¨Å":"fi","Ô¨Ç":"fl","ƒ≥":"ij","≈ì":"oe","Ô¨Ü":"st","‚Çê":"a","‚Çë":"e","·µ¢":"i","‚±º":"j","‚Çí":"o","·µ£":"r","·µ§":"u","·µ•":"v","‚Çì":"x"},e}),define("components/country-selector/collections/countriesCollection",["require","exports","module","i18n","env","core/collection","core/dialogs/error-dialog","pubsub","appPubSubTopics"],function(e,t,n){"use strict";var i=e("i18n"),r=e("env"),s=e("core/collection"),o=e("core/dialogs/error-dialog"),a=e("pubsub"),l=e("appPubSubTopics");n.exports=s.extend({url:r.getEndpoint("countries"),pubSub:a,initialize:function(e){this.on("error",this._handleError,this),this.fetch()},_handleError:function(e,t,n){var i=new o,r=this._getCountriesErrorMessage(t);i.setContent({errorTitle:this._getCountriesErrorTitle(t),errorMessage:r,response:t}),this.pubSub.publish(l.SHOW_MODAL,{view:i,label:r})},_getCountriesErrorTitle:function(e){return i.gettext("Could not load countries")},_getCountriesErrorMessage:function(e){return i.gettext("An error prevent the list of countries to be loaded.")}})}),define("hbs!components/country-selector/templates/countrySelector",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r,s=t.helperMissing;return' name="'+(0,this.escapeExpression)((r=null!=(r=t.formElementName||(null!=e?e.formElementName:e))?r:s,"function"==typeof r?r.call(e,{name:"formElementName",hash:{},data:i}):r))+'"'},3:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return'            <option value="'+o((r=null!=(r=t.countryCode||(null!=e?e.countryCode:e))?r:s,"function"==typeof r?r.call(e,{name:"countryCode",hash:{},data:i}):r))+'" data-tokens="'+o((r=null!=(r=t.tokens||(null!=e?e.tokens:e))?r:s,"function"==typeof r?r.call(e,{name:"tokens",hash:{},data:i}):r))+'">'+o((r=null!=(r=t.name||(null!=e?e.name:e))?r:s,
"function"==typeof r?r.call(e,{name:"name",hash:{},data:i}):r))+"</option>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s='<div class="country-selector">\n    <select class="form-control"';return r=t.if.call(e,null!=e?e.formElementName:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(s+=r),s+=">\n",r=t.each.call(e,null!=e?e.countries:e,{name:"each",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=r&&(s+=r),s+"    </select>\n</div>\n"},useData:!0})}),define("components/country-selector/views/countrySelectorView",["require","exports","module","appPubSubTopics","latinize","core/view","components/country-selector/collections/countriesCollection","hbs!components/country-selector/templates/countrySelector"],function(e,t,n){"use strict";var i=e("appPubSubTopics"),r=e("latinize"),s=e("core/view"),o=e("components/country-selector/collections/countriesCollection"),a=e("hbs!components/country-selector/templates/countrySelector"),l=s.extend({template:a,countries:null,$countrySelectorEl:null,countryCode:null,initialize:function(e){this.collection=new o,this.collection.on("reset",function(e,t){this.countries=e.toJSON(),this.render()},this)},events:{rendered:function(){this.$countrySelectorEl=this.$el.find("select"),this.$countrySelectorEl.val(this.countryCode).trigger("change"),this.$countrySelectorEl.select2({theme:"bootstrap",width:"100%",matcher:this._matcher})},change:function(e){this.parent&&this.parent.trigger("country_selector:change",e),this.propagateModel&&this._propagateModel($(e.target).val())}},_propagateModel:function(e){if(e){var t=this.collection.findWhere({countryCode:e});t&&this.pubSub.publish(i.COUNTRY_CHANGED,t)}},_matcher:function(e,t){var n,i,s,o;return e.term&&""!==e.term.trim()?(n=$(t.element).attr("data-tokens"),o=r(""+e.term).toUpperCase(),i=r(""+t.text).toUpperCase().indexOf(o),s=n.toUpperCase().indexOf(o),i>=0||s>=0?t:null):t}});n.exports=l}),define("hbs!packages/checkout/templates/paymentMethods/creditcardForm",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r=t.helperMissing,s=this.escapeExpression;return'\n\n    <div class="row form-gutter">\n        <div class="form-group col-md-4">\n            <label for="cardNumber">'+s((t.gettext||e&&e.gettext||r).call(e,"Card number",{name:"gettext",hash:{},data:i}))+'</label>\n            <div class="form-control cc-field" id="cardNumber" name="number"></div>\n            <span class="help-block help-block--feedback hidden"></span>\n        </div>\n    </div>\n\n    <div class="row form-gutter">\n        <div class="form-group col-sm-6 col-md-4">\n            <label class="" for="expirationMonth">'+s((t.gettext||e&&e.gettext||r).call(e,"Expiration month",{name:"gettext",hash:{},data:i}))+'</label>\n            <div class="form-control cc-field" id="expirationMonth" name="expirationMonth"></div>\n            <span class="help-block help-block--feedback hidden"></span>\n        </div>\n\n        <div class="form-group col-sm-6 col-md-4">\n            <label class="" for="expirationYear">'+s((t.gettext||e&&e.gettext||r).call(e,"Expiration year",{name:"gettext",hash:{},data:i}))+'</label>\n            <div class="form-control cc-field" id="expirationYear" name="expirationYear"></div>\n            <span class="help-block help-block--feedback hidden"></span>\n        </div>\n\n    </div>\n\n    <div class="row form-gutter">\n        <div class="form-group col-sm-6 col-md-4">\n            <label for="cvv">'+s((t.gettext||e&&e.gettext||r).call(e,"CVV",{name:"gettext",hash:{},data:i}))+'</label>\n            <div class="form-control cc-field text-center" id="cvv" name="cvv"></div>\n            <span class="help-block help-block--feedback hidden"></span>\n        </div>\n    </div>\n\n    <div class="row form-gutter">\n        <div class="form-group col-sm-6 col-md-4">\n            <label for="postalCode">'+s((t.gettext||e&&e.gettext||r).call(e,"Postal / zip code",{name:"gettext",hash:{},data:i}))+'</label>\n            <input type="text" class="form-control" id="postalCode" name="postal-code" placeholder="'+s((t.gettext||e&&e.gettext||r).call(e,"Required",{name:"gettext",hash:{},data:i}))+'">\n            <span class="help-block help-block--feedback hidden"></span>\n        </div>\n    </div>\n\n    <div class="row form-gutter">\n        <div class="form-group col-sm-6 col-md-4">\n            <label for="countryCode">'+s((t.gettext||e&&e.gettext||r).call(e,"Billing country",{name:"gettext",hash:{},data:i}))+"</label>\n            "+s((t.view||e&&e.view||r).call(e,null!=e?e.countrySelector:e,{name:"view",hash:{},data:i}))+"\n        </div>\n    </div>\n\n\n"},useData:!0})}),define("packages/checkout/views/paymentMethods/creditCardFormView",["require","exports","module","core/view","packages/checkout/models/creditCardFormModel","components/country-selector/views/countrySelectorView","hbs!packages/checkout/templates/paymentMethods/creditcardForm"],function(e,t,n){"use strict";var i=e("core/view"),r=e("packages/checkout/models/creditCardFormModel"),s=e("components/country-selector/views/countrySelectorView"),o=e("hbs!packages/checkout/templates/paymentMethods/creditcardForm"),a=i.extend({template:o,className:"",bindings:{"[name=postal-code]":{observe:"postal-code",setOptions:{validate:!0,silent:!0}}},initialize:function(e){this.model=new r,this.countrySelector=new s({countryCode:e.country,propagateModel:!1,formElementName:"country-code"}),Backbone.Validation.bind(this,{model:this.model})},events:{rendered:function(){this.stickit(this.model)}},hostedFields:function(e){return{styles:{input:{"font-size":"14px",color:"#3A3A3A"},".number":{"font-family":"monospace"},":focus":{color:"#555"},".valid":{color:"green"},".invalid":{color:"red"},"@media screen and (max-width: 700px)":{input:{"font-size":"14px"}}},number:{selector:"#cardNumber",placeholder:"4111111111111111"},cvv:{selector:"#cvv",placeholder:"100"},expirationMonth:{selector:"#expirationMonth",placeholder:"10"},expirationYear:{selector:"#expirationYear",placeholder:"20"},onFieldEvent:function(t){if("focus"===t.type);else if("blur"===t.type)e.model.set(t.target.fieldKey,t.isValid,{validate:!0,silent:!0});else if("fieldStateChange"===t.type){var n=t.isFocused?t.isPotentiallyValid:t.isValid;e.model.set(t.target.fieldKey,n,{validate:!0,silent:!0})}}}}});n.exports=a}),define("hbs!packages/checkout/templates/paymentMethods/creditcard",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r=t.helperMissing,s=this.escapeExpression;return"<h3>"+s((t.gettext||e&&e.gettext||r).call(e,"Purchase using VISA, MasterCard or American Express",{name:"gettext",hash:{},data:i}))+"</h3>\n\n"+s((t.view||e&&e.view||r).call(e,null!=e?e.creditCardFormView:e,{name:"view",hash:{},data:i}))+'\n\n<div class="credit-card__error"></div>\n\n'},useData:!0})}),define("packages/checkout/views/paymentMethods/creditCardView",["require","exports","module","jquery","core/view","packages/checkout/views/paymentMethods/creditCardFormView","hbs!packages/checkout/templates/paymentMethods/creditcard","braintree"],function(e,t,n){"use strict";var i=e("jquery"),r=e("core/view"),s=e("packages/checkout/views/paymentMethods/creditCardFormView"),o=e("hbs!packages/checkout/templates/paymentMethods/creditcard"),a=r.extend({template:o,className:"",id:"braintree",initialize:function(e){this.creditCardFormView=new s(e)},setupBraintreeHostedFields:function(t){var n,r,s,o;return n=e("braintree"),r=i.Deferred(),s=this.creditCardFormView.hostedFields(this.creditCardFormView),o=this.nonceModel,o.clear(),n.setup(t,"custom",{id:"checkout-form",hostedFields:s,onReady:function(){r.resolve()},onPaymentMethodReceived:function(e){e.nonce&&(o.set("isValid",!0,{silent:!0}),o.set(e))},onError:function(e){o.set("isValid",!1)}}),r.promise()},getCreditCardFromModel:function(){return this.creditCardFormView.model}});n.exports=a}),define("hbs!packages/checkout/templates/paymentMethods/skrillPaymentOption",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return"<h3>"+o((t.gettext||e&&e.gettext||s).call(e,"Purchase using",{name:"gettext",hash:{},data:i}))+" "+o((r=null!=(r=t.name||(null!=e?e.name:e))?r:s,"function"==typeof r?r.call(e,{name:"name",hash:{},data:i}):r))+"</h3>\n\n<p>"+o((t.gettext||e&&e.gettext||s).call(e,"After clicking 'Purchase', you will be redirected to our payment partner to fill in the information required to complete your order.",{name:"gettext",hash:{},data:i}))+"</p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s="";return r=t.unless.call(e,null!=e?e.hidden:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(s+=r),s},useData:!0})}),define("packages/checkout/views/paymentMethods/skrillPaymentOptionView",["require","exports","module","packages/checkout/views/paymentMethods/paymentBaseView","hbs!packages/checkout/templates/paymentMethods/skrillPaymentOption"],function(e,t,n){"use strict";var i=e("packages/checkout/views/paymentMethods/paymentBaseView"),r=e("hbs!packages/checkout/templates/paymentMethods/skrillPaymentOption"),s=i.extend({template:r,initialize:function(){},events:{destroyed:function(){},ready:function(){this.unlockSubmitButton()}}});n.exports=s}),define("hbs!packages/checkout/templates/paymentMethods/adyenPaymentOption",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return"    <h3>"+o((t.gettext||e&&e.gettext||s).call(e,"Purchase using",{name:"gettext",hash:{},data:i}))+" "+o((r=null!=(r=t.name||(null!=e?e.name:e))?r:s,"function"==typeof r?r.call(e,{name:"name",hash:{},data:i}):r))+"</h3>\n\n    <p>"+o((t.gettext||e&&e.gettext||s).call(e,"After clicking 'Purchase', you will be redirected to our payment partner to fill in the information required to complete your order.",{name:"gettext",hash:{},data:i}))+"</p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s="";return r=t.unless.call(e,null!=e?e.hidden:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(s+=r),s},useData:!0})}),define("packages/checkout/views/paymentMethods/adyenPaymentOptionView",["require","exports","module","packages/checkout/views/paymentMethods/paymentBaseView","hbs!packages/checkout/templates/paymentMethods/adyenPaymentOption"],function(e,t,n){"use strict";var i=e("packages/checkout/views/paymentMethods/paymentBaseView"),r=e("hbs!packages/checkout/templates/paymentMethods/adyenPaymentOption"),s=i.extend({tagName:"form",attributes:function(){return{action:"https://test.adyen.com/hpp/select.shtml"}},template:r,initialize:function(){},events:{destroyed:function(){},ready:function(){this.unlockSubmitButton()}}});n.exports=s}),define("hbs!packages/checkout/templates/paymentMethods/redeemGiftOption",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a="  <h3>"+o((t.gettext||e&&e.gettext||s).call(e,"Redeem gift code or pre-paid card",{name:"gettext",hash:{},data:i}))+"</h3>\n\n  <p>";return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.product:e,{name:"gettext_block",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+"</p>\n"},2:function(e,t,n,i){return"If you are in possession of a %1$s gift code or pre-paid card you can redeem it here in order to continue on without being charged."},4:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a="  <h3>"+o((t.gettext||e&&e.gettext||s).call(e,"Gift code or pre-paid card",{name:"gettext",hash:{},data:i}))+"</h3>\n\n  <p>";return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.product:e,{name:"gettext_block",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+"</p>\n"},5:function(e,t,n,i){return"If you are in possession of a gift code or pre-paid card you can redeem it here in order to add %1$s to your Mojang account."},7:function(e,t,n,i){var r,s=t.helperMissing,o="  <p>";return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.storeLink:e,{name:"gettext_block",hash:{},fn:this.program(8,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"</p>\n"},8:function(e,t,n,i){return'<strong>Please note:</strong> You can only redeem codes for Minecraft: Java Edition here. In order to redeem codes for Minecraft for Windows 10 you need to <a href="%1$s">visit Windows Store</a>.'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=this.lambda,o=this.escapeExpression,a=t.helperMissing,l="";return r=t.if.call(e,null!=e?e.checkout:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(4,i),data:i}),null!=r&&(l+=r),l+="\n",r=t.if.call(e,null!=e?e.minecraft:e,{name:"if",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+'\n<div class="form-group">\n  <label for="'+o(s(i&&i.cid,e))+'-redeemCode">'+o((t.gettext||e&&e.gettext||a).call(e,"Code",{name:"gettext",hash:{},data:i}))+'</label>\n  <input type="text" class="form-control" id="'+o(s(i&&i.cid,e))+'-redeemCode" name="code">\n  <span class="help-block help-block--feedback hidden"></span>\n</div>\n\n<p class="help-block small">'+o((t.gettext||e&&e.gettext||a).call(e,"To find the code for your prepaid card, scratch the silver area on the back.",{name:"gettext",hash:{},data:i}))+"</p>\n"},useData:!0})}),define("packages/checkout/views/paymentMethods/redeemGiftView",["require","exports","module","app-config","backbone","packages/checkout/views/paymentMethods/paymentBaseView","hbs!packages/checkout/templates/paymentMethods/redeemGiftOption"],function(e,t,n){"use strict";var i=e("app-config"),r=e("backbone"),s=e("packages/checkout/views/paymentMethods/paymentBaseView"),o=e("hbs!packages/checkout/templates/paymentMethods/redeemGiftOption"),a=s.extend({template:o,initialize:function(e){this.product=i.productName,this.minecraft="Minecraft"===this.product,this.storeLink="http://microsoft.com/redeem",r.Validation.bind(this,{model:this.model})},bindings:{"[name=code]":{observe:"code",setOptions:{validate:!0,silent:!0}}},events:{ready:function(){this.unlockSubmitButton()},rendered:function(){this.stickit(this.model)}}});n.exports=a}),define("packages/checkout/models/paymentTokenModel",["require","exports","module","app-config","core/model"],function(e,t,n){"use strict";var i=e("app-config"),r=e("core/model"),s=r.extend({url:i.clientTokenUrl,initialize:function(){},parse:function(e){this.set("token",e)}});n.exports=s}),define("hbs!packages/payment-methods/templates/paymentMethods",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l='    <li class="nav-item payment-method__'+a((s=null!=(s=t.method||(null!=e?e.method:e))?s:o,"function"==typeof s?s.call(e,{name:"method",hash:{},data:i}):s))+'">\n        <a href="#" class="nav-link ';return r=t.if.call(e,null!=e?e.active:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+='">',r=t.if.call(e,null!=e?e.creditCard:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.program(6,i),data:i}),null!=r&&(l+=r),l+"</a>\n    </li>\n"},2:function(e,t,n,i){return"active "},4:function(e,t,n,i){var r=t.helperMissing;return(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Credit card",{name:"gettext",hash:{},data:i}))},6:function(e,t,n,i){var r,s=t.helperMissing;return(0,this.escapeExpression)((r=null!=(r=t.name||(null!=e?e.name:e))?r:s,"function"==typeof r?r.call(e,{name:"name",hash:{},data:i}):r))},8:function(e,t,n,i){var r,s=t.helperMissing;return r=(t.button||e&&e.button||s).call(e,{name:"button",hash:{class:"btn btn-link more-payment-options",trigger:"all_payment_options"},fn:this.program(9,i),inverse:this.noop,data:i}),null!=r?r:""},9:function(e,t,n,i){var r=t.helperMissing;return(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"More payment methods",{name:"gettext",hash:{},data:i}))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o="";return r=(t.collection||e&&e.collection||s).call(e,{name:"collection",hash:{class:"nav nav-pills payment-methods",tag:"ul"},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(o+=r),r=t.if.call(e,null!=e?e.visible:e,{name:"if",hash:{},fn:this.program(8,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"\n"},useData:!0})}),define("packages/payment-methods/views/paymentMethodsView",["require","exports","module","underscore","app-config","i18n","core/model","core/view","core/collection","packages/payment-methods/collections/paymentMethodsCollection","packages/payment-methods/models/paymentMethodModel","hbs!packages/payment-methods/templates/paymentMethods"],function(e,t,n){"use strict";var i=e("underscore"),r=e("app-config"),s=e("i18n"),o=e("core/model"),a=e("core/view"),l=e("core/collection"),c=e("packages/payment-methods/collections/paymentMethodsCollection"),u=e("packages/payment-methods/models/paymentMethodModel"),d=e("hbs!packages/payment-methods/templates/paymentMethods"),h=a.extend({template:d,model:new o({visible:!0}),collection:null,_numberOfPaymentOptionsToDisplay:4,_availableMethods:c.getInstance(),events:{"click .payment-methods li":"_onPaymentMethodClick",all_payment_options:"_onAllPaymentOptions"},initialize:function(e){this._activeMethod="braintree",e.activePaymentMethod&&(this._activeMethod=e.activePaymentMethod),this.model.set("selected_payment_market",e.countryCode),this.collection=new l,this.collection.once("reset",this._onCollectionResetOnce,this)},updatePaymentsCollection:function(e,t){var n,o=new l(this._availableMethods.toJSON()),a=this.collection.findWhere({active:"active"});if(n=o.filter(function(t){var n=t.get("markets"),i=t.get("blockedMarkets"),r=t.get("forGiftsOnly");return!(i&&i.indexOf(e)>=0)&&(!r&&(!n||n.indexOf(e)>=0))}),n.length>this._numberOfPaymentOptionsToDisplay+1&&!t?(this.model.set("visible",!0),n=i.first(n,this._numberOfPaymentOptionsToDisplay),n.sort()):this.model.set("visible",!1),r.checkoutForm&&r.checkoutForm.includeGiftRedemption){var c=new u;c.set("name",s.gettext("Redeem code")),c.set("method","gift"),c.set("provider","gift"),c.set("submitButtonText",s.gettext("Redeem")),n.push(c)}return a&&i.each(n,function(e,t){e.get("method")===a.get("method")&&e.set("active","active")}),this.model.set("selected_payment_market",e),this.countryCode=e,this.collection.reset(n),this},setActiveMethod:function(e){var t=this.collection.findWhere({method:e});t?this._setActiveMethod(t):this._setActiveMethod(this.collection.first())},getActiveMethod:function(){return this.collection.findWhere({active:"active"})},_setActiveMethod:function(e){var t;t=this.collection.findWhere({active:"active"}),t&&t.set("active",null),e&&e.set("active","active"),this.parent&&this.parent.trigger("PaymentModelsView_payment_selected",e)},_onAllPaymentOptions:function(){this.updatePaymentsCollection(this.model.get("selected_payment_market"),!0)},_onPaymentMethodClick:function(e){var t;return e.preventDefault(),t=$(e.target).model(),this._setActiveMethod(t),!1},_onCollectionResetOnce:function(e){this.setActiveMethod(this._activeMethod)}});n.exports=h}),define("hbs!packages/checkout/templates/extrafields",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=this.lambda,o=this.escapeExpression,a=t.helperMissing;return'<div class="row form-gutter">\n  <div class="form-group col-md-4">\n    <label for="'+o(s(i&&i.cid,e))+'-firstName">'+o((t.gettext||e&&e.gettext||a).call(e,"Firstname",{name:"gettext",hash:{},data:i}))+'</label>\n    <input type="text" class="form-control" id="'+o(s(i&&i.cid,e))+'-firstName" name="brazilFirstName" value="'+o((r=null!=(r=t.firstName||(null!=e?e.firstName:e))?r:a,"function"==typeof r?r.call(e,{name:"firstName",hash:{},data:i}):r))+'"/>\n    <span class="help-block help-block--feedback hidden"></span>\n  </div>\n</div>\n<div class="row form-gutter">\n  <div class="form-group col-md-4">\n    <label for="'+o(s(i&&i.cid,e))+'-lastName">'+o((t.gettext||e&&e.gettext||a).call(e,"Lastname",{name:"gettext",hash:{},data:i}))+'</label>\n    <input type="text" class="form-control" id="'+o(s(i&&i.cid,e))+'-lastName" name="brazilLastName" value="'+o((r=null!=(r=t.lastName||(null!=e?e.lastName:e))?r:a,"function"==typeof r?r.call(e,{name:"lastName",hash:{},data:i}):r))+'"/>\n    <span class="help-block help-block--feedback hidden"></span>\n  </div>\n</div>\n<div class="row form-gutter">\n  <div class="form-group col-md-4">\n    <label for="'+o(s(i&&i.cid,e))+'-zipCode">'+o((t.gettext||e&&e.gettext||a).call(e,"Zipcode",{name:"gettext",hash:{},data:i}))+'</label>\n    <input type="text" class="form-control" id="'+o(s(i&&i.cid,e))+'-zipCode" name="brazilZipCode" value="'+o((r=null!=(r=t.zipCode||(null!=e?e.zipCode:e))?r:a,"function"==typeof r?r.call(e,{name:"zipCode",hash:{},data:i}):r))+'"/>\n    <span class="help-block help-block--feedback hidden"></span>\n  </div>\n</div>\n'},useData:!0})}),define("packages/checkout/views/brazilExtraFieldsView",["require","exports","module","backbone","i18n","app-config","core/view","hbs!packages/checkout/templates/extrafields"],function(e,t,n){"use strict";var i=e("backbone"),r=(e("i18n"),e("app-config"),e("core/view")),s=e("hbs!packages/checkout/templates/extrafields"),o=r.extend({template:s,bindings:{"[name=brazilFirstName]":{observe:"brazilFirstName",setOptions:{silent:!0,validate:!0}},"[name=brazilLastName]":{observe:"brazilLastName",setOptions:{silent:!0,validate:!0}},"[name=brazilZipCode]":{observe:"brazilZipCode",setOptions:{silent:!0,validate:!0}}},initialize:function(e){},events:{ready:function(){i.Validation.bind(this,{model:this.model})},rendered:function(){this.stickit(this.model)}}});o.COUNTRY_CODE="BR",n.exports=o}),define("packages/checkout/models/brazilExtraFieldsModel",["require","exports","module","core/model","i18n"],function(e,t,n){"use strict";var i=e("core/model"),r=e("i18n"),s=i.extend({defaults:{},validation:{brazilFirstName:{required:!0,msg:r.gettext("You need to enter your first name")},brazilLastName:{required:!0,msg:r.gettext("You need to enter your last name")},brazilZipCode:{required:!0,msg:r.gettext("You need to enter your zip code")}},initialize:function(){}});n.exports=s}),define("packages/checkout/views/paymentView",["require","exports","module","jquery","app-config","underscore","i18n","core/layout-view","hbs!packages/checkout/templates/payment","packages/checkout/views/paymentMethods/paypalView","packages/checkout/views/paymentMethods/creditCardView","packages/checkout/views/paymentMethods/skrillPaymentOptionView","packages/checkout/views/paymentMethods/adyenPaymentOptionView","packages/checkout/views/paymentMethods/redeemGiftView","packages/checkout/models/paymentTokenModel","components/country-selector/views/countrySelectorView","packages/payment-methods/views/paymentMethodsView","packages/checkout/views/brazilExtraFieldsView","packages/checkout/models/brazilExtraFieldsModel"],function(e,t,n){"use strict";var i=e("jquery"),r=(e("app-config"),e("underscore")),s=e("i18n"),o=e("core/layout-view"),a=e("hbs!packages/checkout/templates/payment"),l=e("packages/checkout/views/paymentMethods/paypalView"),c=e("packages/checkout/views/paymentMethods/creditCardView"),u=e("packages/checkout/views/paymentMethods/skrillPaymentOptionView"),d=e("packages/checkout/views/paymentMethods/adyenPaymentOptionView"),h=e("packages/checkout/views/paymentMethods/redeemGiftView"),p=e("packages/checkout/models/paymentTokenModel"),f=e("components/country-selector/views/countrySelectorView"),m=e("packages/payment-methods/views/paymentMethodsView"),g=e("packages/checkout/views/brazilExtraFieldsView"),v=e("packages/checkout/models/brazilExtraFieldsModel"),y=o.extend({className:"payment",template:a,_selectedPaymentInput:null,_selectedPaymentMethod:null,paymentToken:null,creditCardView:null,paypalView:null,brazilExtraFieldsView:null,brazilExtraFieldsModel:null,enableBrazilExtraFields:!1,creditCardDfd:i.Deferred(),paypalDfd:i.Deferred(),payment:{},initialize:function(e){var t,n,r;r=this,this.user.get("countryCode")||this.user.set("countryCode",y.DEFAULT_COUNTRY_CODE),t=this.user.get("countryCode"),n=this.user.getLocale()||y.DEFAULT_LOCALE,this._sendUserCountryAnalytics(t),this.creditCardView=new c({locale:n,country:t,nonceModel:this.creditCardNonceModel}),this.payment[this.creditCardView.id]=this.creditCardView,this.paypalView=new l({nonceModel:this.paypalNonceModel,locale:n}),this.payment[this.paypalView.id]=this.paypalView,this.countrySelector=new f({countryCode:t,propagateModel:!0,formElementName:"country-selector"}),this.paymentMethodSelector=new m({countryCode:t,activePaymentMethod:this.creditCardView.id}),this.paymentToken=new p,this.order.on("change:amount",this._onOrderAmountChanged,this),this._bindSubViewEvents(),i.when(this.paypalDfd,this.creditCardDfd).done(function(){r._setupBraintreePaymentMethods()})},events:{PaymentModelsView_payment_selected:"_onPaymentMethodSelected","country_selector:change":"_onSelect2Change",order_error:"_onOrderError",purchase_button_enable:"_onPurchaseButtonEnable",purchase_button_disable:"_onPurchaseButtonDisable",rendered:function(){this.setSelectedPaymentOption(this.paymentMethodSelector.getActiveMethod())}},_sendUserCountryAnalytics:function(e){this.analytics.dimension("PaymentCountry",e)},_bindSubViewEvents:function(){this.creditCardView.on("ready",function(e){this.creditCardDfd.resolve()},this),this.paypalView.on("ready",function(e){this.paypalDfd.resolve()},this)},_setupBraintreePaymentMethods:function(){var e=this;this.paymentToken.fetch().done(function(){var t=e.paymentToken.get("token");e.creditCardView.setupBraintreeHostedFields(t).done(function(){e.paypalView.setupBraintreePaypalButton(t)})}).fail(function(){e._handleError("Unable to fetch payment token")})},updateUserWithCountryCode:function(e){e&&(this.user.set("countryCode",e),this._sendUserCountryAnalytics(e))},setSelectedPaymentInput:function(e){this.$el.find("#selectedPaymentMethod").val(e)},setSelectedPaymentOption:function(e){var t,n,i;if(!e)return this.creditCardView.hide(),void this.paypalView.deactivate();i=e.get("method"),t=this.payment[i],"braintree"===i?(t=this._createPaymentOptionView(e,!0),this.creditCardView.show(),this.paypalView.deactivate()):"paypal"===i?(t=this._createPaymentOptionView(e,!0),this.creditCardView.hide(),this.paypalView.activate()):(t||(t=this._createPaymentOptionView(e,!1)),this.creditCardView.hide(),this.paypalView.deactivate()),this._updateSubmitButtonText(e),n=this.getView();void 0===t||function(){return n&&n.id===i||!1}()||this.setView(t),this.setSelectedPaymentInput(i),this._selectedPaymentMethod=i,t.id&&this.parent.trigger("selected_payment_method",t.id)},_createPaymentOptionView:function(e,t){var n,i,r,s;return n=e.get("name"),i=e.get("method"),r=e.get("provider"),s={name:n,id:i,hidden:t},this._createPaymentOptionViewByProvider(r,s)},_createPaymentOptionViewByProvider:function(e,t){return"adyen"===e?new d(t):"gift"===e?(t.model=this.redeemGiftModel,t.checkout=!0,new h(t)):new u(t)},_updateSubmitButtonText:function(e){if(e&&this.parent&&this.parent.submitButton){var t=e.get("submitButtonText");this.parent.submitButton.$el.text(s.sprintf(t,this.order.get("amount")))}},_displayBrazilExtraFields:function(){this.brazilExtraFieldsView=new g,this.brazilExtraFieldsView.setModel(this._getBrazilExtraFieldsModel()),this._getBrazilExtraFieldsModel(),this.render()},_getBrazilExtraFieldsModel:function(){return this.brazilExtraFieldsModel||(this.brazilExtraFieldsModel=new v),this.brazilExtraFieldsModel},_removeBrazilExtraFields:function(){this.brazilExtraFieldsView&&this.brazilExtraFieldsView.remove()},_handleBrazilExtraFields:function(e){g.COUNTRY_CODE===e&&this.enableBrazilExtraFields?this._displayBrazilExtraFields():this._removeBrazilExtraFields()},_onPaymentMethodSelected:function(e){this.setSelectedPaymentOption(e)},_onOrderError:function(){var e=this.getView();r.isFunction(e.handleError)&&e.handleError()},_onSelect2Change:function(e){var t=i(e.target).val();t&&(this.paymentMethodSelector.updatePaymentsCollection(t,!1),this.paymentMethodSelector.setActiveMethod(this._selectedPaymentMethod),this.updateUserWithCountryCode(t)),this._handleBrazilExtraFields(t)},_onPurchaseButtonEnable:function(e){this.parent&&this.parent.submitButton&&this.parent.submitButton.setEnabled()},_onPurchaseButtonDisable:function(e){this.parent&&this.parent.submitButton&&this.parent.submitButton.setDisabled()},_onOrderAmountChanged:function(e){this._updateSubmitButtonText(this.paymentMethodSelector.getActiveMethod())}});y.DEFAULT_COUNTRY_CODE="US",y.DEFAULT_LOCALE="en_US",n.exports=y}),define("hbs!packages/checkout/templates/profile",["handlebars"],function(e){return e.template({1:function(e,t,n,i){return"The name you select will be displayed to other players in %1$s. Choose wisely!"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l="<h3>"+a((s=null!=(s=t.product||(null!=e?e.product:e))?s:o,"function"==typeof s?s.call(e,{name:"product",hash:{},data:i}):s))+' profile</h3>\n\n<div class="form-group">\n    <label for="profileName">'+a((t.gettext||e&&e.gettext||o).call(e,"Name",{name:"gettext",hash:{},data:i}))+'</label>\n    <div class="input-group">\n      <input type="text" class="form-control" id="profileName" name="profileName" placeholder="'+a((t.gettext||e&&e.gettext||o).call(e,"e.g BlockBuster2K",{name:"gettext",hash:{},data:i}))+'">\n      <span class="js-profile-available input-group-addon" ></span>\n    </div>\n  <span class="help-block help-block--feedback hidden"></span>\n</div>\n<span class="help-block small">';return r=(t.gettext_block||e&&e.gettext_block||o).call(e,null!=e?e.product:e,{name:"gettext_block",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+"</span>\n"},useData:!0})}),define("packages/checkout/views/profileView",["require","exports","module","i18n","app-config","core/view","hbs!packages/checkout/templates/profile"],function(e,t,n){"use strict";var i=e("i18n"),r=e("app-config"),s=e("core/view"),o=e("hbs!packages/checkout/templates/profile"),a=s.extend({template:o,validationModel:void 0,bindings:{"[name=profileName]":{observe:"profileName",setOptions:{validate:!0,silent:!0}},".js-profile-available":{observe:"available",updateMethod:"html",onGet:function(e){if(this.$el){var t,n=this.$('[name="profileName"]');return t=n.closest(".form-group"),e?(t.removeClass("has-error name-unavailable").addClass("has-success"),t.find(".help-block--feedback").html("").addClass("hidden"),'<span class="glyphicon glyphicon-ok"></span>'):(n.val()&&(t.addClass("has-error name-unavailable").removeClass("has-success"),t.find(".help-block--feedback").html(i.gettext("Profile name unavailable. Please choose a different name.")).removeClass("hidden")),'<span class="glyphicon glyphicon-ban-circle"></span>')}},setOptions:{validate:!0,silent:!0}}},initialize:function(e){Backbone.Validation.bind(this,{model:this.validationModel,valid:function(e,t,n){var i,r,s=e.$(".js-profile-available span");"available"!==t&&(i=e.$("[name="+t+"]"),r=i.closest(".form-group"),r.hasClass("name-unavailable")||(r.removeClass("has-error").addClass("has-success"),r.find(".help-block--feedback").html("").addClass("hidden"),s.addClass("glyphicon-ok").removeClass("glyphicon-ban-circle")))},invalid:function(e,t,n,i){var r,s,o=e.$(".js-profile-available span");"available"!==t&&(r=e.$("[name="+t+"]"),s=r.closest(".form-group"),s.addClass("has-error").removeClass("has-success"),s.find(".help-block--feedback").html(n).removeClass("hidden"),o.removeClass("glyphicon-ok").addClass("glyphicon-ban-circle"))}}),this.product=r.productName},events:{rendered:function(){this.stickit(this.validationModel)}}});n.exports=a}),
define("packages/checkout/models/profileModel",["require","exports","module","underscore","backbone","i18n","env","core/model","core/validators","core/dialogs/error-dialog","core/user/models/userModel","pubsub","appPubSubTopics"],function(e,t,n){"use strict";var i=e("underscore"),r=e("backbone"),s=e("i18n"),o=e("env"),a=e("core/model"),l=e("core/validators"),c=e("core/dialogs/error-dialog"),u=e("core/user/models/userModel"),d=e("pubsub"),h=e("appPubSubTopics");i.extend(r.Validation.validators,l);var p=a.extend({defaults:{},pubSub:d,user:void 0,validation:{profileName:[{required:!0,msg:s.gettext("You need to enter a profile name")},{isAuthenticated:!0},{minLength:3,msg:s.gettext("Your profile name must be at least three characters long")},{maxLength:16,msg:s.gettext("Your profile name can't be longer than 16 characters.")},{pattern:/^\w{3,16}$/i,msg:s.gettext("Your profile name can only contain letters, numbers and underscores.")},{fn:"_isAvailable"}],available:{required:!0,acceptance:!0}},initialize:function(){this.user=u.getInstance()},isNew:function(){return!1},_isAvailable:function(e,t,n){this._checkNameAvailabilityServerSide()},_checkNameAvailabilityServerSide:i.debounce(function(){this._fetchProfileAvailability()},300),_getProfileName:function(){return this.get("profileName")},_fetchProfileAvailability:function(){var e=this,t=this._getProfileName();i.isEmpty(t)||(this._setUrl(t),this.fetch({beforeSend:i.bind(this._setAuthentication,this),success:function(t,n,i){e.set("available",!1)},error:function(t,n,i){404===n.status?e.set("available",!0):e._handleAvailabilityCheckError(n)}}))},_publishError:function(e,t,n){var i=new c;i.setContent({errorTitle:e,errorMessage:t,response:n}),this.pubSub.publish(h.SHOW_MODAL,{view:i,label:t})},_handleAvailabilityCheckError:function(e){this._publishError(this._getAvailabilityCheckErrorTitle(e),this._getAvailabilityCheckErrorMessage(e),e)},_getAvailabilityCheckErrorTitle:function(e){return this._isTooManyRequests(e)?s.gettext("Too many name availability checks"):s.gettext("Could not check name availability")},_getAvailabilityCheckErrorMessage:function(e){return this._isTooManyRequests(e)?s.gettext("You have checked if too many names are available. Please come back later."):s.gettext("Due to an error we are currently unable to check if the profile name you want is available.")},_reserveName:function(){var e,t,n;if(e=this,t=this._getProfileName(),n=e.toJSON(),!i.isEmpty(t))return this._setUrl(t),this.clear({silent:!0}),$.ajax({beforeSend:i.bind(this._setAuthentication,this),type:"PUT",url:this.url}).done(function(t,i,r){e.set(n)}).fail(i.bind(this._handleReservationError,this))},_handleReservationError:function(e,t,n){this._publishError(this._getReservationErrorTitle(e),this._getReservationErrorMessage(e),e)},_getReservationErrorTitle:function(e){return s.gettext("Could not reserve your name")},_getReservationErrorMessage:function(e){return this._isBadRequest(e)?s.gettext("Most likely the name you have chosen has been taken by someone else. Please try with a different name."):this._getErrorMessage(e)},_setUrl:function(e){var t=o.getCurrentSettings().agent;this.url=o.getEndpoint("profileName",{agent:t,profileName:e})},reserveName:function(){return this._reserveName()}});n.exports=p}),define("packages/redeem/models/redeemGiftModel",["require","exports","module","i18n","core/model","env"],function(e,t,n){"use strict";var i=e("i18n"),r=e("core/model"),s=e("env"),o=r.extend({defaults:{},validation:{code:[{required:!0,msg:i.gettext("Code is required.")},{redeemCodeFormat:!0}]},initialize:function(){this._setUrl()},fetch:function(){},trimCode:function(){var e=this.get("code");e&&this.set("code",e.replace(/ /g,""))},_setUrl:function(){this.url=s.getEndpoint("redeemGift")},_getRedeemErrorTitle:function(e){return this._isTooManyRequests(e)?i.gettext("Too many recent redemption attempts"):this._getErrorTitle(e)},_getRedeemErrorMessage:function(e){return(e.responseJSON?e.responseJSON.errorMessage:"").indexOf("No PrepaidCardService found")>-1?i.gettext("The code you entered is invalid. Please double check to make sure that you have entered it correctly."):this._isBadRequest(e)||this._isMethodNotAllowed(e)||this._isNotFound(e)?i.gettext("Your redemption request is invalid and can't be processed. Please try again or contact Mojang customer support."):this._isUnauthorized(e)?i.gettext("You need to be logged in to redeem a code. Please log back in and try again."):this._isTooManyRequests(e)?i.gettext("You've just recently attempted to redeem a code. You need to wait before you can try again."):this._isInternalServerError(e)?i.gettext("An error prevented us from redeeming your code. Please try again."):this._getErrorMessage(e)}});n.exports=o}),define("hbs!packages/checkout/templates/checkout",["handlebars"],function(e){return e.template({1:function(e,t,n,i){return"You're about to buy %1$s and add it to your Mojang account."},3:function(e,t,n,i){return'If you would prefer to buy %1$s as a gift for someone else, purchase a gift code from <a href="%2$s">here</a>, or <a href="%3$s">find out where</a> you can get your hands on a physical pre-paid card.'},5:function(e,t,n,i){var r,s=t.helperMissing,o='        <p class="help-block">';return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.eulaLink:e,null!=e?e.productName:e,{name:"gettext_block",hash:{},fn:this.program(6,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"</p>\n"},6:function(e,t,n,i){return'By submitting this form you accept the <a href="%1$s" target="_blank">%2$s End User License Agreement</a>.'},8:function(e,t,n,i){return"          var env = BraintreeData.environments.sandbox;\n"},10:function(e,t,n,i){return"          var env = BraintreeData.environments.production;\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l=a((t.view||e&&e.view||o).call(e,null!=e?e.orderView:e,{name:"view",hash:{},data:i}))+"\n<h1>"+a((t.gettext||e&&e.gettext||o).call(e,"Time to buy",{name:"gettext",hash:{},data:i}))+"</h1>\n<p>";return r=(t.gettext_block||e&&e.gettext_block||o).call(e,null!=e?e.product:e,{name:"gettext_block",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+="</p>\n<p>",r=(t.gettext_block||e&&e.gettext_block||o).call(e,null!=e?e.product:e,null!=e?e.giftCodeUrl:e,null!=e?e.prepaidCardUrl:e,{name:"gettext_block",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+='</p>\n<form class="view-checkout__checkout-form" id="checkout-form" action="" method="post" autocomplete="off">\n\n  '+a((t.view||e&&e.view||o).call(e,null!=e?e.profileView:e,{name:"view",hash:{},data:i}))+"\n  "+a((t.view||e&&e.view||o).call(e,null!=e?e.paymentView:e,{name:"view",hash:{},data:i}))+'\n\n  <div class="form-gutter">\n    <div class="form-group">\n      '+a((t.view||e&&e.view||o).call(e,null!=e?e.submitButton:e,{name:"view",hash:{},data:i}))+"\n    </div>\n",r=t.if.call(e,null!=e?e.includeEula:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+="  </div>\n  <script>\n      window.onBraintreeDataLoad = function() {\n",r=t.if.call(e,null!=e?e.sandbox:e,{name:"if",hash:{},fn:this.program(8,i),inverse:this.program(10,i),data:i}),null!=r&&(l+=r),l+'          BraintreeData.setup("'+a((s=null!=(s=t.merchantId||(null!=e?e.merchantId:e))?s:o,"function"==typeof s?s.call(e,{name:"merchantId",hash:{},data:i}):s))+"\", 'checkout-form', env.withId('"+a((s=null!=(s=t.kountId||(null!=e?e.kountId:e))?s:o,"function"==typeof s?s.call(e,{name:"kountId",hash:{},data:i}):s))+'\'));\n      };\n  <\/script>\n  <script src="//js.braintreegateway.com/v1/braintree-data.js" async=true><\/script>\n</form>\n'},useData:!0})}),define("hbs!packages/checkout/templates/submitButton",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r=t.helperMissing;return(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Complete purchase",{name:"gettext",hash:{},data:i}))+"\n"},useData:!0})}),define("packages/checkout/views/checkoutView",["require","exports","module","underscore","app-config","i18n","core/model","core/view","core/user/models/userModel","core/dialogs/loader-dialog","components/submit-button/views/submitButtonView","packages/order/views/orderView","packages/checkout/views/paymentView","packages/checkout/views/profileView","packages/checkout/models/profileModel","packages/redeem/models/redeemGiftModel","packages/checkout/models/brazilExtraFieldsModel","hbs!packages/checkout/templates/checkout","hbs!packages/checkout/templates/submitButton"],function(e,t,n){"use strict";var i=e("underscore"),r=e("app-config"),s=e("i18n"),o=e("core/model"),a=e("core/view"),l=e("core/user/models/userModel"),c=e("core/dialogs/loader-dialog"),u=e("components/submit-button/views/submitButtonView"),d=e("packages/order/views/orderView"),h=e("packages/checkout/views/paymentView"),p=e("packages/checkout/views/profileView"),f=e("packages/checkout/models/profileModel"),m=e("packages/redeem/models/redeemGiftModel"),g=e("packages/checkout/models/brazilExtraFieldsModel"),v=e("hbs!packages/checkout/templates/checkout"),y=e("hbs!packages/checkout/templates/submitButton"),b=a.extend({className:"view-checkout",template:v,submitButton:null,loaderDialog:null,orderView:null,paymentView:null,profileView:null,creditCardNonceModel:null,paypalNonceModel:null,_profile:null,context:{product:r.order.items[0].displayName,prepaidCardUrl:r.prepaidCardUrl,giftCodeUrl:r.giftCodeUrl,redeemPrepaidUrl:r.redeemPrepaidUrl},_checkoutController:null,_redeemController:null,initialize:function(){var e=l.getInstance();this.submitButton=new u({className:"btn btn-block btn-primary btn-lg",loadingText:s.gettext("Placing order..."),template:y}),this.creditCardNonceModel=new o,this.profileModel=new f({}),this.paypalNonceModel=new o,this.redeemGiftModel=new m,this.brazilExtraFieldsModel=new g,this.profileView=new p({validationModel:this.profileModel}),this.paymentView=new h({user:e,creditCardNonceModel:this.creditCardNonceModel,paypalNonceModel:this.paypalNonceModel,order:this.order,redeemGiftModel:this.redeemGiftModel,brazilExtraFieldsModel:this.brazilExtraFieldsModel}),this.orderView=new d({collection:this.order.get("displayItems")}),this.eulaLink=r.registerForm.eulaLink,this.productName=r.productName,this.includeEula=!(!this.eulaLink||!this.productName),this.applyBraintreeConfig(),this.analytics.pageView("/buy")},applyBraintreeConfig:function(){i.isBoolean(r.braintree.sandbox)||(r.braintree.sandbox="true"===r.braintree.sandbox),i.extend(this,r.braintree)},events:{order_error:"_onOrderError",order_failed:"_onProcessedOrderFailed",order_success:"_onOrderSuccess",redeem_error:"_onRedeemError",redeem_success:"_onOrderSuccess","submit form":"_onFormSubmit",selected_payment_method:function(e){this.analytics.dimension("PaymentMethod",e)}},setCheckoutController:function(e){this._checkoutController=e},setRedeemController:function(e){this._redeemController=e},_getCreditCardFormModel:function(){return this.paymentView&&this.paymentView.creditCardView?this.paymentView.creditCardView.getCreditCardFromModel():void 0},_createPlacingOrderDialog:function(){return this.loaderDialog=new c({message:s.gettext("Placing order...")}),this.loaderDialog},_handleBraintreePayment:function(e,t){var n=this,r=this._getCreditCardFormModel(),s=this.creditCardNonceModel;r.validate(),r.isValid()?i.isEmpty(s.get("nonce"))?s.once("change",function(i){!0===i.get("isValid")?n._placeNonceOrder(i,e,t):n._releaseForm(t)}):n._placeNonceOrder(s,e,t):this._releaseForm(t)},_handlePaypalPayment:function(e,t){var n=this.paypalNonceModel;i.isEmpty(n.get("nonce"))?this._releaseForm(t):this._placeNonceOrder(n,e,t)},_handleGiftPayment:function(e,t){var n=this.redeemGiftModel;n.validate(),n.isValid()?this._redeemGift(e,t):this._releaseForm(t)},_handleOtherPayments:function(e,t){this._placeOrder(e,t)},_placeOrder:function(e,t){var n=this,i=this.profileModel;i.isValid()&&i.reserveName().done(function(){n._checkoutController.placeOrder(e.selected_payment_method,e)}).fail(function(){n._releaseForm(t)}),t()},_placeNonceOrder:function(e,t,n){var i=this,r=this.profileModel;r.isValid()&&r.reserveName().done(function(){i._checkoutController.placeOrder(e.get("nonce"),t)}).fail(function(){i._releaseForm(n)}),n()},_redeemGift:function(e,t){var n=this,i=this.profileModel,r=this.redeemGiftModel;i.isValid()&&i.reserveName().done(function(){n._redeemController.redeemGift(r)}).fail(function(){n._releaseForm(t)}),t()},_onFormSubmit:function(e){this.serialize(e,function(t,n){var i,r;if(e.preventDefault(),r=this._createPlacingOrderDialog(),i=this.profileModel,i.validate(),!i.isValid())return void this._releaseForm(n);if("BR"===t["country-selector"]&&!this.brazilExtraFieldsModel.isValid(!0))return void this._releaseForm(n);switch(r.start(),this.submitButton.setLoading(),t.selected_payment_method){case"braintree":this._handleBraintreePayment(t,n);break;case"paypal":this._handlePaypalPayment(t,n);break;case"gift":this._handleGiftPayment(t,n);break;default:this._handleOtherPayments(t,n)}})},_releaseForm:function(e){e&&e(),this._sendValidationAnalytics("Profile name",this.profileModel),this._sendValidationAnalytics("Credit card",this._getCreditCardFormModel()),this._sendValidationAnalytics("Redeem gift",this.redeemGiftModel),this.submitButton.reset(),this.loaderDialog&&this.loaderDialog.stop()},_onOrderError:function(e){this.submitButton.reset(),this.loaderDialog.stop(),this.publishError(e.errorTitle,e.errorMessage,e.response)},_onProcessedOrderFailed:function(){this.submitButton.reset(),this.loaderDialog.stop(),this.publishError(s.gettext("Error placing order"),s.gettext("An error occurred while placing order, please verify credit card info and try again"))},_onOrderSuccess:function(){this.loaderDialog.stop()},_onRedeemError:function(e){this.submitButton.reset(),this.publishError(e.errorTitle,e.errorMessage,e.response)}});b.createView=function(e){return new b({order:e})},n.exports=b}),define("hbs!packages/download/templates/download",["handlebars"],function(e){return e.template({1:function(e,t,n,i){return"Download %1$s."},3:function(e,t,n,i){var r,s=t.helperMissing,o="\n";return r=(t.collection||e&&e.collection||s).call(e,{name:"collection",hash:{class:"download-links list-unstyled",tag:"ul"},fn:this.program(4,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+="\n    <p>\n      ",r=(t.button||e&&e.button||s).call(e,"_onAllOptionsClick",{name:"button",hash:{href:"#",tag:"a"},fn:this.program(8,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"\n    </p>\n\n"},4:function(e,t,n,i){var r,s="";return r=t.if.call(e,null!=e?e.show:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=r&&(s+=r),s},5:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l='        <li class="mb-3"><a class="btn btn-primary btn-primary--grow btn-lg download-links__link download-link--'+a((s=null!=(s=t.platform||(null!=e?e.platform:e))?s:o,"function"==typeof s?s.call(e,{name:"platform",hash:{},data:i}):s))+'" href="'+a((s=null!=(s=t.downloadUrl||(null!=e?e.downloadUrl:e))?s:o,"function"==typeof s?s.call(e,{name:"downloadUrl",hash:{},data:i}):s))+'">';return r=(t.gettext_block||e&&e.gettext_block||o).call(e,null!=e?e.name:e,{name:"gettext_block",hash:{},fn:this.program(6,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+"</a></li>\n"},6:function(e,t,n,i){return"Download for %1$s"},8:function(e,t,n,i){var r=t.helperMissing;return(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Show all download options",{name:"gettext",hash:{},data:i}))},10:function(e,t,n,i){var r,s=t.helperMissing,o="\n    <p>\n      ";return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.downloadUrl:e,{name:"gettext_block",hash:{},fn:this.program(11,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"\n    </p>\n\n"},11:function(e,t,n,i){return'Unfortunately there seems to be a problem with the download service. Please check the <a href="%1$s">download section</a> for available downloads.'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o='<div class="download">\n  <h4>\n    ';return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.product:e,{name:"gettext_block",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+="\n  </h4>\n\n",r=t.if.call(e,null!=(r=null!=e?e.collection:e)?r.length:r,{name:"if",hash:{},fn:this.program(3,i),inverse:this.program(10,i),data:i}),null!=r&&(o+=r),o+"</div>\n"},useData:!0})}),define("packages/download/views/downloadView",["require","exports","module","jquery","underscore","app-config","core/collection","core/view","hbs!packages/download/templates/download"],function(e,t,n){"use strict";var i=e("jquery"),r=e("underscore"),s=e("app-config"),o=e("core/collection"),a=e("core/view"),l=e("hbs!packages/download/templates/download"),c=a.extend({template:l,initialize:function(e){this.collection=this._createDownloadsCollection(s.download),this.product=s.productName,this.supportUrl=s.supportUrl,this.downloadUrl=s.downloadUrl},_onAllOptionsClick:function(e){return e.preventDefault(),this.collection.each(function(e){e.set("show",!0)}),i(e.target).parent().hide(),!1},_createDownloadsCollection:function(e){var t=new o;return r.each(e,function(e,n){e.link&&t.add({name:e.name,downloadUrl:e.link,platform:n,show:this._isCurrent(n),file:this._getFile(e.link)})},this),t},_getFile:function(e){var t=e.split("/");return t[t.length-1]},_isCurrent:function(e){return s.platform===e}});n.exports=c}),define("hbs!packages/checkout/templates/completed",["handlebars"],function(e){return e.template({1:function(e,t,n,i){return"Your order (reference number <strong>%1$s</strong>) has been completed. A receipt has been sent to %2$s."},3:function(e,t,n,i){return'If you have any questions regarding your order, please visit our <a href="%1$s">support center</a>.'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a='<div class="checkout__completed">\n  <h1>'+o((t.gettext||e&&e.gettext||s).call(e,"Purchase complete",{name:"gettext",hash:{},data:i}))+'</h1>\n\n  <p class="text-success">';return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.id:e,null!=e?e.email:e,{name:"gettext_block",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+="\n  </p>\n\n"+o((t.view||e&&e.view||s).call(e,null!=e?e.downloadView:e,{name:"view",hash:{},data:i}))+"\n\n<h4>\n  "+o((t.gettext||e&&e.gettext||s).call(e,"Need help?",{name:"gettext",hash:{},data:i}))+"\n</h4>\n\n<p>\n  ",r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.supportUrl:e,{name:"gettext_block",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+"\n</p>\n"},useData:!0})}),define("packages/checkout/views/completedView",["require","exports","module","app-config","core/view","core/user/models/sessionModel","packages/download/views/downloadView","hbs!packages/checkout/templates/completed"],function(e,t,n){"use strict";var i=e("app-config"),r=e("core/view"),s=e("core/user/models/sessionModel"),o=e("packages/download/views/downloadView"),a=e("hbs!packages/checkout/templates/completed"),l=r.extend({template:a,initialize:function(e){this.downloadView=new o,this.email=s.getInstance().getUsername(),this.supportUrl=i.supportUrl,this.analytics.pageView("/download")}});n.exports=l}),define("hbs!components/mailcheck/templates/mailcheck",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return o((t.gettext||e&&e.gettext||s).call(e,"Did you mean",{name:"gettext",hash:{},data:i}))+' <span class="mailcheck__value">'+o((r=null!=(r=t.suggestedEmail||(null!=e?e.suggestedEmail:e))?r:s,"function"==typeof r?r.call(e,{name:"suggestedEmail",hash:{},data:i}):r))+'</span>? <button type="button" class="btn btn-default btn-xs" data-button="use-suggested" value="'+o((r=null!=(r=t.suggestedEmail||(null!=e?e.suggestedEmail:e))?r:s,"function"==typeof r?r.call(e,{name:"suggestedEmail",hash:{},data:i}):r))+'">'+o((t.gettext||e&&e.gettext||s).call(e,"Yes",{name:"gettext",hash:{},data:i}))+'</button>  / <button type="button" data-button="omit-suggested" class="btn btn-default btn-xs">'+o((t.gettext||e&&e.gettext||s).call(e,"No",{name:"gettext",hash:{},data:i}))+"</button>\n"},useData:!0})}),define("components/mailcheck/views/mailcheckView",["require","exports","module","underscore","hbs!components/mailcheck/templates/mailcheck"],function(e,t,n){"use strict";var i=e("underscore"),r=e("hbs!components/mailcheck/templates/mailcheck"),s={mailcheckSource:void 0,mailcheckModel:void 0,setupMailcheck:function(e,t){this.mailcheckSource=e,this.mailcheckModel=t||this.model,this._addMailcheckBindings(),this._addMailcheckEvents()},_addMailcheckBindings:function(){var e={"#mailcheck":{observe:"suggestedEmail",update:function(e,t,n,i){t&&t!==n.get(this.mailcheckSource)?(e.html(r({suggestedEmail:t})),e.removeClass("hidden")):e.addClass("hidden").text("")}}};i.extend(this.bindings,e)},_addMailcheckEvents:function(){this.on({'click [data-button="use-suggested"]':"_useSuggestedEmailClick",'click [data-button="omit-suggested"]':"_omitSuggestedEmailClick",'blur input[type="email"].domain-check':"_updateSuggestedEmail"})},_useSuggestedEmailClick:function(e){var t=e.currentTarget.value;this.mailcheckModel.set(this.mailcheckSource,t),this.mailcheckModel.checkMail(this.mailcheckSource)},_omitSuggestedEmailClick:function(e){$(e.currentTarget).parent().addClass("hidden")},_updateSuggestedEmail:function(e){e.preventDefault(),this.mailcheckModel.checkMail(this.mailcheckSource)}};n.exports=s});var Kicksend={mailcheck:{threshold:3,defaultDomains:["yahoo.com","google.com","hotmail.com","gmail.com","me.com","aol.com","mac.com","live.com","comcast.net","googlemail.com","msn.com","hotmail.co.uk","yahoo.co.uk","facebook.com","verizon.net","sbcglobal.net","att.net","gmx.com","mail.com","outlook.com","icloud.com"],defaultTopLevelDomains:["co.jp","co.uk","com","net","org","info","edu","gov","mil","ca"],run:function(e){e.domains=e.domains||Kicksend.mailcheck.defaultDomains,e.topLevelDomains=e.topLevelDomains||Kicksend.mailcheck.defaultTopLevelDomains,e.distanceFunction=e.distanceFunction||Kicksend.sift3Distance;var t=function(e){return e},n=e.suggested||t,i=e.empty||t,r=Kicksend.mailcheck.suggest(encodeURI(e.email),e.domains,e.topLevelDomains,e.distanceFunction);return r?n(r):i()},suggest:function(e,t,n,i){e=e.toLowerCase();var r=this.splitEmail(e),s=this.findClosestDomain(r.domain,t,i);if(s){if(s!=r.domain)return{address:r.address,domain:s,full:r.address+"@"+s}}else{var o=this.findClosestDomain(r.topLevelDomain,n);if(r.domain&&o&&o!=r.topLevelDomain){var a=r.domain;return s=a.substring(0,a.lastIndexOf(r.topLevelDomain))+o,{address:r.address,domain:s,full:r.address+"@"+s}}}return!1},findClosestDomain:function(e,t,n){var i,r=99,s=null;if(!e||!t)return!1;n||(n=this.sift3Distance);for(var o=0;o<t.length;o++){if(e===t[o])return e;i=n(e,t[o]),i<r&&(r=i,s=t[o])}return r<=this.threshold&&null!==s&&s},sift3Distance:function(e,t){if(null==e||0===e.length)return null==t||0===t.length?0:t.length;if(null==t||0===t.length)return e.length;for(var n=0,i=0,r=0,s=0;n+i<e.length&&n+r<t.length;){if(e.charAt(n+i)==t.charAt(n+r))s++;else{i=0,r=0;for(var o=0;o<5;o++){if(n+o<e.length&&e.charAt(n+o)==t.charAt(n)){i=o;break}if(n+o<t.length&&e.charAt(n)==t.charAt(n+o)){r=o;break}}}n++}return(e.length+t.length)/2-s},splitEmail:function(e){var t=e.split("@");if(t.length<2)return!1;for(var n=0;n<t.length;n++)if(""===t[n])return!1;var i=t.pop(),r=i.split("."),s="";if(0==r.length)return!1;if(1==r.length)s=r[0];else{for(var n=1;n<r.length;n++)s+=r[n]+".";r.length>=2&&(s=s.substring(0,s.length-1))}return{topLevelDomain:s,domain:i,address:t.join("@")}}}};"undefined"!=typeof module&&module.exports&&(module.exports=Kicksend.mailcheck),"undefined"!=typeof window&&window.jQuery&&function(e){e.fn.mailcheck=function(e){var t=this;if(e.suggested){var n=e.suggested;e.suggested=function(e){n(t,e)}}if(e.empty){var i=e.empty;e.empty=function(){i.call(null,t)}}e.email=this.val(),Kicksend.mailcheck.run(e)}}(jQuery),define("mailcheck",function(){}),define("components/mailcheck/models/mailcheckModel",["require","exports","module","mailcheck"],function(e,t,n){"use strict";e("mailcheck");var i={checkMail:function(e){var t=this,n=this.get(e);t.isValid(n)?Kicksend.mailcheck.run({domains:["hotmail.com","hotmail.co.uk","hotmail.de","hotmail.fr","live.com","live.co.uk","msn.com","outlook.com","gmail.com","google.com","googlemail.com","yahoo.com","yahoo.co.uk","yahoo.de","icloud.com","mac.com","me.com","facebook.com","gmx.de","web.de","mail.ru","yandex.ru","aol.com","wp.pl","naver.com","seznam.cz","o2.pl","comcast.net","ymail.com","verizon.net","sbcglobal.net","att.net","mojang.com"],topLevelDomains:["co.jp","co.uk","com","net","org","info","edu","gov","mil","ca","de","fr","es","pl","ru","cz","br","nl","au","mx","jp","kr","cn","se"],email:n,suggested:function(e){t.setSuggestedEmail(e.full)},empty:function(){t.clearSuggestedEmail()}}):n&&n.length>0&&n!==this.get("suggestedEmail")&&t.clearSuggestedEmail()},clearSuggestedEmail:function(){this.set({suggestedEmail:""})},setSuggestedEmail:function(e){this.set({suggestedEmail:e})}};n.exports=i}),define("packages/register/models/registerModel",["require","exports","module","underscore","backbone","app-config","i18n","env","moment","core/model","core/validators","components/mailcheck/models/mailcheckModel"],function(e,t,n){"use strict";var i=e("underscore"),r=e("backbone"),s=e("app-config"),o=e("i18n"),a=e("env"),l=e("moment"),c=e("core/model"),u=e("core/validators"),d=e("components/mailcheck/models/mailcheckModel");i.extend(r.Validation.validators,u);var h=c.extend({_url:a.getEndpoint("register"),defaults:{},validation:{email:{required:!0,pattern:"email",msg:o.gettext("Email is required")},repeatEmail:{equalTo:"email",msg:o.gettext("The emails does not match")},password:[{minLength:8,maxLength:256,msg:o.gettext("Password must be at least 8 characters")},{passwordCharacteristics:2}],repeatPassword:{equalTo:"password",msg:o.gettext("The passwords does not match")},dobDay:{min:1,required:!0,msg:o.gettext("You need to enter a valid day")},dobMonth:{min:1,required:!0,msg:o.gettext("You need to enter a valid month")},dobYear:{min:1900,required:!0,msg:o.gettext("You need to enter a valid year")},dob:function(e){if(e){return this.isValid("dobDay")&&this.isValid("dobMonth")&&this.isValid("dobYear")&&!this.isDateOfBirthValid()?o.gettext("Time travellers not supported"):void 0}}},initialize:function(){this.set("source",s.registerForm.source),this.on({"change:email":this._checkMail}),i.extend(this,d)},setUrl:function(){this.url=this._url},getDateOfBirth:function(){return this.get("dob")},isDateOfBirthValid:function(){return l(this.getDateOfBirth())<=l()}});n.exports=h}),define("hbs!packages/register/templates/register",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a='<p class="lead alert alert-danger">\n  '+o((t.gettext||e&&e.gettext||s).call(e,"Login failed!",{name:"gettext",hash:{},data:i}))+"\n</p>\n<p>\n    "+o((t.gettext||e&&e.gettext||s).call(e,"Your account was created but unfortunately we were not able to automatically log you in.",{name:"gettext",hash:{},data:i}))+"\n</p>\n<p>";return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.loginUrl:e,null!=e?e.email:e,{name:"gettext_block",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+"\n</p>\n"},2:function(e,t,n,i){return'To continue please <a href="%1$s">log in manually</a> using <strong>%2$s</strong> and your password.'},4:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a=this.lambda,l="\n";return r=t.if.call(e,null!=e?e.redeem:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.program(8,i),data:i}),null!=r&&(l+=r),l+='<form method="post" role="form" novalidate>\n    '+o((t.view||e&&e.view||s).call(e,null!=e?e.formError:e,{name:"view",hash:{},data:i}))+'\n    <div class="form-group">\n        <label for="'+o(a(i&&i.cid,e))+'-email">'+o((t.gettext||e&&e.gettext||s).call(e,"Email address",{name:"gettext",hash:{},data:i}))+'</label>\n        <input id="'+o(a(i&&i.cid,e))+'-email" type="email" class="form-control domain-check" name="email" placeholder="'+o((t.gettext||e&&e.gettext||s).call(e,"yourname@youremailprovider.com",{name:"gettext",hash:{},data:i}))+'">\n        <span class="help-block help-block--feedback hidden"></span>\n        <div id="mailcheck" class="mail-help-block mailcheck hidden">\n\n        </div>\n    </div>\n    <div class="form-group">\n        <label for="'+o(a(i&&i.cid,e))+'-repeat-email">'+o((t.gettext||e&&e.gettext||s).call(e,"Repeat email address",{name:"gettext",hash:{},data:i}))+'</label>\n        <input id="'+o(a(i&&i.cid,e))+'-repeat-email" type="email" class="form-control" name="repeatEmail" placeholder="'+o((t.gettext||e&&e.gettext||s).call(e,"yourname@youremailprovider.com",{name:"gettext",hash:{},data:i}))+'">\n        <span class="help-block help-block--feedback hidden"></span>\n    </div>\n    <div class="form-group">\n        <label for="'+o(a(i&&i.cid,e))+'-password">'+o((t.gettext||e&&e.gettext||s).call(e,"Password",{name:"gettext",hash:{},data:i}))+'</label>\n        <input id="'+o(a(i&&i.cid,e))+'-password" type="password" class="form-control" name="password" placeholder="'+o((t.gettext||e&&e.gettext||s).call(e,"Password",{name:"gettext",hash:{},data:i}))+'">\n        <span class="help-block help-block--feedback hidden"></span>\n    </div>\n    <div class="form-group">\n        <label for="'+o(a(i&&i.cid,e))+'-repeat-password">'+o((t.gettext||e&&e.gettext||s).call(e,"Repeat password",{name:"gettext",hash:{},data:i}))+'</label>\n        <input id="'+o(a(i&&i.cid,e))+'-repeat-password" type="password" class="form-control" name="repeatPassword" placeholder="'+o((t.gettext||e&&e.gettext||s).call(e,"Password",{name:"gettext",hash:{},data:i}))+'">\n        <span class="help-block help-block--feedback hidden"></span>\n    </div>\n    <div class="form-group">\n        <h5>'+o((t.gettext||e&&e.gettext||s).call(e,"Date of birth",{name:"gettext",hash:{},data:i}))+'</h5>\n        <label class="sr-only" for="'+o(a(i&&i.cid,e))+'-dob-day">'+o((t.gettext||e&&e.gettext||s).call(e,"Day",{name:"gettext",hash:{},data:i}))+'</label>\n        <select id="'+o(a(i&&i.cid,e))+'-dob-day" name="dobDay">\n            <option value="0">'+o((t.gettext||e&&e.gettext||s).call(e,"Day",{name:"gettext",hash:{},data:i
}))+'</option>\n            <option value="1">1</option>\n            <option value="2">2</option>\n            <option value="3">3</option>\n            <option value="4">4</option>\n            <option value="5">5</option>\n            <option value="6">6</option>\n            <option value="7">7</option>\n            <option value="8">8</option>\n            <option value="9">9</option>\n            <option value="10">10</option>\n            <option value="11">11</option>\n            <option value="12">12</option>\n            <option value="13">13</option>\n            <option value="14">14</option>\n            <option value="15">15</option>\n            <option value="16">16</option>\n            <option value="17">17</option>\n            <option value="18">18</option>\n            <option value="19">19</option>\n            <option value="20">20</option>\n            <option value="21">21</option>\n            <option value="22">22</option>\n            <option value="23">23</option>\n            <option value="24">24</option>\n            <option value="25">25</option>\n            <option value="26">26</option>\n            <option value="27">27</option>\n            <option value="28">28</option>\n            <option value="29">29</option>\n            <option value="30">30</option>\n            <option value="31">31</option>\n        </select>\n        <label class="sr-only" for="'+o(a(i&&i.cid,e))+'-dob-month">'+o((t.gettext||e&&e.gettext||s).call(e,"Month",{name:"gettext",hash:{},data:i}))+'</label>\n        <select id="'+o(a(i&&i.cid,e))+'-dob-month" name="dobMonth">\n            <option value="0">'+o((t.gettext||e&&e.gettext||s).call(e,"Month",{name:"gettext",hash:{},data:i}))+'</option>\n            <option value="1">'+o((t.gettext||e&&e.gettext||s).call(e,"January",{name:"gettext",hash:{},data:i}))+'</option>\n            <option value="2">'+o((t.gettext||e&&e.gettext||s).call(e,"February",{name:"gettext",hash:{},data:i}))+'</option>\n            <option value="3">'+o((t.gettext||e&&e.gettext||s).call(e,"March",{name:"gettext",hash:{},data:i}))+'</option>\n            <option value="4">'+o((t.gettext||e&&e.gettext||s).call(e,"April",{name:"gettext",hash:{},data:i}))+'</option>\n            <option value="5">'+o((t.gettext||e&&e.gettext||s).call(e,"May",{name:"gettext",hash:{},data:i}))+'</option>\n            <option value="6">'+o((t.gettext||e&&e.gettext||s).call(e,"June",{name:"gettext",hash:{},data:i}))+'</option>\n            <option value="7">'+o((t.gettext||e&&e.gettext||s).call(e,"July",{name:"gettext",hash:{},data:i}))+'</option>\n            <option value="8">'+o((t.gettext||e&&e.gettext||s).call(e,"August",{name:"gettext",hash:{},data:i}))+'</option>\n            <option value="9">'+o((t.gettext||e&&e.gettext||s).call(e,"September",{name:"gettext",hash:{},data:i}))+'</option>\n            <option value="10">'+o((t.gettext||e&&e.gettext||s).call(e,"October",{name:"gettext",hash:{},data:i}))+'</option>\n            <option value="11">'+o((t.gettext||e&&e.gettext||s).call(e,"November",{name:"gettext",hash:{},data:i}))+'</option>\n            <option value="12">'+o((t.gettext||e&&e.gettext||s).call(e,"December",{name:"gettext",hash:{},data:i}))+'</option>\n        </select>\n        <label class="sr-only" for="'+o(a(i&&i.cid,e))+'-dob-year">'+o((t.gettext||e&&e.gettext||s).call(e,"Year",{name:"gettext",hash:{},data:i}))+'</label>\n        <select id="'+o(a(i&&i.cid,e))+'-dob-year" name="dobYear">\n            <option value="0">'+o((t.gettext||e&&e.gettext||s).call(e,"Year",{name:"gettext",hash:{},data:i}))+"</option>\n",r=t.each.call(e,null!=e?e.availableYears:e,{name:"each",hash:{},fn:this.program(15,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+='        </select>\n        <span class="help-block help-block--feedback hidden"></span>\n        <input type="hidden" name="dob">\n    </div>\n    <div class="form-group">\n      ',r=(t.view||e&&e.view||s).call(e,null!=e?e.submitButton:e,{name:"view",hash:{},fn:this.program(17,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+="\n      ",r=(t.view||e&&e.view||s).call(e,null!=e?e.reCaptcha:e,{name:"view",hash:{},fn:this.program(19,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+="\n    </div>\n",r=t.if.call(e,null!=e?e.inlucdeEula:e,{name:"if",hash:{},fn:this.program(21,i),inverse:this.program(24,i),data:i}),null!=r&&(l+=r),l+"</form>\n"},5:function(e,t,n,i){var r,s=t.helperMissing,o='  <p class="lead">';return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.product:e,null!=e?e.loginUrl:e,{name:"gettext_block",hash:{},fn:this.program(6,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"</p>\n"},6:function(e,t,n,i){return'In order to redeem your gift code or pre-paid card for %1$s you first need to register a Mojang account. If you already have one, <a href="%2$s">log in</a>!'},8:function(e,t,n,i){var r,s="";return r=t.if.call(e,null!=e?e.minecraft:e,{name:"if",hash:{},fn:this.program(9,i),inverse:this.program(12,i),data:i}),null!=r&&(s+=r),s},9:function(e,t,n,i){var r,s=t.helperMissing,o='    <p class="lead">';return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.loginUrl:e,{name:"gettext_block",hash:{},fn:this.program(10,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"</p>\n"},10:function(e,t,n,i){return'Ready to buy Minecraft: Java Edition? You\'ll get a free code for Minecraft for Windows 10, too! You just need to set up a Mojang account. If you already have one, <a href="%1$s">log in</a>!'},12:function(e,t,n,i){var r,s=t.helperMissing,o='    <p class="lead">';return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.product:e,null!=e?e.loginUrl:e,{name:"gettext_block",hash:{},fn:this.program(13,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"</p>\n"},13:function(e,t,n,i){return'You\'ll need a Mojang account to buy %1$s. If you already have one, <a href="%2$s">log in</a>!'},15:function(e,t,n,i){var r=this.lambda,s=this.escapeExpression;return'              <option value="'+s(r(e,e))+'">'+s(r(e,e))+"</option>\n"},17:function(e,t,n,i){var r=t.helperMissing;return(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Create account",{name:"gettext",hash:{},data:i}))},19:function(e,t,n,i){return""},21:function(e,t,n,i){var r,s=t.helperMissing,o='    <p class="help-block">';return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.termsLink:e,null!=e?e.privacyLink:e,null!=e?e.eulaLink:e,null!=e?e.productName:e,{name:"gettext_block",hash:{},fn:this.program(22,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"</p>\n"},22:function(e,t,n,i){return'By submitting this form you accept the <a href="%1$s" target="_blank">terms and conditions</a> including our <a href="%2$s" target="_blank">privacy policy</a>  and the <a href="%3$s" target="_blank">%4$s End User License Agreement</a>.'},24:function(e,t,n,i){var r,s=t.helperMissing,o='    <p class="help-block">';return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.termsLink:e,null!=e?e.privacyLink:e,{name:"gettext_block",hash:{},fn:this.program(25,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"</p>\n"},25:function(e,t,n,i){return'By submitting this form you accept the <a href="%1$s" target="_blank">terms and conditions</a> including our <a href="%2$s" target="_blank">privacy policy</a>.'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a='<h1 class="view-title">'+o((t.gettext||e&&e.gettext||s).call(e,"Create your Mojang account",{name:"gettext",hash:{},data:i}))+"</h1>\n";return r=t.if.call(e,null!=e?e.loginError:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(4,i),data:i}),null!=r&&(a+=r),a+"\n"},useData:!0})}),define("packages/register/views/registerView",["require","exports","module","underscore","backbone","app-config","moment","i18n","core/view","core/xhr-errors","appPubSubTopics","core/analytics","components/mailcheck/views/mailcheckView","packages/register/models/registerModel","components/submit-button/views/submitButtonView","components/recaptcha/views/reCaptchaView","components/error-message/views/errorMessageView","hbs!packages/register/templates/register"],function(e,t,n){"use strict";var i=e("underscore"),r=e("backbone"),s=e("app-config"),o=e("moment"),a=e("i18n"),l=e("core/view"),c=e("core/xhr-errors"),u=e("appPubSubTopics"),d=e("core/analytics"),h=e("components/mailcheck/views/mailcheckView"),p=e("packages/register/models/registerModel"),f=e("components/submit-button/views/submitButtonView"),m=e("components/recaptcha/views/reCaptchaView"),g=e("components/error-message/views/errorMessageView"),v=e("hbs!packages/register/templates/register"),y=new p;r.Validation.configure({forceUpdate:!0});var b=l.extend(i.extend({},c,{className:"view-register",template:v,model:new p,validationModel:y,submitButton:null,reCaptcha:null,formError:null,bindings:{"[name=email]":{observe:"email",setOptions:{validate:!0}},"[name=repeatEmail]":{observe:"repeatEmail",setOptions:{validate:!0}},"[name=password]":{observe:"password",setOptions:{validate:!0}},"[name=repeatPassword]":{observe:"repeatPassword",setOptions:{validate:!0}},"[name=dobDay]":{observe:"dobDay",setOptions:{validate:!0}},"[name=dobMonth]":{observe:"dobMonth",setOptions:{validate:!0}},"[name=dobYear]":{observe:"dobYear",setOptions:{validate:!0}},"[name=dob]":{observe:"dob",setOptions:{validate:!0}}},initialize:function(e){i.extend(this,h),this.assignViewTexts(),this.submitButton=new f({className:"btn btn-block btn-primary btn-lg",loadingText:a.gettext("Creating account...")}),s.reCaptcha&&(this.reCaptcha=new m({config:{sitekey:s.reCaptcha.sitekey,size:"invisible"}})),this.formError=new g,this.setupMailcheck("email",this.validationModel),this.model.on("error",this._handleError,this),this.product=s.productName,this.minecraft="Minecraft"===this.product,this.loginUrl=s.loginUrl,r.Validation.bind(this,{model:y}),this.initSubscribers(),this.analytics.pageView("/register")},initSubscribers:function(){this.pubSub.subscribe(u.AUTH_ERROR,i.bind(this._onPostRegistrationLoginError,this))},events:{"submit form":"_onFormSubmit","change [name=dobDay]":"_setHiddenDob","change [name=dobMonth]":"_setHiddenDob","change [name=dobYear]":"_setHiddenDob","change [name=email]":"_hideError",rendered:function(){this.stickit(y)}},_setHiddenDob:function(e){var t,n,i,r;t=this.$el.find("[name=dobDay]").val(),i=this.$el.find("[name=dobMonth]").val(),n=this.$el.find("[name=dobYear]").val(),"Invalid date"!==(r=this._getDate(t,i,n))&&this.$el.find("[name=dob]").val(r).trigger("change")},_getDate:function(e,t,n){return o(n+"-"+t+"-"+e,"YYYY-MM-DD").format("YYYY-MM-DD")},_hideError:function(){this.formError.removeMessage()},availableYears:function(){for(var e=[],t=o().format("YYYY");t>=1900;t--)e.push(t);return e},assignViewTexts:function(){this.termsLink=s.registerForm.termsLink,this.privacyLink=s.registerForm.privacyLink,this.eulaLink=s.registerForm.eulaLink,this.productName=s.productName,this.includeEula=!(!this.eulaLink||!this.productName)},_handleError:function(e,t,n){var i=t.responseJSON?t.responseJSON.errorMessage:"",r=e.get("email");i==="User with email "+r+" already exists"?this.formError.setMessage(a.sprintf(a.gettext("There's already another account registered with %1$s. Please use a different email address."),r)):"Invalid e-mail address."===i?this.formError.setMessage(a.gettext("The email address that you've entered is invalid.")):"Email domain is not allowed."===i?this.formError.setMessage(a.gettext("Disposable email domain is not allowed. You'll need continues access to the email address connected to your account.")):this.publishError(this._getRegistrationErrorTitle(t),this._getRegistrationErrorMessage(t),t),this.submitButton.reset(),this.reCaptcha&&this.reCaptcha.reset()},_getRegistrationErrorTitle:function(e){return this._isBadRequest(e)?a.gettext("Invalid registration"):this._isTooManyRequests(e)?a.gettext("Recently registered account"):this._getErrorTitle(e)},_getRegistrationErrorMessage:function(e){return this._isBadRequest(e)?a.gettext("Please go back and double check your information and make sure that it is valid."):this._isTooManyRequests(e)?a.gettext("You've recently registered an account. You need to wait before you can register another account."):this._isInternalServerError(e)||this._isNotFound(e)?a.gettext("An error prevented your registration from being completed. Please try again."):this._getErrorMessage(e)},_onFormSubmit:function(e){e.preventDefault(),this.serialize(e,function(e,t){this._validate()&&(this.model.set(this.validationModel.attributes),this.submitButton.setLoading(),this.pubSub.publish(u.USER_REGISTER,{model:this.model})),t()})},_validate:function(){return this.validationModel.validate(),this.validationModel.isValid()?!this.reCaptcha||this.reCaptcha.validate():(this._sendValidationAnalytics("Register account",this.validationModel),!1)},_onPostRegistrationLoginError:function(e,t){d.event("PostRegistration","Login","Failed"),this.loginError=!0,this.render()}}));n.exports=b}),define("packages/parental-consent/models/consentRequestModel",["require","exports","module","underscore","i18n","env","app-config","core/model","components/mailcheck/models/mailcheckModel","core/user/models/sessionModel"],function(e,t,n){"use strict";var i=e("underscore"),r=e("i18n"),s=e("env"),o=e("app-config"),a=e("core/model"),l=e("components/mailcheck/models/mailcheckModel"),c=e("core/user/models/sessionModel"),u=a.extend({defaults:{},validation:{parentEmail:{required:!0,pattern:"email",msg:r.gettext("A valid email is required")},repeatParentEmail:{equalTo:"parentEmail",msg:r.gettext("The emails does not match")}},initialize:function(){this.url=s.getEndpoint("consent"),o.order.agent&&this.set("agent",o.order.agent),this.set("username",c.getInstance().getUsername()),i.extend(this,l)},getSaveData:function(){var e,t;return e={email:this.get("username"),emailOfParent:this.get("parentEmail")},t=this.get("agent"),t&&(e.agent=t),e}});n.exports=u}),define("hbs!packages/parental-consent/templates/index",["handlebars"],function(e){return e.template({1:function(e,t,n,i){return"Parental permission is required for complying with the %1$s, which was implemented to help protect children and their privacy."},3:function(e,t,n,i){var r=t.helperMissing;return'    <p class="text-success">\n        '+(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Great! We've sent an e-mail to your parent with further instructions. Please ask your parent to check their inbox.",{name:"gettext",hash:{},data:i}))+"\n    </p>\n"},5:function(e,t,n,i){var r,s=this.lambda,o=this.escapeExpression,a=t.helperMissing,l='    <form method="post"role="form" novalidate>\n        <div class="form-group">\n            <label for="'+o(s(i&&i.cid,e))+'-parent-email">'+o((t.gettext||e&&e.gettext||a).call(e,"Parent's email address",{name:"gettext",hash:{},data:i}))+'</label>\n            <input id="'+o(s(i&&i.cid,e))+'-parent-email" type="email" class="form-control domain-check" name="parentEmail" placeholder="'+o((t.gettext||e&&e.gettext||a).call(e,"parentsname@parentsemailprovider.com",{name:"gettext",hash:{},data:i}))+'" autocomplete="off">\n            <span class="help-block help-block--feedback hidden"></span>\n            <div id="mailcheck" class="mail-help-block mailcheck hidden">\n            </div>\n        </div>\n        <div class="form-group">\n            <label for="'+o(s(i&&i.cid,e))+'-parent-email-repeat">'+o((t.gettext||e&&e.gettext||a).call(e,"Repeat parent's email address",{name:"gettext",hash:{},data:i}))+'</label>\n            <input id="'+o(s(i&&i.cid,e))+'-parent-email-repeat" type="email" class="form-control" name="repeatParentEmail" placeholder="'+o((t.gettext||e&&e.gettext||a).call(e,"parentsname@parentsemailprovider.com",{name:"gettext",hash:{},data:i}))+'" autocomplete="off">\n            <span class="help-block help-block--feedback hidden"></span>\n        </div>\n        <div class="form-group">\n          ';return r=(t.view||e&&e.view||a).call(e,null!=e?e.submitButton:e,{name:"view",hash:{},fn:this.program(6,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+='\n        </div>\n    </form>\n    <p class="help-block">\n      ',r=(t.gettext_block||e&&e.gettext_block||a).call(e,null!=e?e.redeemPrepaidUrl:e,"https://minecraft.net/realms",{name:"gettext_block",hash:{},fn:this.program(8,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+='\n    </p>\n    <p class="help-block">\n        ',r=(t.gettext_block||e&&e.gettext_block||a).call(e,"https://help.mojang.com/customer/portal/articles/1780997-mojang-account-users-under-13",{name:"gettext_block",hash:{},fn:this.program(10,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+"\n    </p>\n"},6:function(e,t,n,i){var r=t.helperMissing;return(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Request permission",{name:"gettext",hash:{},data:i}))},8:function(e,t,n,i){return'If you wish to <a href="%1$s">redeem a code or a pre-paid card</a> you can still do so without us first obtaining permission. We do however still need to obtain parental permission should you wish to play on <a href="%2$s">Minecraft Realms</a>.'},10:function(e,t,n,i){return'Need help obtaining parental permission? <a href="%1$s" target="_blank">Read this help article</a>.'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a="<h1>"+o((t.gettext||e&&e.gettext||s).call(e,"You need a parent's permission",{name:"gettext",hash:{},data:i}))+"</h1>\n\n  <p>\n    "+o((t.gettext||e&&e.gettext||s).call(e,"Before you can continue to buy Minecraft, we need to obtain parental permission.",{name:"gettext",hash:{},data:i}))+"\n  </p>\n  <p>\n    ";return r=(t.gettext_block||e&&e.gettext_block||s).call(e,(t.safe||e&&e.safe||s).call(e,'<a href="http://www.ftc.gov/enforcement/rules/rulemaking-regulatory-reform-proceedings/childrens-online-privacy-protection-rule" target="_blank">Children\'s Online Privacy Protection Act (COPPA)</a>',{name:"safe",hash:{},data:i}),{name:"gettext_block",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+="\n  </p>\n",r=t.if.call(e,null!=e?e.sent:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.program(5,i),data:i}),null!=r&&(a+=r),a+"\n"},useData:!0})}),define("packages/parental-consent/views/consentView",["require","exports","module","underscore","backbone","i18n","core/view","core/xhr-errors","packages/parental-consent/models/consentRequestModel","components/mailcheck/views/mailcheckView","components/submit-button/views/submitButtonView","appPubSubTopics","hbs!packages/parental-consent/templates/index","app-config"],function(e,t,n){"use strict";var i=e("underscore"),r=e("backbone"),s=e("i18n"),o=e("core/view"),a=e("core/xhr-errors"),l=e("packages/parental-consent/models/consentRequestModel"),c=e("components/mailcheck/views/mailcheckView"),u=e("components/submit-button/views/submitButtonView"),d=e("appPubSubTopics"),h=e("hbs!packages/parental-consent/templates/index"),p=e("app-config"),f=new l;r.Validation.configure({forceUpdate:!0});var m={className:"view-parental-consent",template:h,controller:void 0,model:f,submitButton:null,bindings:{"[name=parentEmail]":{observe:"parentEmail",setOptions:{validate:!0,silent:!0}},"[name=repeatParentEmail]":{observe:"repeatParentEmail",setOptions:{validate:!0,silent:!0}}},initialize:function(e){i.extend(this,c),this.redeemPrepaidUrl=p.redeemPrepaidUrl,this.submitButton=new u({className:"btn btn-block btn-primary btn-lg",loadingText:s.gettext("Sending permission request...")}),this.setupMailcheck("parentEmail"),this.model.on("error",this._handleError,this),r.Validation.bind(this,{model:this.model}),this.pubSub.publish(d.PROGRESS_HIDE),this.analytics.pageView("/consent")},events:{"submit form":"_onFormSubmit",rendered:function(){this.stickit(this.model)}},_onFormSubmit:function(e){e.preventDefault(),this.serialize(e,function(e,t){this.model.validate(),this.model.isValid()?(this.submitButton.setLoading(),this.controller.sendConsentRequest(this.model,this._handleError)):(this._sendValidationAnalytics("Request parental consent",this.model),this.submitButton.reset()),t()})},_handleError:function(e,t,n){this.publishError(this._getConsentRequestErrorTitle(t),this._getConsentRequestErrorMessage(t),t),this.submitButton.reset()},_getConsentRequestErrorTitle:function(e){return this._isBadRequest(e)?s.gettext("Invalid parental consent request"):s.gettext("Could not send parental consent request")},_getConsentRequestErrorMessage:function(e){return this._isBadRequest(e)?s.gettext("Please go back and double check your information and make sure that it is valid."):this._isInternalServerError(e)||this._isNotFound(e)?s.gettext("An error prevented your parental consent request from being sent. Please try again."):void 0}};i.extend(m,a),n.exports=o.extend(m)}),define("packages/verify-email/models/verifyModel",["require","exports","module","i18n","env","core/model"],function(e,t,n){"use strict";var i=e("i18n"),r=e("env"),s=e("core/model"),o=s.extend({validation:{email:{required:!0,msg:i.gettext("A valid email is required")},token:{required:!0,length:4,msg:i.gettext("You need to enter the code included in the verification email we sent you. It should be four characters long.")}},getEndpointUrl:function(){return r.getEndpoint("verify",{email:this.get("email"),token:this.get("token").toUpperCase()})}});n.exports=o}),define("hbs!packages/verify-email/templates/verifyEmail",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l="  <h1>"+a((t.gettext||e&&e.gettext||o).call(e,"Verify your email address",{name:"gettext",hash:{},data:i}))+'</h1>\n  <p class="lead">\n      '+a((t.gettext||e&&e.gettext||o).call(e,"You are trying to verify a different account from the one that you are logged in to.",{name:"gettext",hash:{},data:i}))+"\n  </p>\n  <p>\n      "+a((t.gettext||e&&e.gettext||o).call(e,"Which email address do you want to verify?",{name:"gettext",hash:{},data:i}))+'\n  </p>\n  <p>\n      <a href="#" class="verifyCurrentLink">';return r=(t.gettext_block||e&&e.gettext_block||o).call(e,null!=e?e.authenticatedEmail:e,{name:"gettext_block",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+='</a>\n  </p>\n  <p>\n      <a href="'+a((s=null!=(s=t.verifyOtherUrl||(null!=e?e.verifyOtherUrl:e))?s:o,"function"==typeof s?s.call(e,{name:"verifyOtherUrl",hash:{},data:i}):s))+'">',r=(t.gettext_block||e&&e.gettext_block||o).call(e,null!=e?e.email:e,{name:"gettext_block",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+"</a>\n  </p>\n"},2:function(e,t,n,i){return"I would like to verify <strong>%1$s</strong>"},4:function(e,t,n,i){var r,s="";return r=t.if.call(e,null!=e?e.sent:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.program(7,i),data:i}),null!=r&&(s+=r),s+="  <p>\n",r=t.if.call(e,null!=e?e.showEmail:e,{name:"if",hash:{},fn:this.program(9,i),inverse:this.program(12,i),data:i}),null!=r&&(s+=r),s+="  </p>\n",r=t.if.call(e,null!=e?e.email:e,{name:"if",hash:{},fn:this.program(14,i),inverse:this.noop,data:i}),null!=r&&(s+=r),s+="\n",r=t.if.call(e,null!=e?e.isAuthenticated:e,{name:"if",hash:{},fn:this.program(17,i),inverse:this.noop,data:i}),null!=r&&(s+=r),s+"\n\n"},5:function(e,t,n,i){var r=t.helperMissing,s=this.escapeExpression;return"  <h1>"+s((t.gettext||e&&e.gettext||r).call(e,"We're almost there",{name:"gettext",hash:{},data:i}))+"</h1>\n\n  <p>"+s((t.gettext||e&&e.gettext||r).call(e,"Before we can create your account, you will need to verify your email address. Check your inbox for our mail, then type the super secret 4-letter code into the box below. Then click the button!",{name:"gettext",hash:{},data:i}))+"</p>\n\n"},7:function(e,t,n,i){var r=t.helperMissing;return"  <h1>"+(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Verify your email address",{name:"gettext",hash:{},data:i}))+"</h1>\n"},9:function(e,t,n,i){var r,s=t.helperMissing,o="    ";return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.email:e,{name:"gettext_block",hash:{},fn:this.program(10,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"\n"},10:function(e,t,n,i){return"Check your <strong>%1$s</strong> inbox and make sure to check your spam folder as well."},12:function(e,t,n,i){var r=t.helperMissing;return"    "+(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Check your inbox and make sure to check your spam folder as well.",{name:"gettext",hash:{},data:i}))+"\n"},14:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a="\n  "+o((t.view||e&&e.view||s).call(e,null!=e?e.formError:e,{name:"view",hash:{},data:i}))+'\n\n  <form method="post" role="form">\n      <div class="row">\n        <div class="form-group col-sm-12">\n            <label for="token">'+o((t.gettext||e&&e.gettext||s).call(e,"Verification code",{name:"gettext",hash:{},data:i}))+'</label>\n            <input class="verify-account-form__code form-control text-center" name="token" type="text" maxlength="4">\n            <span class="help-block help-block--feedback hidden"></span>\n        </div>\n        <div class="form-group col-sm-12">\n          ';return r=(t.view||e&&e.view||s).call(e,null!=e?e.submitButton:e,{name:"view",hash:{},fn:this.program(15,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+"\n        </div>\n      </div>\n\n  </form>\n"},15:function(e,t,n,i){var r=t.helperMissing;return(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Verify",{name:"gettext",hash:{},data:i}))},17:function(e,t,n,i){var r,s,o,a=t.helperMissing,l=t.blockHelperMissing,c='  <div class="view-validate-email__request-verification-email">\n    <p>\n      ';return s=null!=(s=t.gettext_block||(null!=e?e.gettext_block:e))?s:a,o={name:"gettext_block",hash:{},fn:this.program(18,i),inverse:this.noop,data:i},r="function"==typeof s?s.call(e,o):s,t.gettext_block||(r=l.call(e,r,o)),null!=r&&(c+=r),c+="\n    </p>\n",r=t.if.call(e,null!=e?e.dispathedNewVerification:e,{name:"if",hash:{},fn:this.program(20,i),inverse:this.noop,data:i}),null!=r&&(c+=r),r=t.if.call(e,null!=e?e.dispathedNewVerificationError:e,{name:"if",hash:{},fn:this.program(23,i),inverse:this.noop,data:i}),null!=r&&(c+=r),c+"  </div>\n"},18:function(e,t,n,i){return'Can\'t find your verification code? <button class="btn-link" type="button" name="request-verification-email" >Request a new code</button>'},20:function(e,t,n,i){var r,s,o,a=t.helperMissing,l=t.blockHelperMissing,c='    <p class="alert alert-success" role="alert"> ';return s=null!=(s=t.gettext_block||(null!=e?e.gettext_block:e))?s:a,o={name:"gettext_block",hash:{},fn:this.program(21,i),inverse:this.noop,data:i},r="function"==typeof s?s.call(e,o):s,t.gettext_block||(r=l.call(e,r,o)),null!=r&&(c+=r),c+" </p>\n"},21:function(e,t,n,i){return"We've dispatched a new verification e-mail to your inbox."},23:function(e,t,n,i){var r,s=t.helperMissing;return'    <p class="alert alert-danger" role="alert">'+(0,this.escapeExpression)((r=null!=(r=t.dispathedNewVerificationErrorMessage||(null!=e?e.dispathedNewVerificationErrorMessage:e))?r:s,"function"==typeof r?r.call(e,{name:"dispathedNewVerificationErrorMessage",hash:{},data:i}):r))+"</p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s="";return r=t.if.call(e,null!=e?e.emailMismatch:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(4,i),data:i}),null!=r&&(s+=r),s},useData:!0})}),define("packages/verify-email/views/verifyView",["require","exports","module","underscore","app-config","backbone","i18n","appPubSubTopics","core/view","core/xhr-errors","core/user/models/userModel","packages/verify-email/models/verifyModel","core/user/models/sessionModel","components/submit-button/views/submitButtonView","components/error-message/views/errorMessageView","hbs!packages/verify-email/templates/verifyEmail"],function(e,t,n){"use strict";var i=e("underscore"),r=e("app-config"),s=e("backbone"),o=e("i18n"),a=e("appPubSubTopics"),l=e("core/view"),c=e("core/xhr-errors"),u=e("core/user/models/userModel"),d=e("packages/verify-email/models/verifyModel"),h=e("core/user/models/sessionModel"),p=e("components/submit-button/views/submitButtonView"),f=e("components/error-message/views/errorMessageView"),m=e("hbs!packages/verify-email/templates/verifyEmail");s.Validation.configure({forceUpdate:!0});var g={className:"view-validate-email",template:m,submitButton:null,formError:null,dispathedNewVerification:!1,dispathedNewVerificationError:!1,dispathedNewVerificationErrorMessage:null,bindings:{"[name=token]":{observe:"token",setOptions:{validate:!0,silent:!0}}},events:{"submit form":"_onFormSubmit","click .verifyCurrentLink":"_onVerifyCurrentClick","change [name=token]":"_hideError","click [name=request-verification-email]":"_onRequestVerificationEmailClick",rendered:function(){this.stickit(this.model)}},initialize:function(e){this.formError=new f,this.submitButton=new p({className:"btn btn-block btn-primary btn-lg",loadingText:o.gettext("Verifying email address...")}),this.model=new d({email:this.email,token:this.token}),this.authenticatedEmail=h.getInstance().getUsername(),this.isAuthenticated=h.getInstance().isAuthenticated(),s.Validation.bind(this,{model:this.model}),u.getInstance().isRegistered()?this._eMailMatchesLogin(this.model.get("email"))||(this.emailMismatch=!0,this.verifyOtherUrl=r.logoutUrl+"?redirectUrl="+encodeURIComponent(window.location.pathname+"#verify")):this.pubSub.publish(a.PROGRESS_HIDE),this.analytics.pageView("/verify")},showEmail:function(){return-1!==(this.model.get("email")||"").indexOf("@")},showDispathedNewVerificationEmail:function(){this.dispathedNewVerificationError=!1,this.dispathedNewVerification=!0,this.render()},showDispathedNewVerificationEmailError:function(e){this.dispathedNewVerification=!1,this.dispathedNewVerificationError=!0,this.dispathedNewVerificationErrorMessage=o.gettext("Request email verification failed. Please try again."),this.render()},_eMailMatchesLogin:function(e){return!e||"string"!=typeof e||((e=e.toLowerCase())===this.authenticatedEmail||e===u.getInstance().getEmail())},handleError:function(e,t,n){this._isBadRequest(e)||this._isForbidden(e)?this.formError.setMessage(o.gettext("Verification failed. Make sure that your verification code and email address are correct.")):this.publishError(this._getVerificationErrorTitle(e),this._getVerificationErrorMessage(e),e),this.submitButton.reset()},_getVerificationErrorTitle:function(e){return o.gettext("Could not complete verification")},_getVerificationErrorMessage:function(e){return this._isTooManyRequests(e)?o.gettext("You've attempted too many account verifications. Please come back later."):o.gettext("An error occurred that prevented your verification from being completed.")},_hideError:function(){this.formError.removeMessage()},_onFormSubmit:function(e){e.preventDefault(),this.serialize(e,function(e,t){this.model.validate(),this.model.isValid()?(this.submitButton.setLoading(),this.pubSub.publish(a.VERIFY_EMAIL,{model:this.model})):(this._sendValidationAnalytics("Verify email",this.model),this.submitButton.reset()),t()})},_onVerifyCurrentClick:function(e){return e.preventDefault(),this.emailMismatch=!1,this.model.set("email",h.getInstance().getUsername()),this.model.unset("token"),!1},_onRequestVerificationEmailClick:function(){this.dispathedNewVerification=!1,this.render(),this.pubSub.publish(a.REQUEST_VERIFICATION_EMAIL,{model:this.model})}};i.extend(g,c),n.exports=l.extend(g)}),define("hbs!packages/order/templates/orderStatus",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r=t.helperMissing;return'    <h3 class="text-info">'+(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Fetching you order...",{name:"gettext",hash:{},data:i}))+"</h3>\n"},3:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a="\n  <h3>"+o((t.gettext||e&&e.gettext||s).call(e,"Order status",{name:"gettext",hash:{},data:i}))+"</h3>\n\n"
;return r=t.if.call(e,null!=e?e.error:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+="\n",r=t.if.call(e,null!=e?e.status:e,{name:"if",hash:{},fn:this.program(9,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+="\n",r=t.if.call(e,null!=e?e.failed:e,{name:"if",hash:{},fn:this.program(12,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+="\n",r=t.if.call(e,null!=e?e.processing:e,{name:"if",hash:{},fn:this.program(15,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+="\n  <h4>\n      "+o((t.gettext||e&&e.gettext||s).call(e,"Need help?",{name:"gettext",hash:{},data:i}))+"\n  </h4>\n\n  <p>\n      ",r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.supportUrl:e,{name:"gettext_block",hash:{},fn:this.program(17,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+"\n  </p>\n"},4:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l='      <div class="alert alert-danger" role="alert">\n        <h4>'+a((s=null!=(s=t.error||(null!=e?e.error:e))?s:o,"function"==typeof s?s.call(e,{name:"error",hash:{},data:i}):s))+"</h4>\n        <p>"+a((s=null!=(s=t.errorMessage||(null!=e?e.errorMessage:e))?s:o,"function"==typeof s?s.call(e,{name:"errorMessage",hash:{},data:i}):s))+"</p>\n";return r=t.if.call(e,null!=e?e.errorDetails:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.program(7,i),data:i}),null!=r&&(l+=r),l+"      </div>\n"},5:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return'          <div class="error-details">\n            <p>\n                '+o((r=null!=(r=t.exception||(null!=e?e.exception:e))?r:s,"function"==typeof r?r.call(e,{name:"exception",hash:{},data:i}):r))+": "+o((r=null!=(r=t.exceptionMessage||(null!=e?e.exceptionMessage:e))?r:s,"function"==typeof r?r.call(e,{name:"exceptionMessage",hash:{},data:i}):r))+"\n            </p>\n          </div>\n"},7:function(e,t,n,i){var r=t.helperMissing;return'        <p><a href="#" class="show-error-details">'+(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Show details",{name:"gettext",hash:{},data:i}))+"</a></p>\n"},9:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l='  <dl class="order dl-horizontal">\n';return r=t.unless.call(e,null!=e?e.failed:e,{name:"unless",hash:{},fn:this.program(10,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+"      <dt>"+a((t.gettext||e&&e.gettext||o).call(e,"Payment provider",{name:"gettext",hash:{},data:i}))+"</dt>\n      <dd>"+a((s=null!=(s=t.provider||(null!=e?e.provider:e))?s:o,"function"==typeof s?s.call(e,{name:"provider",hash:{},data:i}):s))+"</dd>\n      <dt>"+a((t.gettext||e&&e.gettext||o).call(e,"Status",{name:"gettext",hash:{},data:i}))+'</dt>\n      <dd class="order__status '+a((s=null!=(s=t.status||(null!=e?e.status:e))?s:o,"function"==typeof s?s.call(e,{name:"status",hash:{},data:i}):s))+'">'+a((s=null!=(s=t.status||(null!=e?e.status:e))?s:o,"function"==typeof s?s.call(e,{name:"status",hash:{},data:i}):s))+"</dd>\n  </dl>\n"},10:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return"      <dt>"+o((t.gettext||e&&e.gettext||s).call(e,"Order ID",{name:"gettext",hash:{},data:i}))+"</dt>\n      <dd>"+o((r=null!=(r=t.id||(null!=e?e.id:e))?r:s,"function"==typeof r?r.call(e,{name:"id",hash:{},data:i}):r))+"</dd>\n"},12:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a="    <p>\n      "+o((t.gettext||e&&e.gettext||s).call(e,"We were unable to process your order.",{name:"gettext",hash:{},data:i}))+" ";return r=(t.link||e&&e.link||s).call(e,"buy",{name:"link",hash:{},fn:this.program(13,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+"\n    </p>\n"},13:function(e,t,n,i){var r=t.helperMissing;return(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Please try again",{name:"gettext",hash:{},data:i}))},15:function(e,t,n,i){var r=t.helperMissing;return"    <p>\n      "+(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Your order is currently being processed. You will receive an email once processing is complete.",{name:"gettext",hash:{},data:i}))+"\n    </p>\n"},17:function(e,t,n,i){return'If you have any questions regarding your order, please visit our <a href="%1$s">support center</a>.'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s,o,a=t.helperMissing,l=t.blockHelperMissing,c="";return s=null!=(s=t.loading||(null!=e?e.loading:e))?s:a,o={name:"loading",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i},r="function"==typeof s?s.call(e,o):s,t.loading||(r=l.call(e,r,o)),null!=r&&(c+=r),c},useData:!0})}),define("packages/order/views/orderStatusView",["require","exports","module","app-config","core/view","hbs!packages/order/templates/orderStatus"],function(e,t,n){"use strict";var i=e("app-config"),r=e("core/view"),s=e("hbs!packages/order/templates/orderStatus"),o=r.extend({template:s,events:{"click .show-error-details":"_showErrorDetails"},failed:function(){return"FAILED"===this.model.get("status")},processing:function(){return"PROCESSING"===this.model.get("status")},succeeded:function(){return"SUCCEEDED"===this.model.get("status")},initialize:function(e){this.supportUrl=i.supportUrl,this.model.once("sync",function(){},this),this.analytics.pageView("/order/status")},_loadingTimeoutDuration:.1,_showErrorDetails:function(e){return e.preventDefault(),this.model.set("errorDetails",!0),!1}});n.exports=o}),define("hbs!packages/checkout/templates/alreadyOwned",["handlebars"],function(e){return e.template({1:function(e,t,n,i){return"You already own %1$s!"},3:function(e,t,n,i){var r;return r=t.if.call(e,null!=e?e.win10CodeUrl:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=r?r:""},4:function(e,t,n,i){var r,s=t.helperMissing,o="<p>";return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.win10CodeUrl:e,{name:"gettext_block",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"</p>"},5:function(e,t,n,i){return'Looking for the Minecraft for Windows 10 code that came with your game purchase? <a href="%1$s">Click here</a>.'},7:function(e,t,n,i){return"%1$s as a gift"},9:function(e,t,n,i){return"You can‚Äôt own more than one copy of %1$s per account, but you can still buy it for someone else:"},11:function(e,t,n,i){var r,s=t.helperMissing,o="    <h3>\n      ";return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.product:e,{name:"gettext_block",hash:{},fn:this.program(12,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+="\n    </h3>\n    <p>\n      ",r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.giftCodeUrl:e,{name:"gettext_block",hash:{},fn:this.program(14,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"\n    </p>\n"},12:function(e,t,n,i){return"Buy %1$s as a digital gift code"},14:function(e,t,n,i){return'Digital gift codes can be bought and redeemed through the <a href="%1$s">Mojang accounts website</a>.'},16:function(e,t,n,i){return"Buy %1$s as a pre-paid gift card"},18:function(e,t,n,i){return'Physical %1$s gift cards are available in select stores. <a href="%2$s">Find a store near you</a>.'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a='<div class="checkout__already-owned">\n  <h1>';return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.product:e,{name:"gettext_block",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+="</h1>\n\n  ",r=t.if.call(e,null!=e?e.minecraft:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+="\n\n  "+o((t.view||e&&e.view||s).call(e,null!=e?e.downloadView:e,{name:"view",hash:{},data:i}))+"\n\n\n  <h2>",r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.product:e,{name:"gettext_block",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+="</h2>\n\n  <p>\n    ",r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.product:e,{name:"gettext_block",hash:{},fn:this.program(9,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+="\n  </p>\n\n",r=t.if.call(e,null!=e?e.giftCode:e,{name:"if",hash:{},fn:this.program(11,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+="\n  <h3>\n    ",r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.product:e,{name:"gettext_block",hash:{},fn:this.program(16,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+="\n  </h3>\n  <p>\n    ",r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.product:e,null!=e?e.prepaidCardUrl:e,{name:"gettext_block",hash:{},fn:this.program(18,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+"\n  </p>\n</div>\n"},useData:!0})}),define("packages/checkout/views/alreadyOwnedView",["require","exports","module","appPubSubTopics","app-config","core/view","packages/download/views/downloadView","hbs!packages/checkout/templates/alreadyOwned"],function(e,t,n){"use strict";var i=e("appPubSubTopics"),r=e("app-config"),s=e("core/view"),o=e("packages/download/views/downloadView"),a=e("hbs!packages/checkout/templates/alreadyOwned"),l=s.extend({template:a,giftCode:!0,context:{product:r.productName,prepaidCardUrl:r.prepaidCardUrl,giftCodeUrl:r.giftCodeUrl,downloadUrl:r.downloadUrl},initialize:function(e){this.giftCode="US"!==e.countryCode,this.pubSub.publish(i.PROGRESS_HIDE),this.downloadView=new o,this.product=r.productName,this.win10CodeUrl=r.win10CodeUrl,this.minecraft="Minecraft"===this.product,this.analytics.pageView("/owned")}});n.exports=l}),define("hbs!packages/checkout/templates/needToMigrate",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return"<h3>"+o((t.gettext||e&&e.gettext||s).call(e,"You need to migrate your account",{name:"gettext",hash:{},data:i}))+"</h3>\n\n<p>\n    "+o((t.gettext||e&&e.gettext||s).call(e,"In order to make a purchase you first need to migrate your old Minecraft account to a Mojang account.",{name:"gettext",hash:{},data:i}))+'\n</p>\n\n<p>\n    <a href="'+o((r=null!=(r=t.migrationUrl||(null!=e?e.migrationUrl:e))?r:s,"function"==typeof r?r.call(e,{name:"migrationUrl",hash:{},data:i}):r))+'">'+o((t.gettext||e&&e.gettext||s).call(e,"Migrate your account",{name:"gettext",hash:{},data:i}))+"</a>\n</p>\n"},useData:!0})}),define("packages/checkout/views/needToMigrateView",["require","exports","module","app-config","core/view","hbs!packages/checkout/templates/needToMigrate"],function(e,t,n){"use strict";var i=e("app-config"),r=e("core/view"),s=e("hbs!packages/checkout/templates/needToMigrate"),o=r.extend({template:s,giftCode:!0,context:{migrationUrl:i.migrationUrl},initialize:function(){this.analytics.pageView("/migrate")}});n.exports=o}),define("hbs!packages/checkout/templates/orderCanceled",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return"<h3>Your "+o((r=null!=(r=t.product||(null!=e?e.product:e))?r:s,"function"==typeof r?r.call(e,{name:"product",hash:{},data:i}):r))+" order has been canceled</h3>\n\n<p>\n    Per your request we have canceled your "+o((r=null!=(r=t.product||(null!=e?e.product:e))?r:s,"function"==typeof r?r.call(e,{name:"product",hash:{},data:i}):r))+' order.\n</p>\n\n<p>\n    You can always <a href="'+o((r=null!=(r=t.buyUrl||(null!=e?e.buyUrl:e))?r:s,"function"==typeof r?r.call(e,{name:"buyUrl",hash:{},data:i}):r))+'">go back to the purchase page</a> to create a new order.\n</p>\n'},useData:!0})}),define("packages/checkout/views/orderCanceledView",["require","exports","module","appPubSubTopics","app-config","core/view","hbs!packages/checkout/templates/orderCanceled"],function(e,t,n){"use strict";var i=e("appPubSubTopics"),r=e("app-config"),s=e("core/view"),o=e("hbs!packages/checkout/templates/orderCanceled"),a=s.extend({template:o,context:{product:r.order.items[0].displayName,buyUrl:r.buyUrl},initialize:function(e){this.pubSub.publish(i.PROGRESS_HIDE),this.analytics.pageView("/order/canceled")}});n.exports=a}),define("hbs!packages/redeem/templates/redeemed",["handlebars"],function(e){return e.template({1:function(e,t,n,i){return"Congratulations! You now own %1$s."},3:function(e,t,n,i){return"You have successfully redeemed a copy of %1$s."},5:function(e,t,n,i){return'If you have any questions regarding your code, please visit our <a href="%1$s">support center</a>.'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a="<h1>";return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.product:e,{name:"gettext_block",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+='</h1>\n\n<p class="lead text-success">',r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.product:e,{name:"gettext_block",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+="</p>\n\n"+o((t.view||e&&e.view||s).call(e,null!=e?e.downloadView:e,{name:"view",hash:{},data:i}))+"\n\n<h4>\n  "+o((t.gettext||e&&e.gettext||s).call(e,"Need help?",{name:"gettext",hash:{},data:i}))+"\n</h4>\n\n<p>\n  ",r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.supportUrl:e,{name:"gettext_block",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+"\n</p>\n"},useData:!0})}),define("packages/redeem/views/redeemedView",["require","exports","module","app-config","core/view","packages/download/views/downloadView","hbs!packages/redeem/templates/redeemed"],function(e,t,n){"use strict";var i=e("app-config"),r=e("core/view"),s=e("packages/download/views/downloadView"),o=e("hbs!packages/redeem/templates/redeemed"),a=r.extend({template:o,initialize:function(e){this.product=i.productName,this.downloadView=new s,this.analytics.pageView("/redeemed")}});n.exports=a}),define("packages/order-flow/routers/router",["require","exports","module","jquery","core/router","app-config","core/user/models/userModel","components/loader/views/loaderView","packages/checkout/views/checkoutView","packages/checkout/views/completedView","packages/register/views/registerView","packages/parental-consent/views/consentView","packages/login/views/loginView","packages/verify-email/views/verifyView","packages/order/views/orderStatusView","packages/checkout/views/alreadyOwnedView","packages/checkout/views/needToMigrateView","packages/checkout/views/orderCanceledView","packages/redeem/views/redeemedView"],function(e,t,n){"use strict";var i=e("jquery"),r=e("core/router"),s=e("app-config"),o=e("core/user/models/userModel"),a=e("components/loader/views/loaderView"),l=e("packages/checkout/views/checkoutView"),c=e("packages/checkout/views/completedView"),u=e("packages/register/views/registerView"),d=e("packages/parental-consent/views/consentView"),h=e("packages/login/views/loginView"),p=e("packages/verify-email/views/verifyView"),f=e("packages/order/views/orderStatusView"),m=e("packages/checkout/views/alreadyOwnedView"),g=e("packages/checkout/views/needToMigrateView"),v=e("packages/checkout/views/orderCanceledView"),y=e("packages/redeem/views/redeemedView");n.exports=r.extend({routes:{"buy(/)":"showBuyLayout","register(/)":"showRegisterLayout","consent(/)":"showParentalConsentLayout","download(/)(:orderId)":"showDownloadLayout","verify(/)(:email)(/)(:token)":"showVerifyLayout","owned(/)":"showAlreadyOwnedLayout","migrate(/)":"showNeedToMigrateLayout","order/status/:orderId":"orderStatus","order/canceled/:orderId":"showCanceledOrderLayout","order/adyen/:orderId/verify":"showAdyenOrderLayout","redeemed(/)":"showRedeemedLayout"},_order:void 0,initialize:function(e){r.prototype.initialize.apply(this,arguments),this._updateOrderFlowProgressSteps()},_getController:function(e){return this.controllers?this.controllers[e]:null},_updateOrderFlowProgressSteps:function(){this._getController("orderFlowController").updateProgressBar()},_getUserEmail:function(){return o.getInstance().getEmail()},_isUserRegistered:function(){return this._isUserAuthenticated&&o.getInstance().isRegistered()},_isUserEmailVerified:function(){return o.getInstance().isEmailVerified()},_isUserLegacy:function(){return o.getInstance().isLegacyUser()},_doesUserNeedParentalConsent:function(){return o.getInstance().doesNeedParentalConsent()},_preloadBraintreeDeps:function(){this._loadBraintreeDeps()},_loadBraintreeDeps:function(){var t=i.Deferred();return e(["braintree"],function(){t.resolve()}),t},_fetchOrder:function(e){var t,n=this._getController("orderController");return e?(t=n.createOrder(),t.set("id",e),t.fetchOrder().then(function(){return t},function(){return t})):i.when(n.getOrder())},showBuyLayout:function(){var e,t,n,r,s,c,u=this;return c=new a,this.setView(c),this._isUserRegistered()?this._isUserLegacy()?void this.navigate("migrate",{trigger:!0}):this._isUserEmailVerified()?this._doesUserNeedParentalConsent()?void this.navigate("consent",{trigger:!0}):void i.when(o.getInstance().loadProfiles(),this._loadBraintreeDeps()).done(function(){if(o.getInstance().get("profiles").size()>0)return void u.navigate("owned",{trigger:!0});n=u._getController("orderController"),s=n.getOrder(),s.id&&(n.removeOrder(),s=n.getOrder()),e=l.createView(s),t=u._getController("checkoutController"),t.view=e,t.orderController=n,t.user=o.getInstance(),t.checkExistingOrders(),e.setCheckoutController(t),r=u._getController("redeemController"),r.view=e,e.setRedeemController(r),u.setView(e)}):void this.navigate("verify",{trigger:!0}):void this.navigate("register",{trigger:!0})},defaultAction:function(){return this.transactionId?void this.navigate("order/status/"+this.transactionId,{trigger:!0}):this.adyenData.merchantReference?void this.navigate("order/status/"+this.adyenData.merchantReference,{trigger:!0}):void this.showRegisterLayout()},showRegisterLayout:function(){var e,t;if(this._isUserRegistered())return t=this._getUserEmail(),void this.navigate("verify/"+encodeURIComponent(t),{trigger:!0});e=new u,this.setView(e),this._preloadBraintreeDeps()},showParentalConsentLayout:function(){var e;return this._isUserRegistered()?this._isUserLegacy()?void this.navigate("migrate",{trigger:!0}):this._doesUserNeedParentalConsent()?(e=new d({controller:this._getController("parentalConsentController")}),void this.setView(e)):void this.navigate("buy",{trigger:!0}):void this.navigate("register",{trigger:!0})},showAlreadyOwnedLayout:function(){var e,t=this;if(!this._isUserRegistered())return void this.navigate("register",{trigger:!0});o.getInstance().loadProfiles().done(function(){if(0===o.getInstance().get("profiles").size())return void t.navigate("buy",{trigger:!0});e=new m({countryCode:o.getInstance().get("countryCode")}),t.setView(e)})},showNeedToMigrateLayout:function(){var e;return this._isUserRegistered()?this._isUserLegacy()?(e=new g,void this.setView(e)):void this.navigate("buy",{trigger:!0}):void this.navigate("register",{trigger:!0})},showDownloadLayout:function(e){if(!this._isUserRegistered())return void this.navigate("register",{trigger:!0});this._fetchOrder(e).always(function(t){if("SUCCEEDED"===t.get("status"))return void this.setView(new c({model:t}));e?this.navigate("order/status/"+e,{trigger:!0}):window.location=s.downloadUrl}.bind(this))},showLoginLayout:function(e){if(this._isUserAuthenticated())return void this._navigateToNext(s.defaultPostLoginUrl,e);var t=new h({next:e});this.setView(t)},showVerifyLayout:function(e,t){var n,i,r=this._getController("verifyController"),s=o.getInstance();return this._isUserLegacy()?void this.navigate("migrate",{trigger:!0}):this._isUserEmailVerified()?void this.navigate("buy",{trigger:!0}):(i=e?decodeURIComponent(e):void 0,t=t||void 0,void(i||s.isAuthenticated()?(n=new p({email:i,token:t,sent:r.emailSent}),r._view=n,this.setView(n)):this.navigate("login",{trigger:!0})))},orderStatus:function(e){var t,n,i=this._getController("orderController");if(!this._isUserAuthenticated())return void this.showLoginLayout();t=this.adyenData.merchantReference?i.createAdyenOrder(this.adyenData):i.createOrder(),n=new f({model:t}),this.setView(n),i.processPaymentTransaction(e,t)},showCanceledOrderLayout:function(e){var t;if(!this._isUserRegistered())return void this.navigate("register",{trigger:!0});t=new v({orderId:e}),this.setView(t)},showRedeemedLayout:function(){var e,t=this;if(!this._isUserRegistered())return void this.navigate("register",{trigger:!0});o.getInstance().loadProfiles().done(function(){if(0===o.getInstance().get("profiles").size())return void t.navigate("buy",{trigger:!0});e=new y,t.setView(e)})}})}),define("packages/order-flow/main",["require","exports","module","underscore","backbone","app-config","packages/register/controllers/registerController","packages/verify-email/controllers/verifyController","packages/parental-consent/controllers/consentController","packages/redeem/controllers/redeemController","packages/order-flow/controllers/orderFlowController","packages/order/controllers/orderController","packages/checkout/controllers/checkoutController","packages/order-flow/views/layouts/rootLayoutView","packages/order-flow/routers/router","packages/login/routers/router"],function(e,t,n){"use strict";var i=e("underscore"),r=e("backbone"),s=e("app-config"),o=e("packages/register/controllers/registerController"),a=e("packages/verify-email/controllers/verifyController"),l=e("packages/parental-consent/controllers/consentController"),c=e("packages/redeem/controllers/redeemController"),u=e("packages/order-flow/controllers/orderFlowController"),d=e("packages/order/controllers/orderController"),h=e("packages/checkout/controllers/checkoutController"),p=e("packages/order-flow/views/layouts/rootLayoutView"),f=e("packages/order-flow/routers/router"),m=e("packages/login/routers/router"),g={};g.start=function(e,t){var n=p.getInstance(e),g=t.controllers.userController,v=t.user,y={userController:g,registerController:new o({user:v}),verifyController:new a,parentalConsentController:new l({user:v}),orderFlowController:new u({user:v}),checkoutController:new h({user:v}),orderController:new d({user:v}),redeemController:new c({user:v})};new f({controllers:y,transactionId:t.transactionId,adyenData:t.adyenData,enableDefaultRoute:!0,rootView:n}),new m({enableDefaultRoute:!1,rootView:n}),r.history.loadUrl(),s&&i.isFunction(s.events)&&s.events({name:"orderflow:start",$el:n.$el})},n.exports=g}),define("packages/redeem/controllers/redeemVerifyController",["require","exports","module","core/user/models/userModel","packages/verify-email/controllers/verifyController"],function(e,t,n){"use strict";var i=e("core/user/models/userModel"),r=e("packages/verify-email/controllers/verifyController"),s=r.extend({_navigateAfterSuccess:function(){var e=i.getInstance().isRegistered()?"redeem":"login/redeem";Backbone.history.navigate(e,{trigger:!0})}});n.exports=s}),define("packages/redeem/controllers/redeemFlowController",["require","exports","module","underscore","appPubSubTopics","core/controller","core/collection","i18n"],function(e,t,n){"use strict";var i=e("underscore"),r=e("appPubSubTopics"),s=e("core/controller"),o=e("core/collection"),a=e("i18n"),l=s.extend({_progressSteps:new o([{id:"Register",name:a.gettext("Register")},{id:"VerifyEmail",name:a.gettext("Verify email")},{id:"Redeem",name:a.gettext("Redeem")},{id:"Download",name:a.gettext("Download")},{id:"LogIn",name:a.gettext("Log in")}]),initialize:function(e){var t=this;this._user=e.user,this._registerRedeemFlowProgressSteps(["Register","VerifyEmail","Redeem","Download"]),this.pubSub.subscribe(r.USER_ATTRIBUTES_CHANGED,function(e,n){t.updateProgressBar(n)})},_addProgressStep:function(e,t,n){this.pubSub.publish(r.PROGRESS_REGISTER,{id:e,name:t,sortOrder:n})},_registerRedeemFlowProgressSteps:function(e){var t,n=this;i.each(e,function(e,i){t=n._progressSteps.get(e),n._addProgressStep(t.get("id"),t.get("name"),i+1)})},updateProgressBar:function(){var e=this._user;i.isEmpty(e.get("id"))||this.pubSub.publish(r.PROGRESS_UPDATE,{id:"Register",resolved:!0}),e.isEmailVerified()&&this.pubSub.publish(r.PROGRESS_UPDATE,{id:"VerifyEmail",resolved:!0})}});n.exports=l}),define("packages/redeem/views/layouts/rootLayoutView",["require","exports","module","core/root-layout-view"],function(e,t,n){"use strict";var i,r=e("core/root-layout-view"),s=r.extend({});s.getInstance=function(e){return i||(i=new s,i.onLoad(e),i.appendTo(e||document.body)),i},n.exports=s}),define("hbs!packages/redeem/templates/redeem",["handlebars"],function(e){return e.template({1:function(e,t,n,i){return"Redeem %1$s"},3:function(e,t,n,i){var r,s=t.helperMissing,o='      <p class="help-block">';return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.eulaLink:e,null!=e?e.productName:e,{name:"gettext_block",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"</p>\n"},4:function(e,t,n,i){return'By submitting this form you accept the <a href="%1$s" target="_blank">%2$s End User License Agreement</a>.'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a="<h1>";return r=(t.gettext_block||e&&e.gettext_block||s).call(e,null!=e?e.productName:e,{name:"gettext_block",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+='</h1>\n<form class="view-redeem__redeem-form" id="redeem-form" action="" method="post" autocomplete="off">\n\n  '+o((t.view||e&&e.view||s).call(e,null!=e?e.redeemCodeView:e,{name:"view",hash:{},data:i}))+"\n  "+o((t.view||e&&e.view||s).call(e,null!=e?e.profileView:e,{name:"view",hash:{},data:i}))+'\n\n  <div class="form-gutter">\n    <div class="form-group">\n      '+o((t.view||e&&e.view||s).call(e,null!=e?e.submitButton:e,{name:"view",hash:{},data:i}))+"\n    </div>\n",r=t.if.call(e,null!=e?e.includeEula:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+"  </div>\n</form>\n\n"},useData:!0})}),define("hbs!packages/redeem/templates/submitButton",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r=t.helperMissing;return(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Redeem",{name:"gettext",hash:{},data:i}))+"\n"},useData:!0})}),define("packages/redeem/views/redeemView",["require","exports","module","app-config","i18n","core/view","core/dialogs/loader-dialog","components/submit-button/views/submitButtonView","packages/checkout/views/profileView","packages/checkout/views/paymentMethods/redeemGiftView","packages/checkout/models/profileModel","packages/redeem/models/redeemGiftModel","hbs!packages/redeem/templates/redeem","hbs!packages/redeem/templates/submitButton"],function(e,t,n){"use strict";var i=e("app-config"),r=e("i18n"),s=e("core/view"),o=e("core/dialogs/loader-dialog"),a=e("components/submit-button/views/submitButtonView"),l=e("packages/checkout/views/profileView"),c=e("packages/checkout/views/paymentMethods/redeemGiftView"),u=e("packages/checkout/models/profileModel"),d=e("packages/redeem/models/redeemGiftModel"),h=e("hbs!packages/redeem/templates/redeem"),p=e("hbs!packages/redeem/templates/submitButton"),f=s.extend({template:h,_redeemController:null,initialize:function(e){this.submitButton=new a({className:"btn btn-block btn-primary btn-lg",loadingText:r.gettext("Verifying code..."),template:p}),this.eulaLink=i.registerForm.eulaLink,this.productName=i.productName,this.includeEula=!(!this.eulaLink||!this.productName),this.profileModel=new u({}),this.profileView=new l({validationModel:this.profileModel}),this.redeemGiftModel=new d,this.redeemCodeView=new c({model:this.redeemGiftModel,checkout:!1}),this.analytics.pageView("/redeem")},events:{redeem_success:"_onRedeemSuccess",redeem_error:"_onRedeemError","submit form":"_onFormSubmit"},setRedeemController:function(e){this._redeemController=e},_createRedeemingCodeDialog:function(){return this.loaderDialog=new o({message:r.gettext("Verifying code...")}),this.loaderDialog},_onFormSubmit:function(e){this.serialize(e,function(t,n){var i,r,s,o;if(e.preventDefault(),o=this._createRedeemingCodeDialog(),i=this,r=this.profileModel,s=this.redeemGiftModel,r.validate(),s.validate(),!r.isValid()||!s.isValid())return void this._releaseForm(n);o.start(),this.submitButton.setLoading(),r.reserveName().done(function(){i._redeemController.redeemGift(s)}).fail(function(){i._releaseForm(n)}),n()})},_releaseForm:function(e){e&&e(),this._sendValidationAnalytics("Profile name",this.profileModel),this._sendValidationAnalytics("Redeem gift",this.redeemGiftModel),this.submitButton.reset(),this.loaderDialog&&this.loaderDialog.stop()},_onRedeemError:function(e){this.submitButton.reset(),this.loaderDialog.stop(),this.publishError(e.errorTitle,e.errorMessage,e.response)},_onRedeemSuccess:function(){this.loaderDialog.stop()}});n.exports=f}),define("packages/redeem/routers/router",["require","exports","module","jquery","core/router","app-config","core/user/models/userModel","components/loader/views/loaderView","packages/register/views/registerView","packages/login/views/loginView","packages/verify-email/views/verifyView","packages/checkout/views/alreadyOwnedView","packages/checkout/views/needToMigrateView","packages/redeem/views/redeemView","packages/redeem/views/redeemedView"],function(e,t,n){"use strict";var i=e("jquery"),r=e("core/router"),s=e("app-config"),o=e("core/user/models/userModel"),a=e("components/loader/views/loaderView"),l=e("packages/register/views/registerView"),c=e("packages/login/views/loginView"),u=e("packages/verify-email/views/verifyView"),d=e("packages/checkout/views/alreadyOwnedView"),h=e("packages/checkout/views/needToMigrateView"),p=e("packages/redeem/views/redeemView"),f=e("packages/redeem/views/redeemedView");n.exports=r.extend({routes:{"redeem(/)":"showRedeemLayout","register(/)":"showRegisterLayout","verify(/)(:email)(/)(:token)":"showVerifyLayout","owned(/)":"showAlreadyOwnedLayout","migrate(/)":"showNeedToMigrateLayout","redeemed(/)":"showRedeemedLayout"},_order:void 0,initialize:function(e){r.prototype.initialize.apply(this,arguments),this._updateRedeemFlowProgressSteps()},_getController:function(e){return this.controllers?this.controllers[e]:null},_updateRedeemFlowProgressSteps:function(){this._getController("redeemFlowController").updateProgressBar()},_getUserEmail:function(){return o.getInstance().getEmail()},_isUserRegistered:function(){return this._isUserAuthenticated&&o.getInstance().isRegistered()},_isUserEmailVerified:function(){return o.getInstance().isEmailVerified()},_isUserLegacy:function(){return o.getInstance().isLegacyUser()},showRedeemLayout:function(){var e,t,n,r=this;return n=new a,this.setView(n),this._isUserRegistered()?this._isUserLegacy()?void this.navigate("migrate",{trigger:!0}):this._isUserEmailVerified()?void i.when(o.getInstance().loadProfiles()).done(function(){if(o.getInstance().get("profiles").size()>0)return void r.navigate("owned",{trigger:!0});t=r._getController("redeemController"),e=new p,t.view=e,e.setRedeemController(t),r.setView(e)}):void this.navigate("verify",{trigger:!0}):void this.navigate("register",{trigger:!0})},defaultAction:function(){this.showRegisterLayout()},showRegisterLayout:function(){var e,t;if(this._isUserRegistered())return t=this._getUserEmail(),void this.navigate("verify/"+encodeURIComponent(t),{trigger:!0});e=new l({redeem:!0}),this.setView(e)},showAlreadyOwnedLayout:function(){var e,t=this;if(!this._isUserRegistered())return void this.navigate("register",{trigger:!0});o.getInstance().loadProfiles().done(function(){if(0===o.getInstance().get("profiles").size())return void t.navigate("redeem",{trigger:!0});e=new d({countryCode:o.getInstance().get("countryCode")}),t.setView(e)})},showNeedToMigrateLayout:function(){var e;return this._isUserRegistered()?this._isUserLegacy()?(e=new h,void this.setView(e)):void this.navigate("redeem",{trigger:!0}):void this.navigate("register",{trigger:!0})},showLoginLayout:function(e){if(this._isUserAuthenticated())return void this._navigateToNext(s.defaultPostLoginUrl,e);var t=new c({next:e});this.setView(t)},showVerifyLayout:function(e,t){var n,i,r=this._getController("verifyController"),s=o.getInstance()
;return this._isUserLegacy()?void this.navigate("migrate",{trigger:!0}):this._isUserEmailVerified()?void this.navigate("redeem",{trigger:!0}):(i=e?decodeURIComponent(e):void 0,t=t||void 0,void(i||s.isAuthenticated()?(n=new u({email:i,token:t,sent:r.emailSent}),r._view=n,this.setView(n)):this.navigate("login",{trigger:!0})))},showRedeemedLayout:function(){var e,t=this;if(!this._isUserRegistered())return void this.navigate("register",{trigger:!0});o.getInstance().loadProfiles().done(function(){if(0===o.getInstance().get("profiles").size())return void t.navigate("redeem",{trigger:!0});e=new f,t.setView(e)})}})}),define("packages/redeem/main",["require","exports","module","underscore","backbone","app-config","packages/register/controllers/registerController","packages/redeem/controllers/redeemVerifyController","packages/redeem/controllers/redeemController","packages/redeem/controllers/redeemFlowController","packages/redeem/views/layouts/rootLayoutView","packages/redeem/routers/router","packages/login/routers/router"],function(e,t,n){"use strict";var i=e("underscore"),r=e("backbone"),s=e("app-config"),o=e("packages/register/controllers/registerController"),a=e("packages/redeem/controllers/redeemVerifyController"),l=e("packages/redeem/controllers/redeemController"),c=e("packages/redeem/controllers/redeemFlowController"),u=e("packages/redeem/views/layouts/rootLayoutView"),d=e("packages/redeem/routers/router"),h=e("packages/login/routers/router"),p={};p.start=function(e,t){var n=u.getInstance(e),p=t.controllers.userController,f=t.user,m={userController:p,registerController:new o({user:f}),verifyController:new a,redeemController:new l({user:f}),redeemFlowController:new c({user:f})};new d({controllers:m,enableDefaultRoute:!0,rootView:n}),new h({enableDefaultRoute:!1,rootView:n}),r.history.loadUrl(),s&&i.isFunction(s.events)&&s.events({name:"redeem:start",$el:n.$el})},n.exports=p}),define("packages/profile/views/layouts/rootLayoutView",["require","exports","module","core/root-layout-view"],function(e,t,n){"use strict";var i,r=e("core/root-layout-view"),s=r.extend({});s.getInstance=function(e){return i||(i=new s,i.appendTo(e||document.body)),i},n.exports=s}),define("hbs!packages/profile/templates/index",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l='  <div class="nav-item dropdown">\n    <a class="nav-link dropdown-toggle inverted" \n        href="javascript:;"\n        id="profiledd1"\n        data-toggle="dropdown"\n        aria-haspopup="true"\n        aria-expanded="true"\n      >\n        '+a((s=null!=(s=t.displayName||(null!=e?e.displayName:e))?s:o,"function"==typeof s?s.call(e,{name:"displayName",hash:{},data:i}):s))+'\n    </a>\n    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="profiledd1">\n';return r=t.unless.call(e,null!=e?e.emailVerified:e,{name:"unless",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+="\n",r=t.if.call(e,null!=e?e.profileUrl:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+="\n",r=t.if.call(e,null!=e?e.redeemUrl:e,{name:"if",hash:{},fn:this.program(6,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+="\n",r=t.if.call(e,null!=e?e.orderHistoryUrl:e,{name:"if",hash:{},fn:this.program(8,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+'\n      <a class="dropdown-item profile-widget__logout-link" href="'+a((s=null!=(s=t.logoutUrl||(null!=e?e.logoutUrl:e))?s:o,"function"==typeof s?s.call(e,{name:"logoutUrl",hash:{},data:i}):s))+'">'+a((t.gettext||e&&e.gettext||o).call(e,"Log out",{name:"gettext",hash:{},data:i}))+"</a>\n    </div>\n  </div>\n"},2:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return'        <a class="dropdown-item profile-widget__profile-link" href="'+o((r=null!=(r=t.verifyUrl||(null!=e?e.verifyUrl:e))?r:s,"function"==typeof r?r.call(e,{name:"verifyUrl",hash:{},data:i}):r))+"/"+o((t.encodeuri||e&&e.encodeuri||s).call(e,null!=e?e.email:e,{name:"encodeuri",hash:{},data:i}))+'">'+o((t.gettext||e&&e.gettext||s).call(e,"Verify this account",{name:"gettext",hash:{},data:i}))+"</a>\n"},4:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return'        <a class="dropdown-item profile-widget__profile-link" href="'+o((r=null!=(r=t.profileUrl||(null!=e?e.profileUrl:e))?r:s,"function"==typeof r?r.call(e,{name:"profileUrl",hash:{},data:i}):r))+'">'+o((t.gettext||e&&e.gettext||s).call(e,"Profile",{name:"gettext",hash:{},data:i}))+"</a>\n"},6:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return'        <a class="dropdown-item profile-widget__redeem-link" href="'+o((r=null!=(r=t.redeemUrl||(null!=e?e.redeemUrl:e))?r:s,"function"==typeof r?r.call(e,{name:"redeemUrl",hash:{},data:i}):r))+'">'+o((t.gettext||e&&e.gettext||s).call(e,"Redeem code",{name:"gettext",hash:{},data:i}))+"</a>\n"},8:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return'        <a class="dropdown-item profile-widget__redeem-link" href="'+o((r=null!=(r=t.orderHistoryUrl||(null!=e?e.orderHistoryUrl:e))?r:s,"function"==typeof r?r.call(e,{name:"orderHistoryUrl",hash:{},data:i}):r))+'">'+o((t.gettext||e&&e.gettext||s).call(e,"Order history",{name:"gettext",hash:{},data:i}))+"</a>\n"},10:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return'  <div class="nav-item">\n      <a class="profile-widget__login-link nav-link inverted" href="'+o((r=null!=(r=t.loginUrl||(null!=e?e.loginUrl:e))?r:s,"function"==typeof r?r.call(e,{name:"loginUrl",hash:{},data:i}):r))+'">'+o((t.gettext||e&&e.gettext||s).call(e,"Log in",{name:"gettext",hash:{},data:i}))+"</a>\n  </div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s="";return r=t.if.call(e,null!=e?e.username:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(10,i),data:i}),null!=r&&(s+=r),s+"\n"},useData:!0})}),define("packages/profile/views/profileView",["require","exports","module","app-config","core/view","hbs!packages/profile/templates/index"],function(e,t,n){"use strict";var i=e("app-config"),r=e("core/view"),s=e("hbs!packages/profile/templates/index"),o=r.extend({template:s,className:"profile-widget",initialize:function(e){this.loginUrl=i.loginUrl||"#login",this.verifyUrl=i.verifyUrl||"#verify",this.logoutUrl=i.logoutUrl||"#logout",this.profileUrl=i.profileUrl||"",this.redeemUrl=i.redeemUrl||"",this.orderHistoryUrl=i.orderHistoryUrl?i.orderHistoryUrl:null}});n.exports=o}),define("packages/profile/main",["require","exports","module","packages/profile/views/layouts/rootLayoutView","packages/profile/views/profileView"],function(e,t,n){"use strict";var i=e("packages/profile/views/layouts/rootLayoutView"),r=e("packages/profile/views/profileView"),s={};s.start=function(e,t){var n=i.getInstance(e),s=t.user,o=new r({model:s});n.setView(o)},n.exports=s}),define("packages/order-history/views/layouts/rootLayoutView",["require","exports","module","core/root-layout-view"],function(e,t,n){"use strict";var i,r=e("core/root-layout-view"),s=r.extend({});s.getInstance=function(e){return i||(i=new s,i.onLoad(e),i.appendTo(e||document.body)),i},n.exports=s}),define("hbs!packages/order-history/templates/item-view",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r=t.helperMissing;return(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"Details",{name:"gettext",hash:{},data:i}))},3:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return'    <div class="row">\n      <div class="col-md-6 order-item">\n        <div class="field">\n          <div class="field__body order-item__variant-name">'+o((r=null!=(r=t.variantName||(null!=e?e.variantName:e))?r:s,"function"==typeof r?r.call(e,{name:"variantName",hash:{},data:i}):r))+'</div>\n        </div>\n        <div class="field">\n          <div class="field__body order-item__amount">'+o((r=null!=(r=t.amount||(null!=e?e.amount:e))?r:s,"function"==typeof r?r.call(e,{name:"amount",hash:{},data:i}):r))+"</div>\n        </div>\n      </div>\n    </div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l='<div class="row">\n  <div class="col-md-12">\n    <h2>'+a((s=null!=(s=t.createdAt||(null!=e?e.createdAt:e))?s:o,"function"==typeof s?s.call(e,{name:"createdAt",hash:{},data:i}):s))+'</h2>\n  </div>\n</div>\n\n<div class="row">\n  <div class="col-md-6">\n    <div class="field">\n      <div class="field__caption small">'+a((t.gettext||e&&e.gettext||o).call(e,"Order reference",{name:"gettext",hash:{},data:i}))+'</div>\n      <div class="field__body order__id">'+a((t.ellipsis||e&&e.ellipsis||o).call(e,null!=e?e.id:e,18,"...",{name:"ellipsis",hash:{},data:i}))+'</div>\n    </div>\n  </div>\n  <div class="col-md-3 text-right">\n    <div class="field">\n      <div class="field__caption small">'+a((t.gettext||e&&e.gettext||o).call(e,"Total",{name:"gettext",hash:{},data:i}))+'</div>\n      <div class="field__body order__amount">'+a((s=null!=(s=t.amount||(null!=e?e.amount:e))?s:o,"function"==typeof s?s.call(e,{name:"amount",hash:{},data:i}):s))+'</div>\n      <div class="field__body order__details-link">';return r=(t.link||e&&e.link||o).call(e,"order/{{id}}",{name:"link",hash:{"expand-tokens":!0},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+='</div>\n    </div>\n  </div>\n  <div class="col-md-3">\n    <div class="field">\n      <div class="field__caption small">'+a((t.gettext||e&&e.gettext||o).call(e,"Payment provider",{name:"gettext",hash:{},data:i}))+'</div>\n      <div class="field__body order__payment-provider">'+a((s=null!=(s=t.paymentProvider||(null!=e?e.paymentProvider:e))?s:o,"function"==typeof s?s.call(e,{name:"paymentProvider",hash:{},data:i}):s))+'</div>\n    </div>\n  </div>\n</div>\n\n<div class="row">\n',r=(t.collection||e&&e.collection||o).call(e,{name:"collection",hash:{tag:"div",className:"col-md-12"},fn:this.program(3,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+"</div>\n\n"},useData:!0})}),define("packages/order-history/views/orderHistoryItemView",["require","exports","module","core/view","hbs!packages/order-history/templates/item-view"],function(e,t,n){"use strict";var i=e("core/view"),r=e("hbs!packages/order-history/templates/item-view"),s=i.extend({template:r,className:"order-history-item-view",initialize:function(e){this.model&&this.model.get("items")&&this.setCollection(this.model.get("items"))}});n.exports=s}),define("hbs!packages/order-history/templates/index",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r=t.helperMissing;return'  <div class="alert alert-danger" role="alert">'+(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"You don't have any orders",{name:"gettext",hash:{},data:i}))+"</div>\n"},3:function(e,t,n,i){var r=t.helperMissing;return"  "+(0,this.escapeExpression)((t.collection||e&&e.collection||r).call(e,{name:"collection",hash:{"item-view":null!=e?e.orderItemView:e,className:""},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a="<h1>"+o((t.gettext||e&&e.gettext||s).call(e,"Order history",{name:"gettext",hash:{},data:i}))+"</h1>\n\n";return r=(t.empty||e&&e.empty||s).call(e,null!=e?e.collection:e,{name:"empty",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=r&&(a+=r),a},useData:!0})}),define("packages/order-history/views/orderHistoryView",["require","exports","module","app-config","core/view","packages/order-history/views/orderHistoryItemView","hbs!packages/order-history/templates/index"],function(e,t,n){"use strict";var i=(e("app-config"),e("core/view")),r=e("packages/order-history/views/orderHistoryItemView"),s=e("hbs!packages/order-history/templates/index"),o=i.extend({template:s,className:"order-history-view",orderItemView:r,initialize:function(e){}});n.exports=o}),define("hbs!packages/order-history/templates/item-details-view",["handlebars"],function(e){return e.template({1:function(e,t,n,i){return"\n"},3:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l='\n  <div class="row">\n    <div class="col-md-6">\n      <div class="field">\n        <div class="field__body">'+a((t.gettext||e&&e.gettext||o).call(e,"Order reference:",{name:"gettext",hash:{},data:i}))+" "+a((s=null!=(s=t.id||(null!=e?e.id:e))?s:o,"function"==typeof s?s.call(e,{name:"id",hash:{},data:i}):s))+'</div>\n      </div>\n      <div class="field">\n        <div class="field__body">'+a((s=null!=(s=t.createdAt||(null!=e?e.createdAt:e))?s:o,"function"==typeof s?s.call(e,{name:"createdAt",hash:{},data:i}):s))+'</div>\n      </div>\n      <div class="field">\n        <div class="field__body">'+a((s=null!=(s=t.status||(null!=e?e.status:e))?s:o,"function"==typeof s?s.call(e,{name:"status",hash:{},data:i}):s))+'</div>\n      </div>\n    </div>\n    <div class="col-md-6">\n';return r=t.if.call(e,null!=e?e.showBrazilEnfLink:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+='    </div>\n  </div>\n\n  <div class="row">\n    <div>\n      <hr>\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-md-12">\n',r=(t.collection||e&&e.collection||o).call(e,{name:"collection",hash:{tag:"div",className:"row"},fn:this.program(10,i),inverse:this.noop,data:i}),null!=r&&(l+=r),l+'      <hr>\n    </div>\n\n  </div>\n\n  <div class="row justify-content-end">\n    <div class="col-12 text-right">\n      <div class="field">\n        <div class="field__caption small">'+a((t.gettext||e&&e.gettext||o).call(e,"Total",{name:"gettext",hash:{},data:i}))+'</div>\n        <div class="field__body order--amount">'+a((s=null!=(s=t.amount||(null!=e?e.amount:e))?s:o,"function"==typeof s?s.call(e,{name:"amount",hash:{},data:i}):s))+"</div>\n      </div>\n    </div>\n  </div>\n\n\n"},4:function(e,t,n,i){var r,s='        <div class="field">\n          <div class="field__body">\n';return r=t.if.call(e,null!=(r=null!=e?e.brazilEnfLink:e)?r.value:r,{name:"if",hash:{},fn:this.program(5,i),inverse:this.program(7,i),data:i}),null!=r&&(s+=r),s+"          </div>\n        </div>\n"},5:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a=this.lambda;return'            <a href="'+o((t.decodeuri||e&&e.decodeuri||s).call(e,null!=(r=null!=e?e.brazilEnfLink:e)?r.value:r,{name:"decodeuri",hash:{},data:i}))+'" target="_blank">'+o(a(null!=(r=null!=e?e.brazilEnfLink:e)?r.label:r,e))+"</a>\n"},7:function(e,t,n,i){var r,s=t.helperMissing,o="            ";return r=(t.button||e&&e.button||s).call(e,"handleMissingBrazilEnfLink",{name:"button",hash:{tag:"a"},fn:this.program(8,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o+"\n"},8:function(e,t,n,i){var r,s=this.lambda;return(0,this.escapeExpression)(s(null!=(r=null!=e?e.brazilEnfLink:e)?r.label:r,e))},10:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression;return'        <div class="col-md-6">\n          <div class="field">\n            <div class="field__body">'+o((r=null!=(r=t.variantName||(null!=e?e.variantName:e))?r:s,"function"==typeof r?r.call(e,{name:"variantName",hash:{},data:i}):r))+'</div>\n          </div>\n        </div>\n        <div class="col-md-6 text-right">\n          <div class="field">\n            <div class="field__body order-item--amount">'+o((r=null!=(r=t.amount||(null!=e?e.amount:e))?r:s,"function"==typeof r?r.call(e,{name:"amount",hash:{},data:i}):r))+"</div>\n          </div>\n        </div>\n"},12:function(e,t,n,i){var r=t.helperMissing;return(0,this.escapeExpression)((t.gettext||e&&e.gettext||r).call(e,"View orders",{name:"gettext",hash:{},data:i}))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o=this.escapeExpression,a="<h1>"+o((t.gettext||e&&e.gettext||s).call(e,"Order details",{name:"gettext",hash:{},data:i}))+"</h1>\n\n"+o((t.view||e&&e.view||s).call(e,null!=e?e.loadingView:e,{name:"view",hash:{},data:i}))+"\n\n";return r=(t.empty||e&&e.empty||s).call(e,null!=e?e.model:e,{name:"empty",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=r&&(a+=r),a+='\n<div class="row">\n  <div>\n    <hr>\n  </div>\n  <div class="col-md-12">\n    <p>',r=(t.link||e&&e.link||s).call(e,"/",{name:"link",hash:{},fn:this.program(12,i),inverse:this.noop,data:i}),null!=r&&(a+=r),a+"</p>\n  </div>\n</div>\n"},useData:!0})}),define("packages/order-history/views/orderHistoryDetailsView",["require","exports","module","underscore","i18n","core/view","core/xhr-errors","components/loader/views/loaderView","hbs!packages/order-history/templates/item-details-view"],function(e,t,n){"use strict";var i=e("underscore"),r=(e("i18n"),e("core/view")),s=e("core/xhr-errors"),o=e("components/loader/views/loaderView"),a=e("hbs!packages/order-history/templates/item-details-view"),l=r.extend(i.extend({},s,{template:a,loadingView:null,className:"order-history-details-view",initialize:function(e){this.loadingView=new o,this.model.on("error",function(e,t){this.publishError(this._getErrorTitle(t),this._getErrorMessage(t),t)},this),this.model.on("change",function(e){this.loadingView.stopLoader(),this.setCollection(e.get("items"))},this)},showBrazilEnfLink:function(){return!!this.model.get("brazilEnfLink")&&this.model.get("status")===l.STATUS_SUCCEEDED},handleMissingBrazilEnfLink:function(){this.publishError("Missing NF-e link","Your NF-e is not yet available. Check back soon.")}}));l.STATUS_SUCCEEDED="SUCCEEDED",n.exports=l}),define("packages/order-history/models/orderModel",["require","exports","module","underscore","env","core/model","core/order-mixins"],function(e,t,n){"use strict";var i=e("underscore"),r=e("env"),s=e("core/model"),o=e("core/order-mixins"),a=s.extend(i.extend({defaults:{},initialize:function(e){this._setUrl()},_setUrl:function(){this.url=r.getEndpoint("getOrder",{id:this.get("id")})}},o));n.exports=a}),define("packages/order-history/models/orderViewModel",["require","exports","module","underscore","i18n","core/user/models/userModel","core/model","core/collection","packages/order-history/models/orderModel","core/order-mixins","env","moment"],function(e,t,n){"use strict";var i=e("underscore"),r=e("i18n"),s=e("core/user/models/userModel"),o=e("core/model"),a=e("core/collection"),l=e("packages/order-history/models/orderModel"),c=e("core/order-mixins"),u=e("env"),d=e("moment"),h=o.extend(i.extend({initialize:function(){},fetchOrderById:function(e){return this.set("id",e,{silent:!0}),this.url=u.getEndpoint("getOrder",{id:e}),this.fetch({beforeSend:i.bind(this._setAuthentication,this)})},_formatOrderProperties:function(e){var t={brazilEnf:"NF-e",brazilZipCode:r.gettext("Zip code"),brazilFirstName:r.gettext("Firstname"),brazilLastname:r.gettext("Lastname"),brazilEnfAuthCode:"NF-e auth code",brazilEnfLink:r.gettext("Tax Invoice")},n={};return i.each(e,function(e){e.name in t&&(n[e.name]={label:t[e.name],value:e.value})}),n},_formatOrderItems:function(e,t,n){var r={minecraft:"Minecraft","parental-consent":"Parental consent"},s=[];return i.each(e,function(e){e.amount=this._formatLocaleCurrency(e.amount,n),e.variantName=r[e.variantId]?r[e.variantId]:e.variantId,s.push(e)},this),s},_formatLocaleCurrency:function(e,t){var n=s.getInstance().getLocale();return e.toLocaleString(n,{style:"currency",currency:t})},parse:function(e){var t=new l(e),n=new a(this._formatOrderItems(t.get("items"),s.getInstance().getLocale(),t.get("currency").currencyCode)),r=this._formatOrderProperties(t.get("properties"));this.set(i.extend({id:t.get("id"),createdAt:d(t.get("createdAt")).format("LL"),status:t.get("status"),paymentMethod:t.getPaymentMethod(),paymentProvider:t.getPaymentProvider(),amount:this._formatLocaleCurrency(t.get("amount"),t.get("currency").currencyCode),items:n},r))}},c));n.exports=h}),define("packages/order-history/collections/ordersCollection",["require","exports","module","underscore","core/collection","packages/order-history/models/orderViewModel","env"],function(e,t,n){"use strict";var i=e("underscore"),r=e("core/collection"),s=e("packages/order-history/models/orderViewModel"),o=e("env"),a=r.extend({model:s,url:o.getEndpoint("orders"),fetchOrders:function(){var e={variantIds:["minecraft","parental-consent"]};return this.fetch({beforeSend:i.bind(this._setAuthentication,this),type:"post",contentType:"application/json",data:JSON.stringify(e)}),this}});n.exports=a}),define("packages/order-history/routers/router",["require","exports","module","core/router","packages/order-history/views/orderHistoryView","packages/order-history/views/orderHistoryDetailsView","packages/order-history/collections/ordersCollection","packages/order-history/models/orderViewModel"],function(e,t,n){"use strict";var i=e("core/router"),r=e("packages/order-history/views/orderHistoryView"),s=e("packages/order-history/views/orderHistoryDetailsView"),o=e("packages/order-history/collections/ordersCollection"),a=e("packages/order-history/models/orderViewModel");n.exports=i.extend({routes:{"order-history(/)":"showOrderHistory","order(/):id":"showOrderDetails"},initialize:function(e){this._user=e.user,i.prototype.initialize.apply(this,arguments)},_getController:function(e){return this.controllers?this.controllers[e]:null},defaultAction:function(){this.showOrderHistory()},showOrderHistory:function(){if(!this._user.isAuthenticated())return void this.navigate("login",{trigger:!0});var e=(new o).fetchOrders(),t=new r({collection:e});this.setView(t)},showOrderDetails:function(e){if(!this._user.isAuthenticated())return void this.navigate("login",{trigger:!0});var t=new a,n=new s({model:t});this.setView(n),t.fetchOrderById(e)}})}),define("packages/order-history/controllers/orderHistoryController",["require","exports","module","underscore","appPubSubTopics","core/controller","packages/order-history/models/orderViewModel"],function(e,t,n){"use strict";var i=(e("underscore"),e("appPubSubTopics"),e("core/controller")),r=e("packages/order-history/models/orderViewModel"),s=i.extend({_user:null,initialize:function(e){},getViewModel:function(){return new r}});n.exports=s}),define("packages/order-history/main",["require","exports","module","packages/order-history/views/layouts/rootLayoutView","packages/order-history/routers/router","packages/order-history/controllers/orderHistoryController","packages/login/routers/router"],function(e,t,n){"use strict";var i=e("packages/order-history/views/layouts/rootLayoutView"),r=e("packages/order-history/routers/router"),s=(e("packages/order-history/controllers/orderHistoryController"),e("packages/login/routers/router")),o={};o.start=function(e,t){var n=i.getInstance(e),o=t.controllers.userController;new r({controllers:{userController:o},rootView:n,enableDefaultRoute:!0,user:t.user}),new s({enableDefaultRoute:!1,rootView:n}),Backbone.history.loadUrl()},n.exports=o}),define("packages/progress/models/progressModel",["require","exports","module","underscore","core/model","core/collection"],function(e,t,n){"use strict";var i=e("underscore"),r=e("core/model"),s=e("core/collection"),o=r.extend({_items:null,initialize:function(){i.isNull(this._items)&&(this._items=new s,this._items.comparator="sortOrder"),this.set({items:this._items}),this.set("hidden",!1),this._bindEvents()},_bindEvents:function(){this._items.on("change",function(){this.trigger("progress-update")},this)},_getItems:function(){return this.get("items")},_itemsLength:function(){return this._getItems().length},_resolvedItems:function(){return this._getItems().where({resolved:!0})},getProgress:function(){var e,t,n;return t=this._itemsLength(),n=this._resolvedItems().length,e=n/t,i.isNaN(e)?0:e},addProgressStep:function(e,t,n,i){this._getItems().add(new r({id:e,name:t,resolved:n,sortOrder:i})),this.updateNrOfStepsOnAllModels(),this.trigger("change")},removeProgressStep:function(e){this._getItems().remove(new r({id:e})),this.updateNrOfStepsOnAllModels(),this.trigger("change")},updateProgressStep:function(e,t){var n,i;n=this._getItems(),(i=n.get(e))&&i.set({resolved:t})},updateNrOfStepsOnAllModels:function(){var e=this._getItems().models,t=e.length;i.each(e,function(e){e.set("nrOfSteps",t)})}});n.exports=o}),define("hbs!packages/progress/templates/progress-labels",["handlebars"],function(e){return e.template({1:function(e,t,n,i){var r,s,o=t.helperMissing,a=this.escapeExpression,l='    <div class="text-center col-'+a((s=null!=(s=t["col-size"]||(null!=e?e["col-size"]:e))?s:o,"function"==typeof s?s.call(e,{name:"col-size",hash:{},data:i}):s))+' progress-labels__list-item">\n';return r=t.if.call(e,null!=e?e.resolved:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.program(4,i),data:i}),null!=r&&(l+=r),l+"        "+a((s=null!=(s=t.name||(null!=e?e.name:e))?s:o,"function"==typeof s?s.call(e,{name:"name",hash:{},data:i}):s))+"\n    </div>\n"},2:function(e,t,n,i){return'        <svg width="16" height="16" viewBox="0 0 512 512">\n            <path d="M432 64l-240 240-112-112-80 80 192 192 320-320z"></path>\n        </svg>\n'},4:function(e,t,n,i){return'        <svg width="16" height="16" viewBox="0 0 512 512">\n            <path d="M64 64h384v384h-384z"></path>\n        </svg>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var r,s=t.helperMissing,o="";return r=(t.collection||e&&e.collection||s).call(e,{name:"collection",hash:{className:"progress-labels row",tag:"div"},fn:this.program(1,i),inverse:this.noop,data:i}),null!=r&&(o+=r),o},useData:!0})}),define("packages/progress/views/progressLabelsView",["require","exports","module","underscore","handlebars","core/view","hbs!packages/progress/templates/progress-labels","bootstrap-progressbar"],function(e,t,n){"use strict";var i=e("underscore"),r=e("handlebars"),s=e("core/view"),o=e("hbs!packages/progress/templates/progress-labels");e("bootstrap-progressbar");var a,l=s.extend({className:"progress-labels",template:o,initialize:function(e){var t=this.model.get("items");r.registerHelper("col-size",i.bind(this.getColSize,this)),this.setCollection(t)},itemsLen:function(){return this.model.get("items").length},getColSize:function(e){var t=this.model.get("items").length,n=12/t;return Math.floor(n)}});l.getInstance=function(e,t){return a||(a=new l(t),a.appendTo(e||document.body)),a},n.exports=l}),define("hbs!packages/progress/templates/progress-bar",["handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'<div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100">\n</div>\n\n'},useData:!0})}),define("packages/progress/views/progressView",["require","exports","module","core/view","hbs!packages/progress/templates/progress-bar","bootstrap-progressbar"],function(e,t,n){"use strict";var i=e("core/view"),r=e("hbs!packages/progress/templates/progress-bar");e("bootstrap-progressbar");var s,o=i.extend({className:"progress",template:r,progressModel:null,$progressBar:null,initialize:function(e){this.progressModel.on("progress-update",function(){this.updateProgress()},this),this.progressModel.on("change",function(){this.updateProgress()},this)},render:function(){this.$el.html(r)},events:{ready:function(){this.updateProgress()}},updateProgress:function(){var e=Math.ceil(100*this.progressModel.getProgress());this.$progressBar||(this.$progressBar=this.$el.find(".progress-bar")),this.$progressBar.attr("aria-valuetransitiongoal",e),this.$progressBar.css("width",e+"%")}});o.getInstance=function(e,t){return s||(s=new o(t),s.appendTo(e||document.body)),s},n.exports=o}),define("packages/progress/controllers/progressController",["require","exports","module","underscore","appPubSubTopics","core/controller"],function(e,t,n){"use strict";var i=e("underscore"),r=e("appPubSubTopics"),s=e("core/controller"),o=s.extend({register:function(e,t){this.getModel().addProgressStep(t.id,t.name,t.resolved,t.sortOrder)},unregister:function(e,t){this.getModel().removeProgressStep(t.id)},getModel:function(){return this._progressModel},update:function(e,t){this.getModel().updateProgressStep(t.id,t.resolved)},show:function(){this._labelsView.show(),this._progressView.show()},hide:function(){this._labelsView.hide(),this._progressView.hide()},initialize:function(e){this._progressModel=e.progressModel,this._labelsView=e.labelsView,this._progressView=e.progressView,this.initSubscribers()},initSubscribers:function(){this.pubSub.subscribe(r.PROGRESS_REGISTER,i.bind(this.register,this)),this.pubSub.subscribe(r.PROGRESS_UNREGISTER,i.bind(this.unregister,this)),this.pubSub.subscribe(r.PROGRESS_UPDATE,i.bind(this.update,this)),this.pubSub.subscribe(r.PROGRESS_SHOW,i.bind(this.show,this)),this.pubSub.subscribe(r.PROGRESS_HIDE,i.bind(this.hide,this))}});n.exports=o}),define("packages/progress/main",["require","exports","module","packages/progress/models/progressModel","packages/progress/views/progressLabelsView","packages/progress/views/progressView","packages/progress/controllers/progressController"],function(e,t,n){"use strict";var i=e("packages/progress/models/progressModel"),r=e("packages/progress/views/progressLabelsView"),s=e("packages/progress/views/progressView"),o=e("packages/progress/controllers/progressController"),a={};a.start=function(e){var t=new i,n=r.getInstance(e,{model:t}),a=s.getInstance(e,{progressModel:t});new o({progressModel:t,labelsView:n,progressView:a})},n.exports=a}),require(["jquery","underscore","backbone","env","app-config","i18n","jsUri","core/user/controllers/userController","core/helpers","backbone.stickit","backbone-validation"],function(e,t,n,i,r,s,o,a){e(function(){function l(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}var c;c=window.Mojang&&window.Mojang.env?window.Mojang.env:{},i.start(c),t.extend(n.Validation.callbacks,{valid:function(e,t,n){var i=e.$("[name="+t+"]"),r=i.closest(".form-group");r.removeClass("has-error"),r.find(".help-block--feedback").html("").addClass("hidden")},invalid:function(e,t,n,i){var r=e.$("[name="+t+"]"),s=r.closest(".form-group");s.addClass("has-error"),s.find(".help-block--feedback").html(n).removeClass("hidden")}});var u=function(){var e,t,n=l("return_url")||null;if(n){if(e=new o(n),("http"===e.protocol()||"https"===e.protocol())&&(t=new o(this.location),t.host()===e.host()&&t.scheme()===e.scheme()))return e.toString();if(""===e.host()&&""===e.scheme()&&0!==e.path().length)return e.toString();n=null}return n},d=l("transaction_id"),h=function(){var e=l("merchantReference"),t=l("authResult"),n=l("paymentMethod"),i=l("pspReference"),r=l("shopperLocale"),s=l("merchantSig"),o=l("skinCode"),a={};return a.merchantReference=e,a.eventCode=t,a.paymentMethod=n,a.pspReference=i,a.shopperLocale=r,a.hmacSignature=s,a.skinCode=o,a.build=function(){var a={},l=function(e,t,n){n&&(e[t]=n)};return l(a,"merchantReference",e),l(a,"eventCode",t),l(a,"paymentMethod",n),l(a,"pspReference",i),l(a,"shopperLocale",r),l(a,"hmacSignature",s),l(a,"skinCode",o),a},a},p=function(t){return!r.packages||e.inArray(t,r.packages)>-1};r.user&&!r.user.locale&&(r.user.locale=function(){var e=l("lang");return e||(e=navigator.language),e}());var f=new a,m={userController:f},g=f.getUser(),v=function(){p("modal-dialog")&&require(["packages/modal-dialog/main"],function(e){e.start("#app-modal-dialog")});p("login")&&require(["packages/login/main"],function(e){e.start("#login",{user:g,returnUrl:u()})}),g.loadUserInfo().always(function(){p("security")&&require(["packages/security/main"],function(e){e.start("#security",{controllers:m,user:g})});p("order-flow")&&require(["packages/order-flow/main"],function(e){e.start("#orderflow",{transactionId:d,adyenData:h().build(),controllers:m,user:g})}),p("redeem")&&require(["packages/redeem/main"],function(e){e.start("#redeemflow",{controllers:m,user:g})});p("profile")&&require(["packages/profile/main"],function(e){e.start("#app-profile",{controllers:m,user:g})});p("order-history")&&require(["packages/order-history/main"],function(e){e.start("#app-order-history",{controllers:m,user:g})})}),
p("progress")&&require(["packages/progress/main"],function(e){e.start("#hook-progress")}),n.history.start({pushState:!1,root:"/",silent:!0})};if(r.enabledLocales){var y=function(){var t,n,i=function(t){return e.inArray(t,r.enabledLocales)>-1};return i(r.user.locale)?t=r.user.locale:(n=function(e){var t=e.indexOf("-");return t>-1?e.substring(0,t):e}(r.user.locale),i(n)&&(t=n)),t}();if(y&&"en"!==y){require.config({context:"localesBuster",baseUrl:require.toUrl("."),urlArgs:r.localesBuster})(["require","locale/"+y],function(e,t){s.init(t),v()},function(){s.init(),v()})}else s.init(),v()}else s.init(),v()})}),define("main",function(){});